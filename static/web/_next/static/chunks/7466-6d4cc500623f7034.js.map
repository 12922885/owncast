{"version":3,"file":"static/chunks/7466-6d4cc500623f7034.js","mappings":"uGSkCIA,8bJwBQC,EAALA,kCJ9CPC,EARA,MACE,aAAoBC,WAAmC,CACrD,IAAMC,EAAW,MAAMC,MAJT,eAKRC,EAAS,MAAMF,EAASG,IAAI,GAClC,OAAOD,CACT,CACF,aCuBAE,EApBA,MACE,aAAoBC,eAAeC,CAAmB,CAA0B,CAC9E,IAAMN,EAAW,MAAMO,CAAAA,EAAAA,EAAAA,EAAAA,EAAgB,GAA2BD,MAAAA,CAZpD,YAYqC,iBAA2BE,MAAA,CAAZF,IAClE,OAAON,CACT,CAEA,aAAoBS,aAAaC,CAAgB,CAAqC,CACpF,IAAMC,EAAU,CACdC,OAAQ,OACRC,QAAS,CACP,eAAgB,kBAClB,EACAC,KAAMC,KAAKC,SAAS,CAAC,CAAEC,YAAaP,CAAS,EAC/C,EAEMV,EAAW,MAAMO,CAAAA,EAAAA,EAAAA,EAAAA,EAxBI,qBAwBmCI,GAC9D,OAAOX,CACT,CACF,YCxBe,OAAMkB,EA2BnBC,iBAAiBC,CAAI,CAAE,CACrB,IAAMC,EAAM,IAAIC,IAAIF,EACpBC,CAAAA,EAAIE,QAAQ,CAAGC,WAAAA,OAAOC,QAAQ,CAACF,QAAQ,CAAgB,OAAS,KAAK,CACrEF,EAAIK,QAAQ,CAAG,MACfL,EAAIM,IAAI,CAAGH,SAAAA,OAAOC,QAAQ,CAACE,IAAI,CAAc,OAASH,OAAOC,QAAQ,CAACE,IAAI,CAC1EN,EAAIO,YAAY,CAACC,MAAM,CAAC,cAAe,IAAI,CAACvB,WAAW,EAEvDwB,QAAQC,KAAK,CAAC,iBAAkBV,EAAIW,QAAQ,IAC5C,IAAMC,EAAK,IAAIC,UAAUb,EAAIW,QAAQ,GACrCC,CAAAA,EAAGE,MAAM,CAAG,IAAI,CAACC,MAAM,CAACC,IAAI,CAAC,IAAI,EACjCJ,EAAGK,OAAO,CAAG,IAAI,CAACC,OAAO,CAACF,IAAI,CAAC,IAAI,EACnCJ,EAAGO,SAAS,CAAG,IAAI,CAACC,SAAS,CAACJ,IAAI,CAAC,IAAI,EAEvC,IAAI,CAACK,SAAS,CAAGT,CACnB,CAEAG,QAAS,CACH,IAAI,CAACO,uBAAuB,EAC9BC,aAAa,IAAI,CAACD,uBAAuB,CAE7C,CAGAJ,QAAQM,CAAC,CAAE,CAmFXf,QAAQgB,KAAK,CACX,2PAAiQtC,MAAA,CAnF3O,iBAAmBA,MAAA,CAAFqC,KACvC,IAAI,CAACH,SAAS,CAACK,KAAK,GACf,IAAI,CAACC,UAAU,EAClB,IAAI,CAACC,iBAAiB,EAE1B,CAEAA,mBAAoB,CACd,IAAI,CAACN,uBAAuB,EAC9BC,aAAa,IAAI,CAACD,uBAAuB,EAE3C,IAAI,CAACO,OAAO,EAAI,EAChB,IAAI,CAACP,uBAAuB,CAAGQ,WAC7B,IAAI,CAAChC,gBAAgB,CACrB,IAAOiC,KAAKC,GAAG,CAAC,IAAI,CAACH,OAAO,CAAE,KAElC,CAEAI,UAAW,CACT,IAAI,CAACN,UAAU,CAAG,GAClB,IAAI,CAACN,SAAS,CAACK,KAAK,EACtB,CAOAN,UAAUI,CAAgB,CAAE,KAItBU,EADJ,IAAMC,EAAWX,EAAEY,IAAI,CAACC,KAAK,CAAC,MAI9B,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAASI,MAAM,CAAED,IAAK,CACxC,GAAI,CACFJ,EAAcxC,KAAK8C,KAAK,CAACL,CAAQ,CAACG,EAAE,EAChC,IAAI,CAACG,aAAa,EACpB,IAAI,CAACA,aAAa,CAACP,EAEvB,CAAE,MAAOQ,EAAK,CACZjC,QAAQgB,KAAK,CAACiB,EAAKA,EAAIN,IAAI,EAC3B,MACF,CAEA,GAAI,CAACF,EAAYS,IAAI,CAAE,CACrBlC,QAAQgB,KAAK,CAAC,mBAAoBS,GAClC,MACF,CAAC,GAGGA,EAAYS,IAAI,GAAKC,EAAAA,CAAAA,CAAAA,IAAgB,CAAE,CACzC,IAAI,CAACC,QAAQ,GACb,MACF,CAAC,CAEL,CAEAC,aAAuB,KACdC,EAA+BC,EAAtC,MAAO,KAAc,GAAdD,CAAAA,EAAA,IAAI,CAAC1B,SAAS,GAAd0B,KAAA,IAAAA,EAAA,OAAAA,EAAgBE,UAAU,IAAK,KAAc,GAAdD,CAAAA,EAAA,IAAI,CAAC3B,SAAS,GAAd2B,KAAA,IAAAA,EAAA,OAAAA,EAAgBE,IAAI,CAC5D,CAGAC,KAAKjB,CAAgB,CAAE,CAEhBA,EAAYS,IAAI,EAAKC,EAAAA,CAAW,CAACV,EAAYS,IAAI,CAAC,EACrDlC,QAAQ2C,IAAI,CAAC,mDAAoEjE,MAAA,CAAjB+C,EAAYS,IAAI,CAAC,YAGnF,IAAMU,EAAc3D,KAAKC,SAAS,CAACuC,GACnC,IAAI,CAACb,SAAS,CAAC8B,IAAI,CAACE,EACtB,CAGAR,UAAW,CACT,IAAMS,EAAO,CAAEX,KAAMC,EAAAA,CAAAA,CAAAA,IAAgB,EACrC,IAAI,CAACO,IAAI,CAACG,EACZ,CAlHAC,YAAYtE,CAAW,CAAEuE,CAAI,CAAEzD,CAAI,CAAE,MANrC4B,UAAAA,CAAa,QAEbE,OAAAA,CAAU,IAKR,IAAI,CAAC5C,WAAW,CAAGA,EACnB,IAAI,CAACuE,IAAI,CAAGA,EACZ,IAAI,CAAClC,uBAAuB,CAAG,IAAI,CACnC,IAAI,CAACK,UAAU,CAAG,GAElB,IAAI,CAAC7B,gBAAgB,CAAG,IAAI,CAACA,gBAAgB,CAACkB,IAAI,CAAC,IAAI,EACvD,IAAI,CAACiB,QAAQ,CAAG,IAAI,CAACA,QAAQ,CAACjB,IAAI,CAAC,IAAI,EAEvC,IAAI,CAAClB,gBAAgB,CAACC,EACxB,CAyGF,cE/EYvB,EAAAA,EAAAA,GAAAA,CAAAA,EAAAA,CAAAA,CAAAA,GACViF,OAAAA,CAAU,UADAjF,EAEVkF,MAAAA,CAAS,SAFClF,EAGVmF,MAAAA,CAAS,SAHCnF,EAIVoF,OAAAA,CAAU,UAJApF,EAKVqF,aAAAA,CAAgB,iBALNrF,EAMVsF,IAAAA,CAAO,OAGT,IAAMC,EAEJC,CAAAA,EAAAA,EAAAA,CAAAA,EAAc,CACZC,GAAI,WACJC,QAAS,UACTC,2BAA4B,GAC5BC,OAAQ,CACNC,QAAS,CACPC,KA/B+B,CACrCC,cAAe,GACfC,YAAa,GACbC,eAAgB,GAChBC,WAAY,EACd,EA2BQC,GAAI,CACFC,eAAgB,CACdC,OAAQ,SACV,EACAC,OAAQ,CACND,OAAQ,OACV,EACAE,KAAM,CACJF,OAAQ,eACV,CACF,CACF,EACAG,MAAO,CACLd,QAAS,UACTE,OAAQ,CACNa,OAAQ,CACNX,KAAM,CAtDhBC,cAAe,GACfC,YAAa,GACbC,eAAgB,GAChBC,WAAY,EAqDF,EACAC,GAAI,CACFO,QAAS,CACPL,OAAQ,SACV,CACF,CACF,EACAM,QAAS,CACPb,KAAM,CAvEhBC,cAAe,GACfC,YAAa,GACbC,eAAgB,GAChBC,WAAY,EAsEF,EACAC,GAAI,CACFS,OAAQ,CACNP,OAAQ,QACV,CACF,CACF,EACAQ,QAAS,CACPV,GAAI,CACFS,OAAQ,CACNP,OAAQ,QACV,CACF,EACAP,KAAM,CAjEhBC,cAAe,GACfC,YAAa,GACbC,eAAgB,GAChBC,WAAY,EAgEF,EACAY,MAAO,CACL,IAAU,CACRT,OAAQ,SACV,CACF,CACF,CACF,CACF,EACAU,cAAe,CACb5C,KAAM,OACR,EACA6C,YAAa,CACX7C,KAAM,OACR,CACF,CACF,6BCrHF8C,EAhBO,SACLC,CAAiC,CACjCC,CAAuC,CACvCC,CAAqC,CACrC,CACA,GAAM,CAAEC,KAAAA,CAAAA,CAAM,CAAGH,EACX,CAAEzB,GAAAA,CAAAA,CAAIrE,YAAAA,CAAAA,CAAakG,aAAAA,CAAAA,CAAcC,OAAAA,CAAAA,CAAQC,cAAAA,CAAAA,CAAe,CAAGH,EACjEF,EAAqBK,GAErBJ,EAAe,CACb3B,GAAIA,EAAGtD,QAAQ,GACff,YAAAA,EACAkG,aAAAA,EACAG,YAAaF,MAAAA,EAAAA,KAAAA,EAAAA,EAAQG,QAAQ,CAAC,cAElC,ECLAC,EARA,MACE,aAAoBC,WAAmC,CACrD,IAAMzH,EAAW,MAAMC,MAJT,eAKRC,EAAS,MAAMF,EAASG,IAAI,GAClC,OAAOD,CACT,CACF,ECLAwH,EAHO,SAA+BX,CAAkB,CAAEY,CAAe,CAAE,CACzEA,EAAgBC,GAAgB,IAAIA,EAAcb,EAAQ,CAC5D,CCyBAc,CAAAA,EAAAA,EAAAA,CAAAA,0CAAoD,CAAG,GAGvD,IAAMC,EAAmB,cAMZC,EAAoBC,CAAAA,EAAAA,EAAAA,EAAAA,EAAmB,CAClDC,IAAK,oBACLC,QL7BO,CACL5B,OAAQ,GACR6B,YAAa,EACbC,WAAY,IAAIC,IAClB,CK0BF,GAGaC,EAAwBN,CAAAA,EAAAA,EAAAA,EAAAA,EAAK,CACxCC,IAAK,oBACLC,QTEO,CACLK,KAAM,GACNC,QAAS,GACTC,eAAgB,GAChBC,KAAM,GACNC,KAAM,EAAE,CACRC,QAAS,GACTC,KAAM,GACNC,iBAAkB,GAClBC,cAAe,EAAE,CACjBC,aAAc,GACdC,gBAAiB,EAAE,CACnBC,aAAc,GACdC,oBAAqB,IAAIC,IACzBC,qBAAsB,EACtBC,WAAY,CACVC,QAAS,GACTC,QAAS,GACTC,cAAe,CACjB,EACAC,cAAe,CACbC,QAAS,CACPJ,QAAS,GACTK,UAAW,EACb,CACF,EACAC,eAAgB,CACdC,iBAAkB,EACpB,CACF,CS9BF,GAEaC,EAAkB/B,CAAAA,EAAAA,EAAAA,EAAAA,EAAa,CAC1CC,IAAK,kBACLC,QAAS,IAAI,GAGF8B,EAAkBhC,CAAAA,EAAAA,EAAAA,EAAAA,EAAkB,CAC/CC,IAAK,kBACLC,QAAS,IAAI,GAGF+B,EAAmBjC,CAAAA,EAAAA,EAAAA,EAAAA,EAAoB,CAClDC,IAAK,eACLC,QAAS,EAAE,GAGAgC,EAAwBlC,CAAAA,EAAAA,EAAAA,EAAAA,EAAc,CACjDC,IAAK,wBACLC,QAAS,EACX,GAEaiC,EAAuBnC,CAAAA,EAAAA,EAAAA,EAAAA,EAAuB,CACzDC,IAAK,uBACLC,QAAS,IAAI,CACbkC,2BAA4B,EAC9B,GAEaC,EAAerC,CAAAA,EAAAA,EAAAA,EAAAA,EAAsB,CAChDC,IAAK,WACLC,QJvDO,CACLtC,cAAe,GACfC,YAAa,GACbC,eAAgB,GAChBC,WAAY,EACd,CImDF,GAEauE,EAAetC,CAAAA,EAAAA,EAAAA,EAAAA,EAA0B,CACpDC,IAAK,eACLC,QAASqC,KAAAA,CACX,GAEaC,EAAwBxC,CAAAA,EAAAA,EAAAA,EAAAA,EAAc,CACjDC,IAAK,2BACLC,QAAS,EACX,GAEauC,EAAqBzC,CAAAA,EAAAA,EAAAA,EAAAA,EAAc,CAC9CC,IAAK,qBACLC,QAAS,EACX,GAEawC,EAAsB1C,CAAAA,EAAAA,EAAAA,EAAAA,EAAuB,CACxDC,IAAK,sBACLC,QAAS,IAAI,GAGFyC,EAAgB3C,CAAAA,EAAAA,EAAAA,EAAAA,EAAa,CACxCC,IAAK,gBACLC,QAAS,CACX,GAEa0C,EAAwB5C,CAAAA,EAAAA,EAAAA,EAAAA,EAAe,CAClDC,IAAK,oBACLC,QAAS,EAAE,GAKA2C,EAAwBC,CAAAA,EAAAA,EAAAA,EAAAA,EAAS,CAC5C7C,IAAK,wBACL8C,IAAK,GAAa,IAAZ,CAAEA,IAAAA,CAAAA,CAAK,CAAAC,EACLC,EAAyBF,EAAIV,GAC7Ba,EAA6BH,EAAIP,GACjClK,EAAsByK,EAAIhB,GAChC,OAAOzJ,GAAe2K,EAAMrF,aAAa,EAAIsF,CAC/C,CACF,GAEaC,EAA0BL,CAAAA,EAAAA,EAAAA,EAAAA,EAAS,CAC9C7C,IAAK,0BACL8C,IAAK,GAAa,IAAZ,CAAEA,IAAAA,CAAAA,CAAK,CAAAC,EACLC,EAAyBF,EAAIV,GAC7B/J,EAAsByK,EAAIhB,GAChC,OAAOzJ,GAAe2K,EAAMrF,aAAa,CAE7C,GAKawF,EAAmBN,CAAAA,EAAAA,EAAAA,EAAAA,EAAS,CACvC7C,IAAK,mBACL8C,IAAK,GAAa,IAAZ,CAAEA,IAAAA,CAAAA,CAAK,CAAAC,EACLC,EAAyBF,EAAIV,GAC7BgB,EAA0BN,EAAIN,GACpC,OAAOQ,EAAMnF,cAAc,EAAIuF,CACjC,CACF,GAEaC,EAA8BR,CAAAA,EAAAA,EAAAA,EAAAA,EAAwB,CACjE7C,IAAK,8BACL8C,IAAK,GAAa,IAAZ,CAAEA,IAAAA,CAAAA,CAAK,CAAAC,EACLxH,EAA0BuH,EAAId,GAC9BsB,EAAuBR,EAAIH,GACjC,OAAOpH,EAASgI,MAAM,CAACzE,GAAW,CAACwE,EAAWhE,QAAQ,CAACR,EAAQzB,EAAE,EACnE,CACF,GAEamG,EAAwB,IAAM,KAgBrCxJ,EAfJ,GAAM,CAACyJ,EAAUC,EAAcC,EAAgB,CAAGC,CAAAA,EAAAA,EAAAA,CAAAA,EJhBrCzG,GIiBP,CAAC0G,EAAa7E,EAAe,CAAG8E,CAAAA,EAAAA,EAAAA,EAAAA,EAAe/B,GAC/ChD,EAAuBgF,CAAAA,EAAAA,EAAAA,EAAAA,EAA2B9B,GAClD,CAAC+B,EAAcC,EAAgB,CAAGH,CAAAA,EAAAA,EAAAA,EAAAA,EAA6BzD,GAC/D,CAAC6D,EAAcC,EAAgB,CAAGL,CAAAA,EAAAA,EAAAA,EAAAA,EAA6BhE,GAC/DsE,EAAeL,CAAAA,EAAAA,EAAAA,EAAAA,EAA0BrB,GACzC,CAAC2B,EAAc3E,EAAgB,CAAGoE,CAAAA,EAAAA,EAAAA,EAAAA,EAA8B9B,GAChE,CAAC3J,EAAaiM,EAAe,CAAGR,CAAAA,EAAAA,EAAAA,EAAAA,EAAuBhC,GACvDyC,EAAcR,CAAAA,EAAAA,EAAAA,EAAAA,EAAmC3B,GACjDoC,EAA6BT,CAAAA,EAAAA,EAAAA,EAAAA,EAAoCtB,GACjEgC,EAAsBV,CAAAA,EAAAA,EAAAA,EAAAA,EAAoC7B,GAC1D,CAACwC,EAAkBC,EAAoB,CAAGb,CAAAA,EAAAA,EAAAA,EAAAA,EAAyBnB,GACnE,EAAGiC,EAAmB,CAAGC,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IAClC,CAACC,EAAiBC,EAAmB,CAAGF,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IAIjDG,EAAsB,CAACC,EAAenG,IAAoB,CAC9D0F,EAA2B,CACzBS,MAAAA,EACAnG,QAAAA,CACF,EACF,EACMoG,EAAY,GAAmB,CAEnCxB,EAAa,CAAE3H,KAAMoJ,CAAM,EAC7B,EAEMC,EAAqB,GAA0B,CACnD,GAAI3B,EAAS4B,OAAO,CAAC,WAAY,CAC/BH,EAAUtN,EAAAA,MAAoB,EAC9B,MACF,CAAC,EAEUyG,MAAM,EAAIoF,EAAS4B,OAAO,CAAC,SACpCH,EAAUtN,EAAAA,MAAoB,EACpBK,EAAOoG,MAAM,EAAKoF,EAAS4B,OAAO,CAAC,kBAC7CH,EAAUtN,EAAAA,OAAqB,CAEnC,EAEM0N,GAAqB,SAAY,CACrC,GAAI,CACF,IAAMC,EAAS,MAAMC,EAAAA,SAA6B,GAClDvB,EAAgBsB,GAChBf,EAA2B,IAAI,EAC/BO,EAAmB,GACrB,CAAE,MAAOlK,EAAO,CACdmK,EACE,iCACC,0EAEHnL,QAAQgB,KAAK,CAAC,+CAAqDtC,MAAA,CAANsC,GAC/D,CACF,EAEM4K,GAAqB,SAAY,CACrC,GAAI,CACF,IAAMxN,EAAS,MAAMyN,EAAAA,SAA6B,GAClDvB,EAAgBlM,GAChB2M,EAAmB,IACnB,GAAM,CAAEzE,WAAAA,CAAAA,CAAY,CAAGlI,EAEjB0N,EAAY,IAAIvF,KAAKD,GAAYyF,OAAO,GAAKxF,KAAKyF,GAAG,GAC3DzB,EAAauB,GAEbnB,EAA2B,IAAI,CACjC,CAAE,MAAO3J,EAAO,CACdqK,EAAUtN,EAAAA,IAAkB,EAC5BoN,EACE,iCACC,0EAEHnL,QAAQgB,KAAK,CAAC,6CAAmDtC,MAAA,CAANsC,GAC7D,CACF,EAEMiL,GAAyB,MAAOC,GAAiC,CACrE,IAAMC,EAAmBC,CAAAA,EAAAA,EAAAA,EAAAA,EAAgBpG,GACzC,GAAImG,EAAkB,CACpB1B,EAAe0B,GACf,MACF,CAAC,GAEG,CACFd,EAAUtN,EAAAA,aAA2B,EACrC,IAAMG,EAAW,MAAMmO,EAAAA,YAAwB,CAACH,GAC1C,CAAE1N,YAAa8N,CAAAA,CAAgBnN,YAAaoN,CAAAA,CAAgBlH,aAAAA,CAAAA,CAAc,CAAGnH,EACnF,GAAI,CAACoO,EACH,MACD,CAEDnH,EAAe,CACb,GAAG6E,CAAW,CACd7K,YAAaoN,EACblH,aAAAA,CACF,GACAoF,EAAe6B,GACfE,CAAAA,EAAAA,EAAAA,EAAAA,EAAgBxG,EAAkBsG,EACpC,CAAE,MAAOvL,EAAG,CACVsK,EAAUtN,EAAAA,IAAkB,EAC5BiC,QAAQgB,KAAK,CAAC,0CAA4CtC,MAAA,CAAFqC,GAC1D,CACF,EAEM0L,GAAiB,IAAM,CAC3BD,CAAAA,EAAAA,EAAAA,EAAAA,EAAgBxG,EAAkB,IAClCyE,EAAe,IAAI,EACnBwB,IACF,EAEMS,GAAgC,GAAqC,CACzE,GAAM,CAAEC,IAAAA,CAAAA,CAAKC,QAAAA,CAAAA,CAAS,CAAG3H,EACzB,GAAI2H,EAAS,CACX,IAAMC,EAAahC,EAAiBnB,MAAM,CAAClG,GAAM,CAACmJ,EAAIlH,QAAQ,CAACjC,IAC/DsH,EAAoB+B,EACtB,KAAO,CACL,IAAMA,EAAa,IAAIhC,KAAqB8B,EAAI,CAChD7B,EAAoB+B,EACtB,CAAC,EAGG7K,GAAgB,GAA0B,CAC9C,OAAQiD,EAAQ/C,IAAI,EAClB,KAAKC,EAAAA,CAAAA,CAAAA,wBAAoC,CACvCsK,KACA,KAAM,MACHtK,EAAAA,CAAAA,CAAAA,mBAA+B,CAClC2K,EACE7H,EACAC,EACAC,GAEFU,EAAgBC,GAAgB,IAAIA,EAAcb,EAAqB,EACvE,KAAM,MACH9C,EAAAA,CAAAA,CAAAA,IAAgB,CACnB0D,EAAgBC,GAAgB,IAAIA,EAAcb,EAAqB,EACvE,KAAM,MACH9C,EAAAA,CAAAA,CAAAA,WAAuB,CAC1B4K,EAAsB9H,EAAsBY,GAC5C,KAAM,MACH1D,EAAAA,CAAAA,CAAAA,WAAuB,CAC1B0D,EAAgBC,GAAgB,IAAIA,EAAcb,EAAqB,EACvE,KAAM,MACH9C,EAAAA,CAAAA,CAAAA,MAAkB,CACrB0D,EAAgBC,GAAgB,IAAIA,EAAcb,EAAqB,EACvE,KAAM,MACH9C,EAAAA,CAAAA,CAAAA,WAAuB,CAC1B0D,EAAgBC,GAAgB,IAAIA,EAAcb,EAAqB,EACvE,KAAM,MACH9C,EAAAA,CAAAA,CAAAA,iBAA6B,CAChCuK,GAA8BzH,GAC9B,KAAM,SAENjF,QAAQgB,KAAK,CAAC,gCAAiCiE,EAAQ/C,IAAI,CAC/D,CACF,EAEM3D,GAAiB,SAAY,CACjC,GAAI,CACF,IAAMmD,EAAW,MAAM2K,EAAAA,cAA0B,CAAC7N,GAClDqH,EAAgBC,GAAgB,IAAIA,KAAiBpE,EAAS,CAChE,CAAE,MAAOV,EAAO,CACdhB,QAAQgB,KAAK,CAAC,4CAAkDtC,MAAA,CAANsC,GAC5D,CACF,EAEMgM,GAAY,SAAY,CAC5B,GAAI,CACF,GAAM,CAAEC,mBAAAA,CAAAA,CAAoB,CAAG9C,EACzB7K,EAAO2N,GAAsBvN,OAAOC,QAAQ,CAACO,QAAQ,EAE3DC,CADAA,CAAAA,EAAK,IAAIf,EAAiBZ,EAAa,MAAOc,EAAAA,EAC3C0C,aAAa,CAAGA,GACnB4I,EAAoBzK,EACtB,CAAE,MAAOa,EAAO,CACdhB,QAAQgB,KAAK,CAAC,uCAA6CtC,MAAA,CAANsC,GACvD,CACF,EAEMkM,GAAyB,IAAM,CAAC,EA4EtC,MAvEAC,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,IAAM,CACd,GAAI,CACF,GAAIzN,OAAgB0N,eAAe,CAAE,CACnC,IAAM1B,EAASzM,KAAK8C,KAAK,CAACrC,OAAgB0N,eAAe,EACzDhD,EAAgBsB,GAChBR,EAAmB,GACrB,CAAC,CACD,MAAOnK,EAAG,CACVf,QAAQgB,KAAK,CAAC,iCAAkCD,EAClD,CAEA,GAAI,CACF,GAAIrB,OAAgB2N,eAAe,CAAE,CACnC,IAAMjP,EAASa,KAAK8C,KAAK,CAACrC,OAAgB2N,eAAe,EACzD/C,EAAgBlM,GAChB2M,EAAmB,GACrB,CAAC,CACD,MAAOhK,EAAG,CACVf,QAAQgB,KAAK,CAAC,iCAAkCD,EAClD,CACF,EAAG,EAAE,EAELoM,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,IAAM,CACd5B,EAAmBlB,EACrB,EAAG,CAACA,EAAa,EAEjB8C,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,IAAM,CACV,CAAChD,EAAajD,YAAY,EAAI1I,GAAeyM,GAC/C+B,IAEJ,EAAG,CAAC/B,EAAiBzM,EAAY,EAGjC2O,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,IAAM,CACdD,IACF,EAAG,CAAC1C,EAAa,EAEjB2C,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,KACR1B,KACAQ,KACAL,KAEA0B,cAAcxP,GACdA,EAA0ByP,YAAY,IAAM,CAC1C3B,IACF,EA/VgC,KAiWzB,IAAM,CACX0B,cAAcxP,EAChB,GACC,EAAE,EAELqP,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,IAAM,CACT3O,GAILD,IACF,EAAG,CAACC,EAAY,EAEhB2O,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,IAAM,CACdrD,EAAgB0D,YAAY,CAACrE,GAAS,CACpC,IAAMsE,EAAWC,CAAAA,EAAAA,EAAAA,EAAAA,EAAUvE,EAAMtF,IAAI,EAKrC6G,EAAY+C,EACd,EACF,EAAG,EAAE,EAEE,IAAI,6BCtZNtL,EAAKA,kCAAAA,CAAAA,EAAAA,GAAAA,CAAAA,EAAAA,CAAAA,CAAAA,GACVwL,IAAAA,CAAAA,OADUxL,EAEVyL,IAAAA,CAAAA,OAFUzL,EAGV0L,WAAAA,CAAAA,cAHU1L,EAIV2L,YAAAA,CAAAA,eAJU3L,EAKV4L,IAAAA,CAAAA,OALU5L,EAMV6L,MAAAA,CAAAA,SANU7L,EAOV8L,WAAAA,CAAAA,cAPU9L,EAQV+L,WAAAA,CAAAA,cARU/L,EASVgM,2BAAAA,CAAAA,8BATUhM,EAUViM,yBAAAA,CAAAA,4BAVUjM,EAWVkM,2BAAAA,CAAAA,8BAXUlM,EAYVmM,mBAAAA,CAAAA,sBAZUnM,EAaVoM,mBAAAA,CAAAA,sBAbUpM,EAcVqM,wBAAAA,CAAAA,2BAdUrM,EAeVsM,8BAAAA,CAAAA,iCAfUtM,EAgBVuM,iBAAAA,CAAoB,mjCCjBtB,IAAMC,EAAiBC,EAAQC,GAAG,CAACC,0BAA0B,CACvDC,EAAkBH,EAAQC,GAAG,CAACG,2BAA2B,CAClDC,EAAuBL,IAE9BM,EAAe,GAAwBxQ,MAAA,CAArBuQ,EAAqB,cAEhCE,EAAiB,KAGjBC,EAAS,GAAgB1Q,MAAA,CAAbwQ,EAAa,UASzBG,EAAgB,GAAgB3Q,MAAA,CAAbwQ,EAAa,gBAGhCI,EAA2B,GAAgB5Q,MAAA,CAAbwQ,EAAa,UAG3CK,EAAoB,GAAgB7Q,MAAA,CAAbwQ,EAAa,mBAGpCM,EAAwB,GAAgB9Q,MAAA,CAAbwQ,EAAa,WAGxCO,EAAoB,GAAgB/Q,MAAA,CAAbwQ,EAAa,gBAGpCQ,EAAiB,GAAgBhR,MAAA,CAAbwQ,EAAa,uBAGjCS,EAAsB,GAAgBjR,MAAA,CAAbwQ,EAAa,yBAGtCU,EAAa,GAAgBlR,MAAA,CAAbwQ,EAAa,qBAG7BW,EAAmB,GAAgBnR,MAAA,CAAbwQ,EAAa,4BAGnCY,EAAqB,GAAgBpR,MAAA,CAAbwQ,EAAa,2BAGrCa,EAAa,GAAgBrR,MAAA,CAAbwQ,EAAa,yBAG7Bc,EAAiB,GAAgBtR,MAAA,CAAbwQ,EAAa,iBAGjCe,EAAW,GAAgBvR,MAAA,CAAbwQ,EAAa,QAG3BgB,EAAY,GAAgBxR,MAAA,CAAbwQ,EAAa,iBAG5BiB,EAAe,GAAgBzR,MAAA,CAAbwQ,EAAa,iBAG/BkB,EAA2B,oCAG3BC,EAAe,GAAgB3R,MAAA,CAAbwQ,EAAa,gBAG/BoB,EAAe,GAAgB5R,MAAA,CAAbwQ,EAAa,gBAG/BqB,EAAgB,GAAgB7R,MAAA,CAAbwQ,EAAa,gBAGhCsB,EAAsB,GAAgB9R,MAAA,CAAbwQ,EAAa,uBAGtCuB,EAAsB,GAAgB/R,MAAA,CAAbwQ,EAAa,uBAGtCwB,EAAW,GAAgBhS,MAAA,CAAbwQ,EAAa,YAG3ByB,EAAiB,GAAgBjS,MAAA,CAAbwQ,EAAa,mBAGjC0B,EAAiB,GAAgBlS,MAAA,CAAbwQ,EAAa,mBAGjC2B,EAAwB,GAAwBnS,MAAA,CAArBuQ,EAAqB,uBAMhD6B,EAA0B,GAAgBpS,MAAA,CAAbwQ,EAAa,mBAG1C6B,EAAY,GAAgBrS,MAAA,CAAbwQ,EAAa,aAG5B8B,EAAoB,GAAgBtS,MAAA,CAAbwQ,EAAa,qBAGpC+B,EAAoB,GAAgBvS,MAAA,CAAbwQ,EAAa,qBAGpCgC,EAAwB,GAAgBxS,MAAA,CAAbwQ,EAAa,qBAGxCiC,EAAqB,GAAgBzS,MAAA,CAAbwQ,EAAa,sBAErCkC,EAA4B,GAAgB1S,MAAA,CAAbwQ,EAAa,iBAG5CmC,EAAqB,GAAgB3S,MAAA,CAAbwQ,EAAa,qBAErCoC,EAAe,GAAgB5S,MAAA,CAAbwQ,EAAa,YAYrC,eAAeqC,EAAUhS,CAAW,CAAEV,CAAsB,CAAE,CACnE,GAAM,CAAE8C,KAAAA,CAAAA,CAAM7C,OAAAA,EAAS,MAAO0S,KAAAA,EAAO,EAAI,CAAE,CAAG3S,GAAW,CAAC,EAGpD4S,EAA8B,CAClC3S,OAAAA,CACF,EAMA,GAJI6C,GACF8P,CAAAA,EAAezS,IAAI,CAAGC,KAAKC,SAAS,CAACyC,EAAAA,EAGnC6P,GAAQ7C,GAAkBI,EAAiB,CAC7C,IAAM2C,EAAUC,KAAK,GAAqB5C,MAAAA,CAAlBJ,EAAe,KAAmBjQ,MAAA,CAAhBqQ,GAC1C0C,CAAAA,EAAe1S,OAAO,CAAG,CACvB6S,cAAe,SAAiBlT,MAAA,CAARgT,EAC1B,EACAD,EAAeI,IAAI,CAAG,OACtBJ,EAAeK,WAAW,CAAG,SAC/B,CAAC,GAEG,CACF,IAAM5T,EAAW,MAAMC,MAAMoB,EAAKkS,GAC5BpT,EAAO,MAAMH,EAASG,IAAI,GAEhC,GAAI,CAACH,EAAS6T,EAAE,CAAE,CAChB,IAAM9M,EAAU5G,EAAK4G,OAAO,EAAI,0BAA0CvG,MAAA,CAAhBR,EAASE,MAAM,CACzE,OAAM,MAAU6G,EAAS,CAC1B,OACM5G,CACT,CAAE,MAAO2C,EAAO,CAEd,OADAhB,QAAQgB,KAAK,CAACA,GACPA,CAGT,CACF,CAEO,eAAevC,EAAgBc,CAAW,CAAEV,CAAsB,CAAE,CACzE,IAAMmT,EAAO,CACXlT,OAAQ,MACR0S,KAAM,GACN,GAAG3S,CAAO,EAEZ,OAAO0S,EAAUhS,EAAKyS,EACxB,CAEO,eAAeC,EAAkB1S,CAAW,CAAE,CACnD,GAAI,CACF,IAAMrB,EAAW,MAAMC,MAAMoB,EAAK,CAChC2S,eAAgB,cAChBC,SAAU,EACZ,GACA,GAAI,CAACjU,EAAS6T,EAAE,CAAE,CAChB,IAAM9M,EAAU,yBAAyCvG,MAAA,CAAhBR,EAASE,MAAM,CACxD,OAAM,MAAU6G,EAAS,CAC1B,IACK5G,EAAO,MAAMH,EAASG,IAAI,GAChC,OAAOA,CACT,CAAE,MAAO2C,EAAO,CACdhB,QAAQoS,GAAG,CAACpR,EACd,CACA,MAAO,CAAC,CACV,CAEO,eAAeqR,GAAmB,CACvC,OAAOJ,EA1EkB,+DA2E3B,CAGA,IAAMK,EAAO,oBAyBN,eAAeC,EAAwBC,CAAc,CAAE,CAC5D,IAAMC,EAAgB,MAAMJ,IACxBK,EAAuBD,EAAcE,QAAQ,OAMjD,CAJ0C,MAAtCD,EAAqBE,MAAM,CAAC,EAAG,IACjCF,CAAAA,EAAuBA,EAAqBE,MAAM,CAAC,IAGjD,CAACC,SAhCWC,CAAK,CAAEC,CAAM,CAAE,CAC/B,GAAI,CAACD,GAAS,CAACC,GAAUD,IAAAA,EAAMhR,MAAM,EAAUiR,IAAAA,EAAOjR,MAAM,CAAQ,MAAO,EAAK,CAChF,GAAIgR,IAAUC,EAAQ,MAAO,EAAI,CACjC,GAAIT,EAAKU,IAAI,CAACF,IAAUR,EAAKU,IAAI,CAACD,GAAS,CACzC,IAAME,EAASH,EAAMlR,KAAK,CAAC,KAC3B,KAAOqR,EAAOnR,MAAM,CAAG,GAAGmR,EAAOC,IAAI,CAAC,KACtC,IAAMC,EAASJ,EAAOnR,KAAK,CAAC,KAC5B,KAAOuR,EAAOrR,MAAM,CAAG,GAAGqR,EAAOD,IAAI,CAAC,KAEtC,IAAK,IAAIrR,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAMuR,EAAIC,SAASJ,CAAM,CAACpR,EAAE,CAAE,IACxByR,EAAID,SAASF,CAAM,CAACtR,EAAE,CAAE,IAC9B,GAAIuR,IAAME,EAGV,OAAOF,EAAIE,CADA,CAGb,MAAO,EACT,CAAC,OACMR,GAASC,CAClB,EAYgBP,EAAgBE,IACrBA,EAGF,IAAI,yBChJN,SAASa,EAAqBC,CAAS,CAAE,CAC9C,IAAMC,EAAO,iBAAOD,EAAyB,IAAIjN,KAAKiN,GAAaA,CAAS,CAC5E,MAAO,CAAC,IAAIjN,KAASkN,CAAAA,EAAS,KAChC,CA4DO,SAAS/F,EAAU7J,CAAI,CAAE,CAC9B,OAAO6P,OAAOC,IAAI,CAAC9P,GAAM+P,MAAM,CAAC,CAACC,EAAK1N,IAAQ,CAC5C,IAAM2N,EAAQjQ,CAAI,CAACsC,EAAI,CAGvB,OAFAuN,OAAOK,MAAM,CAACF,EAAKC,GAEZD,CACT,EAAG,CAAC,EACN,kKCpKO,IAAMG,EAAqB,CAChCpV,SAAU,WACVqV,8BAA+B,mCAC/BC,eAAgB,kBAClB,EAEO,SAAS9H,EAAgBjG,CAAG,CAAE,CACnC,GAAI,CACF,OAAOgO,aAAaC,OAAO,CAACjO,EAC9B,CAAE,MAAOpF,EAAG,CAAC,CACb,OAAO,IAAI,CAGN,SAASyL,EAAgBrG,CAAG,CAAE2N,CAAK,CAAE,CAC1C,GAAI,CAMF,MALIA,KAAAA,GAAgBA,IAAc,GAAdA,EAClBK,aAAaE,OAAO,CAAClO,EAAK2N,GAE1BK,aAAaG,UAAU,CAACnO,GAEnB,EACT,CAAE,MAAOpF,EAAG,CAAC,CACb,MAAO,EACT","sources":["webpack://_N_E/./interfaces/client-config.model.ts","webpack://_N_E/./services/client-config-service.ts","webpack://_N_E/./services/chat-service.ts","webpack://_N_E/./services/websocket-service.ts","webpack://_N_E/./interfaces/server-status.model.ts","webpack://_N_E/./components/stores/application-state.ts","webpack://_N_E/./components/stores/eventhandlers/connected-client-info-handler.ts","webpack://_N_E/./services/status-service.ts","webpack://_N_E/./components/stores/eventhandlers/handleNameChangeEvent.tsx","webpack://_N_E/./components/stores/ClientConfigStore.tsx","webpack://_N_E/./interfaces/socket-events.ts","webpack://_N_E/./utils/apis.ts","webpack://_N_E/./utils/helpers.js","webpack://_N_E/./utils/localStorage.ts","webpack://_N_E/<anon>"],"sourcesContent":["export interface ClientConfig {\n  name: string;\n  title?: string;\n  summary: string;\n  offlineMessage?: string;\n  logo: string;\n  tags: string[];\n  version: string;\n  nsfw: boolean;\n  extraPageContent: string;\n  socialHandles: SocialHandle[];\n  chatDisabled: boolean;\n  externalActions: any[];\n  customStyles: string;\n  appearanceVariables: Map<string, string>;\n  maxSocketPayloadSize: number;\n  federation: Federation;\n  notifications: Notifications;\n  authentication: Authentication;\n  socketHostOverride?: string;\n}\n\ninterface Authentication {\n  indieAuthEnabled: boolean;\n}\n\ninterface Federation {\n  enabled: boolean;\n  account: string;\n  followerCount: number;\n}\n\ninterface Notifications {\n  browser: Browser;\n}\n\ninterface Browser {\n  enabled: boolean;\n  publicKey: string;\n}\n\ninterface SocialHandle {\n  platform: string;\n  url: string;\n  icon: string;\n}\n\nexport function makeEmptyClientConfig(): ClientConfig {\n  return {\n    name: '',\n    summary: '',\n    offlineMessage: '',\n    logo: '',\n    tags: [],\n    version: '',\n    nsfw: false,\n    extraPageContent: '',\n    socialHandles: [],\n    chatDisabled: false,\n    externalActions: [],\n    customStyles: '',\n    appearanceVariables: new Map(),\n    maxSocketPayloadSize: 0,\n    federation: {\n      enabled: false,\n      account: '',\n      followerCount: 0,\n    },\n    notifications: {\n      browser: {\n        enabled: false,\n        publicKey: '',\n      },\n    },\n    authentication: {\n      indieAuthEnabled: false,\n    },\n  };\n}\n","import { ClientConfig } from '../interfaces/client-config.model';\n\nconst ENDPOINT = `/api/config`;\n\nclass ClientConfigService {\n  public static async getConfig(): Promise<ClientConfig> {\n    const response = await fetch(ENDPOINT);\n    const status = await response.json();\n    return status;\n  }\n}\n\nexport default ClientConfigService;\n","import { ChatMessage } from '../interfaces/chat-message.model';\nimport { getUnauthedData } from '../utils/apis';\n\nconst ENDPOINT = `/api/chat`;\nconst URL_CHAT_REGISTRATION = `/api/chat/register`;\n\ninterface UserRegistrationResponse {\n  id: string;\n  accessToken: string;\n  displayName: string;\n  displayColor: number;\n}\n\nclass ChatService {\n  public static async getChatHistory(accessToken: string): Promise<ChatMessage[]> {\n    const response = await getUnauthedData(`${ENDPOINT}?accessToken=${accessToken}`);\n    return response;\n  }\n\n  public static async registerUser(username: string): Promise<UserRegistrationResponse> {\n    const options = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ displayName: username }),\n    };\n\n    const response = await getUnauthedData(URL_CHAT_REGISTRATION, options);\n    return response;\n  }\n}\n\nexport default ChatService;\n","import { MessageType, SocketEvent } from '../interfaces/socket-events';\n\nexport interface SocketMessage {\n  type: MessageType;\n  data: any;\n}\n\nexport default class WebsocketService {\n  websocket: WebSocket;\n\n  accessToken: string;\n\n  path: string;\n\n  websocketReconnectTimer: ReturnType<typeof setTimeout>;\n\n  isShutdown = false;\n\n  backOff = 1000;\n\n  handleMessage?: (message: SocketEvent) => void;\n\n  constructor(accessToken, path, host) {\n    this.accessToken = accessToken;\n    this.path = path;\n    this.websocketReconnectTimer = null;\n    this.isShutdown = false;\n\n    this.createAndConnect = this.createAndConnect.bind(this);\n    this.shutdown = this.shutdown.bind(this);\n\n    this.createAndConnect(host);\n  }\n\n  createAndConnect(host) {\n    const url = new URL(host);\n    url.protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    url.pathname = '/ws';\n    url.port = window.location.port === '3000' ? '8080' : window.location.port;\n    url.searchParams.append('accessToken', this.accessToken);\n\n    console.debug('connecting to ', url.toString());\n    const ws = new WebSocket(url.toString());\n    ws.onopen = this.onOpen.bind(this);\n    ws.onerror = this.onError.bind(this);\n    ws.onmessage = this.onMessage.bind(this);\n\n    this.websocket = ws;\n  }\n\n  onOpen() {\n    if (this.websocketReconnectTimer) {\n      clearTimeout(this.websocketReconnectTimer);\n    }\n  }\n\n  // On ws error just close the socket and let it re-connect again for now.\n  onError(e) {\n    handleNetworkingError(`Socket error: ${e}`);\n    this.websocket.close();\n    if (!this.isShutdown) {\n      this.scheduleReconnect();\n    }\n  }\n\n  scheduleReconnect() {\n    if (this.websocketReconnectTimer) {\n      clearTimeout(this.websocketReconnectTimer);\n    }\n    this.backOff *= 2;\n    this.websocketReconnectTimer = setTimeout(\n      this.createAndConnect,\n      5000 + Math.min(this.backOff, 10_000),\n    );\n  }\n\n  shutdown() {\n    this.isShutdown = true;\n    this.websocket.close();\n  }\n\n  /*\n  onMessage is fired when an inbound object comes across the websocket.\n  If the message is of type `PING` we send a `PONG` back and do not\n  pass it along to listeners.\n  */\n  onMessage(e: SocketMessage) {\n    // Optimization where multiple events can be sent within a\n    // single websocket message. So split them if needed.\n    const messages = e.data.split('\\n');\n    let socketEvent: SocketEvent;\n\n    // eslint-disable-next-line no-plusplus\n    for (let i = 0; i < messages.length; i++) {\n      try {\n        socketEvent = JSON.parse(messages[i]);\n        if (this.handleMessage) {\n          this.handleMessage(socketEvent);\n        }\n      } catch (err) {\n        console.error(err, err.data);\n        return;\n      }\n\n      if (!socketEvent.type) {\n        console.error('No type provided', socketEvent);\n        return;\n      }\n\n      // Send PONGs\n      if (socketEvent.type === MessageType.PING) {\n        this.sendPong();\n        return;\n      }\n    }\n  }\n\n  isConnected(): boolean {\n    return this.websocket?.readyState === this.websocket?.OPEN;\n  }\n\n  // Outbound: Other components can pass an object to `send`.\n  send(socketEvent: any) {\n    // Sanity check that what we're sending is a valid type.\n    if (!socketEvent.type || !MessageType[socketEvent.type]) {\n      console.warn(`Outbound message: Unknown socket message type: \"${socketEvent.type}\" sent.`);\n    }\n\n    const messageJSON = JSON.stringify(socketEvent);\n    this.websocket.send(messageJSON);\n  }\n\n  // Reply to a PING as a keep alive.\n  sendPong() {\n    const pong = { type: MessageType.PONG };\n    this.send(pong);\n  }\n}\n\nfunction handleNetworkingError(error) {\n  console.error(\n    `Chat has been disconnected and is likely not working for you. It's possible you were removed from chat. If this is a server configuration issue, visit troubleshooting steps to resolve. https://owncast.online/docs/troubleshooting/#chat-is-disabled: ${error}`,\n  );\n}\n","export interface ServerStatus {\n  online: boolean;\n  viewerCount: number;\n  lastConnectTime?: Date;\n  lastDisconnectTime?: Date;\n  versionNumber?: string;\n  streamTitle?: string;\n  serverTime: Date;\n}\n\nexport function makeEmptyServerStatus(): ServerStatus {\n  return {\n    online: false,\n    viewerCount: 0,\n    serverTime: new Date(),\n  };\n}\n","/*\nThis is a finite state machine model that is used by xstate. https://xstate.js.org/\nYou send events to it and it changes state based on the pre-determined\nmodeling.\nThis allows for a clean and reliable way to model the current state of the\nweb application, and a single place to determine the flow of states.\n\nYou can paste this code into https://stately.ai/viz to see a visual state\nmap or install the VS Code plugin:\nhttps://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode\n*/\n\nimport { createMachine } from 'xstate';\n\nexport interface AppStateOptions {\n  chatAvailable: boolean;\n  chatLoading?: boolean;\n  videoAvailable: boolean;\n  appLoading?: boolean;\n}\n\nexport function makeEmptyAppState(): AppStateOptions {\n  return {\n    chatAvailable: false,\n    chatLoading: true,\n    videoAvailable: false,\n    appLoading: true,\n  };\n}\n\nconst OFFLINE_STATE: AppStateOptions = {\n  chatAvailable: false,\n  chatLoading: false,\n  videoAvailable: false,\n  appLoading: false,\n};\n\nconst ONLINE_STATE: AppStateOptions = {\n  chatAvailable: true,\n  chatLoading: false,\n  videoAvailable: true,\n  appLoading: false,\n};\n\nconst LOADING_STATE: AppStateOptions = {\n  chatAvailable: false,\n  chatLoading: false,\n  videoAvailable: false,\n  appLoading: true,\n};\n\nconst GOODBYE_STATE: AppStateOptions = {\n  chatAvailable: true,\n  chatLoading: false,\n  videoAvailable: false,\n  appLoading: false,\n};\n\nexport enum AppStateEvent {\n  Loading = 'LOADING', // Have not pulled configuration data from the server.\n  Loaded = 'LOADED', // Configuration data has been pulled from the server.\n  Online = 'ONLINE', // Stream is live\n  Offline = 'OFFLINE', // Stream is not live\n  NeedsRegister = 'NEEDS_REGISTER', // Needs to register a chat user\n  Fail = 'FAIL', // Error\n}\n\nconst appStateModel =\n  /** @xstate-layout N4IgpgJg5mDOIC5QEMAOqDKAXZWwDoAbAe2QgEsA7KAYgCUBRAcQEkMAVBxgEUVFWKxyWcsUp8QAD0QBGAGwz8ABgCscpUoDsAZgAcKgEwrtATgA0IAJ6zNS-CZMLtcuQBY9Jg5t0BfHxbRMHDwiUgpqGgA5BgZuDAB9RlYOLgkBIRExCWkEGRVFVXUtPUNjcytEAxNXfB0DbSNNORMG119-EEDsXAISMipaABkAeQBBbli0wWFRcSQpWQVlNQ0dfSNTC2tc+vwZVwMZWxNbA5kDAz8A9G6QvvDaADFRlkGpjNns2VcCleL1spbRDaA74FS6ORVfYHTSObRXTo3YIEABOYCg5FgeBRA3ozDYnB47xmWXmOQOKj22hUnl02iajjk2iBCCqdgO2n2VRcbQhCK6yPwaIxWLAOIiz1exMyc1A5KMVJpBjpDJczIqCG0enwXk0MiUENMjiUBjk-KRPSFYDIlnwYkIVDANGGj0egxY0WlnzJiF0TXwulU9LqWhMMl0LIM7ipmguIIObU85qClrRNrtADMMw7KE7hpF3Z75ukSbKFgg5Pp7PSQdTXBp9uVtlHtDG464E7okx0BanrRBbVBiMQIAAjSxOyRYy3IDPYgAU2g0y4AlDReyE0wP8EOR+OwF7SXLff7A8ZNCHYeGWedW3qlDIWkz61rLgjKCO4BIN70wgND2W8o3pyyjKrCdZ6q4sYqMmtyouimLYv+xbTDKXyakuyiuHI+QmCoJquCo2FyCyS52PURzqI+mgqIYpqwYKW62vajoAehsJyFS+paPhfoRhqUa6PgTIuLoRznComiEWaPYWpu-bMVmOYHihHxHuWRQ6pCJz0sqGgNMBBjCfohiEUoIJ0kyDF9umu5jhObE+rkqh2BCLS8XhYa6K4wGUuGtEviYZ5qNZ8k2o5x4IJJnGmlUOixoG5kGCy+G1JyXgHGJJhKByrihQQsBigAbmKjzIOQhAAK5ohF5YXJx+q2MYbieFB4KkW0yj6NBfr6vU3n5fglWFSiGblVVNWqaW6H5HY4bNFJbhKI4HV3k0rgnNlS6xm+1wpngtU5NeGoALQXDqbVBct+g5Qofh+EAA */\n  createMachine({\n    id: 'appState',\n    initial: 'loading',\n    predictableActionArguments: true,\n    states: {\n      loading: {\n        meta: LOADING_STATE,\n        on: {\n          NEEDS_REGISTER: {\n            target: 'loading',\n          },\n          LOADED: {\n            target: 'ready',\n          },\n          FAIL: {\n            target: 'serverFailure',\n          },\n        },\n      },\n      ready: {\n        initial: 'offline',\n        states: {\n          online: {\n            meta: {\n              ...ONLINE_STATE,\n            },\n            on: {\n              OFFLINE: {\n                target: 'goodbye',\n              },\n            },\n          },\n          offline: {\n            meta: {\n              ...OFFLINE_STATE,\n            },\n            on: {\n              ONLINE: {\n                target: 'online',\n              },\n            },\n          },\n          goodbye: {\n            on: {\n              ONLINE: {\n                target: 'online',\n              },\n            },\n            meta: {\n              ...GOODBYE_STATE,\n            },\n            after: {\n              '300000': {\n                target: 'offline',\n              },\n            },\n          },\n        },\n      },\n      serverFailure: {\n        type: 'final',\n      },\n      userfailure: {\n        type: 'final',\n      },\n    },\n  });\n\nexport default appStateModel;\n","import { ConnectedClientInfoEvent } from '../../../interfaces/socket-events';\n\nexport function handleConnectedClientInfoMessage(\n  message: ConnectedClientInfoEvent,\n  setChatAuthenticated: (boolean) => void,\n  setCurrentUser: (CurrentUser) => void,\n) {\n  const { user } = message;\n  const { id, displayName, displayColor, scopes, authenticated } = user;\n  setChatAuthenticated(authenticated);\n\n  setCurrentUser({\n    id: id.toString(),\n    displayName,\n    displayColor,\n    isModerator: scopes?.includes('MODERATOR'),\n  });\n}\nexport default handleConnectedClientInfoMessage;\n","import { ServerStatus } from '../interfaces/server-status.model';\n\nconst ENDPOINT = `/api/status`;\n\nclass ServerStatusService {\n  public static async getStatus(): Promise<ServerStatus> {\n    const response = await fetch(ENDPOINT);\n    const status = await response.json();\n    return status;\n  }\n}\n\nexport default ServerStatusService;\n","import { ChatEvent } from '../../../interfaces/socket-events';\n\nexport function handleNameChangeEvent(message: ChatEvent, setChatMessages) {\n  setChatMessages(currentState => [...currentState, message]);\n}\nexport default handleNameChangeEvent;\n","import { FC, useEffect, useState } from 'react';\nimport { atom, selector, useRecoilState, useSetRecoilState, RecoilEnv } from 'recoil';\nimport { useMachine } from '@xstate/react';\nimport { makeEmptyClientConfig, ClientConfig } from '../../interfaces/client-config.model';\nimport ClientConfigService from '../../services/client-config-service';\nimport ChatService from '../../services/chat-service';\nimport WebsocketService from '../../services/websocket-service';\nimport { ChatMessage } from '../../interfaces/chat-message.model';\nimport { CurrentUser } from '../../interfaces/current-user';\nimport { ServerStatus, makeEmptyServerStatus } from '../../interfaces/server-status.model';\nimport appStateModel, {\n  AppStateEvent,\n  AppStateOptions,\n  makeEmptyAppState,\n} from './application-state';\nimport { setLocalStorage, getLocalStorage } from '../../utils/localStorage';\nimport {\n  ConnectedClientInfoEvent,\n  MessageType,\n  ChatEvent,\n  MessageVisibilityEvent,\n  SocketEvent,\n} from '../../interfaces/socket-events';\nimport { mergeMeta } from '../../utils/helpers';\nimport handleConnectedClientInfoMessage from './eventhandlers/connected-client-info-handler';\nimport ServerStatusService from '../../services/status-service';\nimport handleNameChangeEvent from './eventhandlers/handleNameChangeEvent';\nimport { DisplayableError } from '../../types/displayable-error';\n\nRecoilEnv.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED = false;\n\nconst SERVER_STATUS_POLL_DURATION = 5000;\nconst ACCESS_TOKEN_KEY = 'accessToken';\n\nlet serverStatusRefreshPoll: ReturnType<typeof setInterval>;\n\n// Server status is what gets updated such as viewer count, durations,\n// stream title, online/offline state, etc.\nexport const serverStatusState = atom<ServerStatus>({\n  key: 'serverStatusState',\n  default: makeEmptyServerStatus(),\n});\n\n// The config that comes from the API.\nexport const clientConfigStateAtom = atom({\n  key: 'clientConfigState',\n  default: makeEmptyClientConfig(),\n});\n\nexport const accessTokenAtom = atom<string>({\n  key: 'accessTokenAtom',\n  default: null,\n});\n\nexport const currentUserAtom = atom<CurrentUser>({\n  key: 'currentUserAtom',\n  default: null,\n});\n\nexport const chatMessagesAtom = atom<ChatMessage[]>({\n  key: 'chatMessages',\n  default: [] as ChatMessage[],\n});\n\nexport const chatAuthenticatedAtom = atom<boolean>({\n  key: 'chatAuthenticatedAtom',\n  default: false,\n});\n\nexport const websocketServiceAtom = atom<WebsocketService>({\n  key: 'websocketServiceAtom',\n  default: null,\n  dangerouslyAllowMutability: true,\n});\n\nexport const appStateAtom = atom<AppStateOptions>({\n  key: 'appState',\n  default: makeEmptyAppState(),\n});\n\nexport const isMobileAtom = atom<boolean | undefined>({\n  key: 'isMobileAtom',\n  default: undefined,\n});\n\nexport const chatVisibleToggleAtom = atom<boolean>({\n  key: 'chatVisibilityToggleAtom',\n  default: true,\n});\n\nexport const isVideoPlayingAtom = atom<boolean>({\n  key: 'isVideoPlayingAtom',\n  default: false,\n});\n\nexport const fatalErrorStateAtom = atom<DisplayableError>({\n  key: 'fatalErrorStateAtom',\n  default: null,\n});\n\nexport const clockSkewAtom = atom<Number>({\n  key: 'clockSkewAtom',\n  default: 0.0,\n});\n\nexport const removedMessageIdsAtom = atom<string[]>({\n  key: 'removedMessageIds',\n  default: [],\n});\n\n// Chat is visible if the user wishes it to be visible AND the required\n// chat state is set.\nexport const isChatVisibleSelector = selector({\n  key: 'isChatVisibleSelector',\n  get: ({ get }) => {\n    const state: AppStateOptions = get(appStateAtom);\n    const userVisibleToggle: boolean = get(chatVisibleToggleAtom);\n    const accessToken: string = get(accessTokenAtom);\n    return accessToken && state.chatAvailable && userVisibleToggle;\n  },\n});\n\nexport const isChatAvailableSelector = selector({\n  key: 'isChatAvailableSelector',\n  get: ({ get }) => {\n    const state: AppStateOptions = get(appStateAtom);\n    const accessToken: string = get(accessTokenAtom);\n    return accessToken && state.chatAvailable;\n  },\n});\n\n// We display in an \"online/live\" state as long as video is actively playing.\n// Even during the time where technically the server has said it's no longer\n// live, however the last few seconds of video playback is still taking place.\nexport const isOnlineSelector = selector({\n  key: 'isOnlineSelector',\n  get: ({ get }) => {\n    const state: AppStateOptions = get(appStateAtom);\n    const isVideoPlaying: boolean = get(isVideoPlayingAtom);\n    return state.videoAvailable || isVideoPlaying;\n  },\n});\n\nexport const visibleChatMessagesSelector = selector<ChatMessage[]>({\n  key: 'visibleChatMessagesSelector',\n  get: ({ get }) => {\n    const messages: ChatMessage[] = get(chatMessagesAtom);\n    const removedIds: string[] = get(removedMessageIdsAtom);\n    return messages.filter(message => !removedIds.includes(message.id));\n  },\n});\n\nexport const ClientConfigStore: FC = () => {\n  const [appState, appStateSend, appStateService] = useMachine(appStateModel);\n  const [currentUser, setCurrentUser] = useRecoilState(currentUserAtom);\n  const setChatAuthenticated = useSetRecoilState<boolean>(chatAuthenticatedAtom);\n  const [clientConfig, setClientConfig] = useRecoilState<ClientConfig>(clientConfigStateAtom);\n  const [serverStatus, setServerStatus] = useRecoilState<ServerStatus>(serverStatusState);\n  const setClockSkew = useSetRecoilState<Number>(clockSkewAtom);\n  const [chatMessages, setChatMessages] = useRecoilState<ChatMessage[]>(chatMessagesAtom);\n  const [accessToken, setAccessToken] = useRecoilState<string>(accessTokenAtom);\n  const setAppState = useSetRecoilState<AppStateOptions>(appStateAtom);\n  const setGlobalFatalErrorMessage = useSetRecoilState<DisplayableError>(fatalErrorStateAtom);\n  const setWebsocketService = useSetRecoilState<WebsocketService>(websocketServiceAtom);\n  const [hiddenMessageIds, setHiddenMessageIds] = useRecoilState<string[]>(removedMessageIdsAtom);\n  const [, setHasLoadedStatus] = useState(false);\n  const [hasLoadedConfig, setHasLoadedConfig] = useState(false);\n\n  let ws: WebsocketService;\n\n  const setGlobalFatalError = (title: string, message: string) => {\n    setGlobalFatalErrorMessage({\n      title,\n      message,\n    });\n  };\n  const sendEvent = (event: string) => {\n    // console.debug('---- sending event:', event);\n    appStateSend({ type: event });\n  };\n\n  const handleStatusChange = (status: ServerStatus) => {\n    if (appState.matches('loading')) {\n      sendEvent(AppStateEvent.Loaded);\n      return;\n    }\n\n    if (status.online && appState.matches('ready')) {\n      sendEvent(AppStateEvent.Online);\n    } else if (!status.online && !appState.matches('ready.offline')) {\n      sendEvent(AppStateEvent.Offline);\n    }\n  };\n\n  const updateClientConfig = async () => {\n    try {\n      const config = await ClientConfigService.getConfig();\n      setClientConfig(config);\n      setGlobalFatalErrorMessage(null);\n      setHasLoadedConfig(true);\n    } catch (error) {\n      setGlobalFatalError(\n        'Unable to reach Owncast server',\n        `Owncast cannot launch. Please make sure the Owncast server is running.`,\n      );\n      console.error(`ClientConfigService -> getConfig() ERROR: \\n${error}`);\n    }\n  };\n\n  const updateServerStatus = async () => {\n    try {\n      const status = await ServerStatusService.getStatus();\n      setServerStatus(status);\n      setHasLoadedStatus(true);\n      const { serverTime } = status;\n\n      const clockSkew = new Date(serverTime).getTime() - Date.now();\n      setClockSkew(clockSkew);\n\n      setGlobalFatalErrorMessage(null);\n    } catch (error) {\n      sendEvent(AppStateEvent.Fail);\n      setGlobalFatalError(\n        'Unable to reach Owncast server',\n        `Owncast cannot launch. Please make sure the Owncast server is running.`,\n      );\n      console.error(`serverStatusState -> getStatus() ERROR: \\n${error}`);\n    }\n  };\n\n  const handleUserRegistration = async (optionalDisplayName?: string) => {\n    const savedAccessToken = getLocalStorage(ACCESS_TOKEN_KEY);\n    if (savedAccessToken) {\n      setAccessToken(savedAccessToken);\n      return;\n    }\n\n    try {\n      sendEvent(AppStateEvent.NeedsRegister);\n      const response = await ChatService.registerUser(optionalDisplayName);\n      const { accessToken: newAccessToken, displayName: newDisplayName, displayColor } = response;\n      if (!newAccessToken) {\n        return;\n      }\n\n      setCurrentUser({\n        ...currentUser,\n        displayName: newDisplayName,\n        displayColor,\n      });\n      setAccessToken(newAccessToken);\n      setLocalStorage(ACCESS_TOKEN_KEY, newAccessToken);\n    } catch (e) {\n      sendEvent(AppStateEvent.Fail);\n      console.error(`ChatService -> registerUser() ERROR: \\n${e}`);\n    }\n  };\n\n  const resetAndReAuth = () => {\n    setLocalStorage(ACCESS_TOKEN_KEY, '');\n    setAccessToken(null);\n    handleUserRegistration();\n  };\n\n  const handleMessageVisibilityChange = (message: MessageVisibilityEvent) => {\n    const { ids, visible } = message;\n    if (visible) {\n      const updatedIds = hiddenMessageIds.filter(id => !ids.includes(id));\n      setHiddenMessageIds(updatedIds);\n    } else {\n      const updatedIds = [...hiddenMessageIds, ...ids];\n      setHiddenMessageIds(updatedIds);\n    }\n  };\n\n  const handleMessage = (message: SocketEvent) => {\n    switch (message.type) {\n      case MessageType.ERROR_NEEDS_REGISTRATION:\n        resetAndReAuth();\n        break;\n      case MessageType.CONNECTED_USER_INFO:\n        handleConnectedClientInfoMessage(\n          message as ConnectedClientInfoEvent,\n          setChatAuthenticated,\n          setCurrentUser,\n        );\n        setChatMessages(currentState => [...currentState, message as ChatEvent]);\n        break;\n      case MessageType.CHAT:\n        setChatMessages(currentState => [...currentState, message as ChatEvent]);\n        break;\n      case MessageType.NAME_CHANGE:\n        handleNameChangeEvent(message as ChatEvent, setChatMessages);\n        break;\n      case MessageType.USER_JOINED:\n        setChatMessages(currentState => [...currentState, message as ChatEvent]);\n        break;\n      case MessageType.SYSTEM:\n        setChatMessages(currentState => [...currentState, message as ChatEvent]);\n        break;\n      case MessageType.CHAT_ACTION:\n        setChatMessages(currentState => [...currentState, message as ChatEvent]);\n        break;\n      case MessageType.VISIBILITY_UPDATE:\n        handleMessageVisibilityChange(message as MessageVisibilityEvent);\n        break;\n      default:\n        console.error('Unknown socket message type: ', message.type);\n    }\n  };\n\n  const getChatHistory = async () => {\n    try {\n      const messages = await ChatService.getChatHistory(accessToken);\n      setChatMessages(currentState => [...currentState, ...messages]);\n    } catch (error) {\n      console.error(`ChatService -> getChatHistory() ERROR: \\n${error}`);\n    }\n  };\n\n  const startChat = async () => {\n    try {\n      const { socketHostOverride } = clientConfig;\n      const host = socketHostOverride || window.location.toString();\n      ws = new WebsocketService(accessToken, '/ws', host);\n      ws.handleMessage = handleMessage;\n      setWebsocketService(ws);\n    } catch (error) {\n      console.error(`ChatService -> startChat() ERROR: \\n${error}`);\n    }\n  };\n\n  const handleChatNotification = () => {};\n\n  // Read the config and status on initial load from a JSON string that lives\n  // in window. This is placed there server-side and allows for fast initial\n  // load times because we don't have to wait for the API calls to complete.\n  useEffect(() => {\n    try {\n      if ((window as any).configHydration) {\n        const config = JSON.parse((window as any).configHydration);\n        setClientConfig(config);\n        setHasLoadedConfig(true);\n      }\n    } catch (e) {\n      console.error('Error parsing config hydration', e);\n    }\n\n    try {\n      if ((window as any).statusHydration) {\n        const status = JSON.parse((window as any).statusHydration);\n        setServerStatus(status);\n        setHasLoadedStatus(true);\n      }\n    } catch (e) {\n      console.error('error parsing status hydration', e);\n    }\n  }, []);\n\n  useEffect(() => {\n    handleStatusChange(serverStatus);\n  }, [serverStatus]);\n\n  useEffect(() => {\n    if (!clientConfig.chatDisabled && accessToken && hasLoadedConfig) {\n      startChat();\n    }\n  }, [hasLoadedConfig, accessToken]);\n\n  // Notify about chat activity when backgrounded.\n  useEffect(() => {\n    handleChatNotification();\n  }, [chatMessages]);\n\n  useEffect(() => {\n    updateClientConfig();\n    handleUserRegistration();\n    updateServerStatus();\n\n    clearInterval(serverStatusRefreshPoll);\n    serverStatusRefreshPoll = setInterval(() => {\n      updateServerStatus();\n    }, SERVER_STATUS_POLL_DURATION);\n\n    return () => {\n      clearInterval(serverStatusRefreshPoll);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!accessToken) {\n      return;\n    }\n\n    getChatHistory();\n  }, [accessToken]);\n\n  useEffect(() => {\n    appStateService.onTransition(state => {\n      const metadata = mergeMeta(state.meta) as AppStateOptions;\n\n      // console.debug('--- APP STATE: ', state.value);\n      // console.debug('--- APP META: ', metadata);\n\n      setAppState(metadata);\n    });\n  }, []);\n\n  return null;\n};\n","import { User } from './user.model';\n\nexport enum MessageType {\n  CHAT = 'CHAT',\n  PING = 'PING',\n  NAME_CHANGE = 'NAME_CHANGE',\n  COLOR_CHANGE = 'COLOR_CHANGE',\n  PONG = 'PONG',\n  SYSTEM = 'SYSTEM',\n  USER_JOINED = 'USER_JOINED',\n  CHAT_ACTION = 'CHAT_ACTION',\n  FEDIVERSE_ENGAGEMENT_FOLLOW = 'FEDIVERSE_ENGAGEMENT_FOLLOW',\n  FEDIVERSE_ENGAGEMENT_LIKE = 'FEDIVERSE_ENGAGEMENT_LIKE',\n  FEDIVERSE_ENGAGEMENT_REPOST = 'FEDIVERSE_ENGAGEMENT_REPOST',\n  CONNECTED_USER_INFO = 'CONNECTED_USER_INFO',\n  ERROR_USER_DISABLED = 'ERROR_USER_DISABLED',\n  ERROR_NEEDS_REGISTRATION = 'ERROR_NEEDS_REGISTRATION',\n  ERROR_MAX_CONNECTIONS_EXCEEDED = 'ERROR_MAX_CONNECTIONS_EXCEEDED',\n  VISIBILITY_UPDATE = 'VISIBILITY-UPDATE',\n}\n\nexport interface SocketEvent {\n  id: string;\n  timestamp: Date;\n  type: MessageType;\n}\n\nexport interface ConnectedClientInfoEvent extends SocketEvent {\n  user: User;\n}\nexport interface ChatEvent extends SocketEvent {\n  user: User;\n  body: string;\n}\n\nexport interface NameChangeEvent extends SocketEvent {\n  user: User;\n  oldName: string;\n}\n\nexport interface MessageVisibilityEvent extends SocketEvent {\n  visible: boolean;\n  ids: string[];\n}\n","/* eslint-disable prefer-destructuring */\nconst ADMIN_USERNAME = process.env.NEXT_PUBLIC_ADMIN_USERNAME;\nconst ADMIN_STREAMKEY = process.env.NEXT_PUBLIC_ADMIN_STREAMKEY;\nexport const NEXT_PUBLIC_API_HOST = process.env.NEXT_PUBLIC_API_HOST;\n\nconst API_LOCATION = `${NEXT_PUBLIC_API_HOST}api/admin/`;\n\nexport const FETCH_INTERVAL = 15000;\n\n// Current inbound broadcaster info\nexport const STATUS = `${API_LOCATION}status`;\n\n// Disconnect inbound stream\nexport const DISCONNECT = `${API_LOCATION}disconnect`;\n\n// Change the current streaming key in memory\nexport const STREAMKEY_CHANGE = `${API_LOCATION}changekey`;\n\n// Current server config\nexport const SERVER_CONFIG = `${API_LOCATION}serverconfig`;\n\n// Base url to update config settings\nexport const SERVER_CONFIG_UPDATE_URL = `${API_LOCATION}config`;\n\n// Get viewer count over time\nexport const VIEWERS_OVER_TIME = `${API_LOCATION}viewersOverTime`;\n\n// Get active viewer details\nexport const ACTIVE_VIEWER_DETAILS = `${API_LOCATION}viewers`;\n\n// Get currently connected chat clients\nexport const CONNECTED_CLIENTS = `${API_LOCATION}chat/clients`;\n\n// Get list of disabled/blocked chat users\nexport const DISABLED_USERS = `${API_LOCATION}chat/users/disabled`;\n\n// Disable/enable a single user\nexport const USER_ENABLED_TOGGLE = `${API_LOCATION}chat/users/setenabled`;\n\n// Get banned IP addresses\nexport const BANNED_IPS = `${API_LOCATION}chat/users/ipbans`;\n\n// Remove IP ban\nexport const BANNED_IP_REMOVE = `${API_LOCATION}chat/users/ipbans/remove`;\n\n// Disable/enable a single user\nexport const USER_SET_MODERATOR = `${API_LOCATION}chat/users/setmoderator`;\n\n// Get list of moderators\nexport const MODERATORS = `${API_LOCATION}chat/users/moderators`;\n\n// Get hardware stats\nexport const HARDWARE_STATS = `${API_LOCATION}hardwarestats`;\n\n// Get all logs\nexport const LOGS_ALL = `${API_LOCATION}logs`;\n\n// Get warnings + errors\nexport const LOGS_WARN = `${API_LOCATION}logs/warnings`;\n\n// Get chat history\nexport const CHAT_HISTORY = `${API_LOCATION}chat/messages`;\n\n// Get chat history\nexport const UPDATE_CHAT_MESSGAE_VIZ = `/api/admin/chat/messagevisibility`;\n\n// Upload a new custom emoji\nexport const UPLOAD_EMOJI = `${API_LOCATION}emoji/upload`;\n\n// Delete a custom emoji\nexport const DELETE_EMOJI = `${API_LOCATION}emoji/delete`;\n\n// Get all access tokens\nexport const ACCESS_TOKENS = `${API_LOCATION}accesstokens`;\n\n// Delete a single access token\nexport const DELETE_ACCESS_TOKEN = `${API_LOCATION}accesstokens/delete`;\n\n// Create a new access token\nexport const CREATE_ACCESS_TOKEN = `${API_LOCATION}accesstokens/create`;\n\n// Get webhooks\nexport const WEBHOOKS = `${API_LOCATION}webhooks`;\n\n// Delete a single webhook\nexport const DELETE_WEBHOOK = `${API_LOCATION}webhooks/delete`;\n\n// Create a single webhook\nexport const CREATE_WEBHOOK = `${API_LOCATION}webhooks/create`;\n\n// hard coded social icons list\nexport const SOCIAL_PLATFORMS_LIST = `${NEXT_PUBLIC_API_HOST}api/socialplatforms`;\n\n// set external action links\nexport const EXTERNAL_ACTIONS = `${API_LOCATION}api/externalactions`;\n\n// send a message to the fediverse\nexport const FEDERATION_MESSAGE_SEND = `${API_LOCATION}federation/send`;\n\n// Get followers\nexport const FOLLOWERS = `${API_LOCATION}followers`;\n\n// Get followers pending approval\nexport const FOLLOWERS_PENDING = `${API_LOCATION}followers/pending`;\n\n// Get followers who were blocked or rejected\nexport const FOLLOWERS_BLOCKED = `${API_LOCATION}followers/blocked`;\n\n// Approve, reject a follow request\nexport const SET_FOLLOWER_APPROVAL = `${API_LOCATION}followers/approve`;\n\n// List of inbound federated actions that took place.\nexport const FEDERATION_ACTIONS = `${API_LOCATION}federation/actions`;\n\nexport const API_STREAM_HEALTH_METRICS = `${API_LOCATION}metrics/video`;\n\n// Save an array of stream keys\nexport const UPDATE_STREAM_KEYS = `${API_LOCATION}config/streamkeys`;\n\nexport const API_YP_RESET = `${API_LOCATION}yp/reset`;\n\nexport const TEMP_UPDATER_API = LOGS_ALL;\n\nconst GITHUB_RELEASE_URL = 'https://api.github.com/repos/owncast/owncast/releases/latest';\n\ninterface FetchOptions {\n  data?: any;\n  method?: string;\n  auth?: boolean;\n}\n\nexport async function fetchData(url: string, options?: FetchOptions) {\n  const { data, method = 'GET', auth = true } = options || {};\n\n  // eslint-disable-next-line no-undef\n  const requestOptions: RequestInit = {\n    method,\n  };\n\n  if (data) {\n    requestOptions.body = JSON.stringify(data);\n  }\n\n  if (auth && ADMIN_USERNAME && ADMIN_STREAMKEY) {\n    const encoded = btoa(`${ADMIN_USERNAME}:${ADMIN_STREAMKEY}`);\n    requestOptions.headers = {\n      Authorization: `Basic ${encoded}`,\n    };\n    requestOptions.mode = 'cors';\n    requestOptions.credentials = 'include';\n  }\n\n  try {\n    const response = await fetch(url, requestOptions);\n    const json = await response.json();\n\n    if (!response.ok) {\n      const message = json.message || `An error has occurred: ${response.status}`;\n      throw new Error(message);\n    }\n    return json;\n  } catch (error) {\n    console.error(error);\n    return error;\n    // console.log(error)\n    // throw new Error(error)\n  }\n}\n\nexport async function getUnauthedData(url: string, options?: FetchOptions) {\n  const opts = {\n    method: 'GET',\n    auth: false,\n    ...options,\n  };\n  return fetchData(url, opts);\n}\n\nexport async function fetchExternalData(url: string) {\n  try {\n    const response = await fetch(url, {\n      referrerPolicy: 'no-referrer', // Send no referrer header for privacy reasons.\n      referrer: '',\n    });\n    if (!response.ok) {\n      const message = `An error has occured: ${response.status}`;\n      throw new Error(message);\n    }\n    const json = await response.json();\n    return json;\n  } catch (error) {\n    console.log(error);\n  }\n  return {};\n}\n\nexport async function getGithubRelease() {\n  return fetchExternalData(GITHUB_RELEASE_URL);\n}\n\n// Stolen from https://gist.github.com/prenagha/98bbb03e27163bc2f5e4\nconst VPAT = /^\\d+(\\.\\d+){0,2}$/;\nfunction upToDate(local, remote) {\n  if (!local || !remote || local.length === 0 || remote.length === 0) return false;\n  if (local === remote) return true;\n  if (VPAT.test(local) && VPAT.test(remote)) {\n    const lparts = local.split('.');\n    while (lparts.length < 3) lparts.push('0');\n    const rparts = remote.split('.');\n    while (rparts.length < 3) rparts.push('0');\n    // eslint-disable-next-line no-plusplus\n    for (let i = 0; i < 3; i++) {\n      const l = parseInt(lparts[i], 10);\n      const r = parseInt(rparts[i], 10);\n      if (l === r)\n        // eslint-disable-next-line no-continue\n        continue;\n      return l > r;\n    }\n    return true;\n  }\n  return local >= remote;\n}\n\n// Make a request to the server status API and the Github releases API\n// and return a release if it's newer than the server version.\nexport async function upgradeVersionAvailable(currentVersion) {\n  const recentRelease = await getGithubRelease();\n  let recentReleaseVersion = recentRelease.tag_name;\n\n  if (recentReleaseVersion.substr(0, 1) === 'v') {\n    recentReleaseVersion = recentReleaseVersion.substr(1);\n  }\n\n  if (!upToDate(currentVersion, recentReleaseVersion)) {\n    return recentReleaseVersion;\n  }\n\n  return null;\n}\n","// convert newlines to <br>s\nexport function addNewlines(str) {\n  return str.replace(/(?:\\r\\n|\\r|\\n)/g, '<br />');\n}\n\nexport function pluralize(string, count) {\n  if (count === 1) {\n    return string;\n  }\n  return `${string}s`;\n}\n\n// Trying to determine if browser is mobile/tablet.\n// Source: https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\nexport function hasTouchScreen() {\n  let hasTouch = false;\n  if ('maxTouchPoints' in navigator) {\n    hasTouch = navigator.maxTouchPoints > 0;\n  } else if ('msMaxTouchPoints' in navigator) {\n    hasTouch = navigator.msMaxTouchPoints > 0;\n  } else {\n    const mQ = window.matchMedia && matchMedia('(pointer:coarse)');\n    if (mQ && mQ.media === '(pointer:coarse)') {\n      hasTouch = !!mQ.matches;\n    } else if ('orientation' in window) {\n      hasTouch = true; // deprecated, but good fallback\n    } else {\n      // Only as a last resort, fall back to user agent sniffing\n      hasTouch = navigator.userAgentData.mobile;\n    }\n  }\n  return hasTouch;\n}\n\nexport function padLeft(text, pad, size) {\n  return String(pad.repeat(size) + text).slice(-size);\n}\n\nexport function parseSecondsToDurationString(seconds = 0) {\n  const finiteSeconds = Number.isFinite(+seconds) ? Math.abs(seconds) : 0;\n\n  const days = Math.floor(finiteSeconds / 86400);\n  const daysString = days > 0 ? `${days} day${days > 1 ? 's' : ''} ` : '';\n\n  const hours = Math.floor((finiteSeconds / 3600) % 24);\n  const hoursString = hours || days ? padLeft(`${hours}:`, '0', 3) : '';\n\n  const mins = Math.floor((finiteSeconds / 60) % 60);\n  const minString = padLeft(`${mins}:`, '0', 3);\n\n  const secs = Math.floor(finiteSeconds % 60);\n  const secsString = padLeft(`${secs}`, '0', 2);\n\n  return daysString + hoursString + minString + secsString;\n}\n\nexport function setVHvar() {\n  const vh = window.innerHeight * 0.01;\n  // Then we set the value in the --vh custom property to the root of the document\n  document.documentElement.style.setProperty('--vh', `${vh}px`);\n}\n\nexport function doesObjectSupportFunction(object, functionName) {\n  return typeof object[functionName] === 'function';\n}\n\n// return a string of css classes\nexport function classNames(json) {\n  const classes = [];\n\n  Object.entries(json).map(item => {\n    const [key, value] = item;\n    if (value) {\n      classes.push(key);\n    }\n    return null;\n  });\n  return classes.join(' ');\n}\n\n// taken from\n// https://medium.com/@TCAS3/debounce-deep-dive-javascript-es6-e6f8d983b7a1\nexport function debounce(fn, time) {\n  let timeout;\n\n  return function () {\n    // eslint-disable-next-line prefer-rest-params\n    const functionCall = () => fn.apply(this, arguments);\n\n    clearTimeout(timeout);\n    timeout = setTimeout(functionCall, time);\n  };\n}\n\nexport function getDiffInDaysFromNow(timestamp) {\n  const time = typeof timestamp === 'string' ? new Date(timestamp) : timestamp;\n  return (new Date() - time) / (24 * 3600 * 1000);\n}\n\n// \"Last live today at [time]\" or \"last live [date]\"\nexport function makeLastOnlineString(timestamp) {\n  if (!timestamp) {\n    return '';\n  }\n  let string = '';\n  const time = new Date(timestamp);\n  const comparisonDate = new Date(time).setHours(0, 0, 0, 0);\n\n  if (comparisonDate === new Date().setHours(0, 0, 0, 0)) {\n    const atTime = time.toLocaleTimeString([], {\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n    string = `Today ${atTime}`;\n  } else {\n    string = time.toLocaleDateString();\n  }\n\n  return `Last live: ${string}`;\n}\n\n// Routing & Tabs\nexport const ROUTE_RECORDINGS = 'recordings';\nexport const ROUTE_SCHEDULE = 'schedule';\n// looks for `/recording|schedule/id` pattern to determine what to display from the tab view\nexport function checkUrlPathForDisplay() {\n  const pathTest = [ROUTE_RECORDINGS, ROUTE_SCHEDULE];\n  const pathParts = window.location.pathname.split('/');\n\n  if (pathParts.length >= 2) {\n    const part = pathParts[1].toLowerCase();\n    if (pathTest.includes(part)) {\n      return {\n        section: part,\n        sectionId: pathParts[2] || '',\n      };\n    }\n  }\n  return null;\n}\n\nexport function paginateArray(items, page, perPage) {\n  const offset = perPage * (page - 1);\n  const totalPages = Math.ceil(items.length / perPage);\n  const paginatedItems = items.slice(offset, perPage * page);\n\n  return {\n    previousPage: page - 1 ? page - 1 : null,\n    nextPage: totalPages > page ? page + 1 : null,\n    total: items.length,\n    totalPages,\n    items: paginatedItems,\n  };\n}\n\n// Take a nested object of state metadata and merge it into\n// a single flattened node.\nexport function mergeMeta(meta) {\n  return Object.keys(meta).reduce((acc, key) => {\n    const value = meta[key];\n    Object.assign(acc, value);\n\n    return acc;\n  }, {});\n}\n","export const LOCAL_STORAGE_KEYS = {\n  username: 'username',\n  hasDisplayedNotificationModal: 'HAS_DISPLAYED_NOTIFICATION_MODAL',\n  userVisitCount: 'USER_VISIT_COUNT',\n};\n\nexport function getLocalStorage(key) {\n  try {\n    return localStorage.getItem(key);\n  } catch (e) {}\n  return null;\n}\n\nexport function setLocalStorage(key, value) {\n  try {\n    if (value !== '' && value !== null) {\n      localStorage.setItem(key, value);\n    } else {\n      localStorage.removeItem(key);\n    }\n    return true;\n  } catch (e) {}\n  return false;\n}\n\nexport function clearLocalStorage(key) {\n  localStorage.removeItem(key);\n}\n\n// jump down to the max height of a div, with a slight delay\nexport function jumpToBottom(element, behavior) {\n  if (!element) return;\n\n  if (!behavior) {\n    behavior = document.visibilityState === 'visible' ? 'smooth' : 'instant';\n  }\n\n  setTimeout(\n    () => {\n      element.scrollTo({\n        top: element.scrollHeight,\n        left: 0,\n        behavior,\n      });\n    },\n    50,\n    element,\n  );\n}\n"],"names":["serverStatusRefreshPoll","AppStateEvent","client_config_service","getConfig","response","fetch","status","json","chat_service","getChatHistory","accessToken","getUnauthedData","concat","registerUser","username","options","method","headers","body","JSON","stringify","displayName","WebsocketService","createAndConnect","host","url","URL","protocol","window","location","pathname","port","searchParams","append","console","debug","toString","ws","WebSocket","onopen","onOpen","bind","onerror","onError","onmessage","onMessage","websocket","websocketReconnectTimer","clearTimeout","e","error","close","isShutdown","scheduleReconnect","backOff","setTimeout","Math","min","shutdown","socketEvent","messages","data","split","i","length","parse","handleMessage","err","type","MessageType","sendPong","isConnected","_this_websocket","_this_websocket1","readyState","OPEN","send","warn","messageJSON","pong","constructor","path","Loading","Loaded","Online","Offline","NeedsRegister","Fail","appStateModel","createMachine","id","initial","predictableActionArguments","states","loading","meta","chatAvailable","chatLoading","videoAvailable","appLoading","on","NEEDS_REGISTER","target","LOADED","FAIL","ready","online","OFFLINE","offline","ONLINE","goodbye","after","serverFailure","userfailure","connected_client_info_handler","message","setChatAuthenticated","setCurrentUser","user","displayColor","scopes","authenticated","isModerator","includes","status_service","getStatus","eventhandlers_handleNameChangeEvent","setChatMessages","currentState","RecoilEnv","ACCESS_TOKEN_KEY","serverStatusState","atom","key","default","viewerCount","serverTime","Date","clientConfigStateAtom","name","summary","offlineMessage","logo","tags","version","nsfw","extraPageContent","socialHandles","chatDisabled","externalActions","customStyles","appearanceVariables","Map","maxSocketPayloadSize","federation","enabled","account","followerCount","notifications","browser","publicKey","authentication","indieAuthEnabled","accessTokenAtom","currentUserAtom","chatMessagesAtom","chatAuthenticatedAtom","websocketServiceAtom","dangerouslyAllowMutability","appStateAtom","isMobileAtom","undefined","chatVisibleToggleAtom","isVideoPlayingAtom","fatalErrorStateAtom","clockSkewAtom","removedMessageIdsAtom","isChatVisibleSelector","selector","get","param","state","userVisibleToggle","isChatAvailableSelector","isOnlineSelector","isVideoPlaying","visibleChatMessagesSelector","removedIds","filter","ClientConfigStore","appState","appStateSend","appStateService","useMachine","currentUser","useRecoilState","useSetRecoilState","clientConfig","setClientConfig","serverStatus","setServerStatus","setClockSkew","chatMessages","setAccessToken","setAppState","setGlobalFatalErrorMessage","setWebsocketService","hiddenMessageIds","setHiddenMessageIds","setHasLoadedStatus","useState","hasLoadedConfig","setHasLoadedConfig","setGlobalFatalError","title","sendEvent","event","handleStatusChange","matches","updateClientConfig","config","ClientConfigService","updateServerStatus","ServerStatusService","clockSkew","getTime","now","handleUserRegistration","optionalDisplayName","savedAccessToken","getLocalStorage","ChatService","newAccessToken","newDisplayName","setLocalStorage","resetAndReAuth","handleMessageVisibilityChange","ids","visible","updatedIds","handleConnectedClientInfoMessage","handleNameChangeEvent","startChat","socketHostOverride","handleChatNotification","useEffect","configHydration","statusHydration","clearInterval","setInterval","onTransition","metadata","mergeMeta","CHAT","PING","NAME_CHANGE","COLOR_CHANGE","PONG","SYSTEM","USER_JOINED","CHAT_ACTION","FEDIVERSE_ENGAGEMENT_FOLLOW","FEDIVERSE_ENGAGEMENT_LIKE","FEDIVERSE_ENGAGEMENT_REPOST","CONNECTED_USER_INFO","ERROR_USER_DISABLED","ERROR_NEEDS_REGISTRATION","ERROR_MAX_CONNECTIONS_EXCEEDED","VISIBILITY_UPDATE","ADMIN_USERNAME","process","env","NEXT_PUBLIC_ADMIN_USERNAME","ADMIN_STREAMKEY","NEXT_PUBLIC_ADMIN_STREAMKEY","NEXT_PUBLIC_API_HOST","API_LOCATION","FETCH_INTERVAL","STATUS","SERVER_CONFIG","SERVER_CONFIG_UPDATE_URL","VIEWERS_OVER_TIME","ACTIVE_VIEWER_DETAILS","CONNECTED_CLIENTS","DISABLED_USERS","USER_ENABLED_TOGGLE","BANNED_IPS","BANNED_IP_REMOVE","USER_SET_MODERATOR","MODERATORS","HARDWARE_STATS","LOGS_ALL","LOGS_WARN","CHAT_HISTORY","UPDATE_CHAT_MESSGAE_VIZ","UPLOAD_EMOJI","DELETE_EMOJI","ACCESS_TOKENS","DELETE_ACCESS_TOKEN","CREATE_ACCESS_TOKEN","WEBHOOKS","DELETE_WEBHOOK","CREATE_WEBHOOK","SOCIAL_PLATFORMS_LIST","FEDERATION_MESSAGE_SEND","FOLLOWERS","FOLLOWERS_PENDING","FOLLOWERS_BLOCKED","SET_FOLLOWER_APPROVAL","FEDERATION_ACTIONS","API_STREAM_HEALTH_METRICS","UPDATE_STREAM_KEYS","API_YP_RESET","fetchData","auth","requestOptions","encoded","btoa","Authorization","mode","credentials","ok","opts","fetchExternalData","referrerPolicy","referrer","log","getGithubRelease","VPAT","upgradeVersionAvailable","currentVersion","recentRelease","recentReleaseVersion","tag_name","substr","upToDate","local","remote","test","lparts","push","rparts","l","parseInt","r","getDiffInDaysFromNow","timestamp","time","Object","keys","reduce","acc","value","assign","LOCAL_STORAGE_KEYS","hasDisplayedNotificationModal","userVisitCount","localStorage","getItem","setItem","removeItem"],"sourceRoot":""}