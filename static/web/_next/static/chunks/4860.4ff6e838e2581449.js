(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4860],{94860:function(e,n,t){"use strict";t.r(n),t.d(n,{ChatModerationActionMenu:function(){return I}});var s=t(85893),o=t(11475),a=t(90420),r=t(18429),c=t(64942),i=t(85402),l=t(12461),d=t(66516),u=t(13013),h=t(26713),p=t(67294),m=t(14761),x=t(54907),y=t(71230),j=t(15746),f=t(71577),g=t(11382),v=t(20550),C=t(48213),b=t(58091),k=t(48689);var w=class{static async removeMessage(e,n){const t=new URL("/api/chat/messagevisibility",window.location.toString());t.searchParams.append("accessToken",n);const s=t.toString(),o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idArray:[e]})};await fetch(s,o)}static async banUser(e,n){const t=new URL("/api/chat/users/setenabled",window.location.toString());t.searchParams.append("accessToken",n);const s=t.toString(),o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})};await fetch(s,o)}},Z=t(57761),M=t.n(Z),_=t(70241);const{Panel:S}=x.Z,A=e=>{let{label:n,value:t}=e;return(0,s.jsxs)(y.Z,{justify:"space-around",align:"middle",children:[(0,s.jsx)(j.Z,{span:12,children:n}),(0,s.jsx)(j.Z,{span:12,children:t})]})},N=e=>{let{client:n}=e;const{messageCount:t,connectedAt:o,geo:a}=n,r=(0,b.Z)(new Date(o),"PP pp");return(0,s.jsxs)("div",{children:[(0,s.jsx)(A,{label:"Messages Sent",value:"".concat(t)}),"N/A"!==a&&(0,s.jsx)(A,{label:"Geo",value:a}),(0,s.jsx)(A,{label:"Connected At",value:r})]})},P=e=>{let{color:n}=e;const t="var(--theme-color-users-".concat(n,")");return(0,s.jsxs)("div",{className:M().colorBlock,style:{backgroundColor:t},children:["Color ",n]})},D=e=>{let{userId:n,accessToken:t}=e;const[o,a]=(0,p.useState)(null),[r,c]=(0,p.useState)(!0);if((0,p.useEffect)((()=>{(async()=>{try{const e=await(await fetch("/api/moderation/chat/user/".concat(n,"?accessToken=").concat(t))).json();a(e),c(!1)}catch(e){console.error(e)}})()}),[]),!o)return null;const{user:i,connectedClients:l,messages:d}=o,{displayColor:u,createdAt:h,previousNames:m,scopes:y,isBot:j,authenticated:Z}=i,M=l.reduce(((e,n)=>e+n.messageCount),0),D=(0,b.Z)(new Date(h),"PP pp"),O=[{title:"Message",dataIndex:"body",key:"body"},{title:"Sent At",dataIndex:"timestamp",key:"timestamp",render:e=>(0,b.Z)(new Date(e),"PP pp")},{title:"Delete",key:"delete",render:(e,n)=>(0,s.jsx)(f.Z,{type:"primary",ghost:!0,icon:(0,s.jsx)(k.Z,{}),onClick:()=>(async(e,n)=>{try{w.removeMessage(e,n)}catch(t){console.error(t)}})(n.id,t)})}];return(0,s.jsxs)(g.Z,{spinning:r,children:[(0,s.jsx)(P,{color:u}),y.map((e=>(0,s.jsx)(v.Z,{children:e},e))),Z&&(0,s.jsx)(v.Z,{children:"Authenticated"}),j&&(0,s.jsx)(v.Z,{children:"Bot"}),(0,s.jsx)(A,{label:"Messages Sent Across Clients",value:M.toString()}),(0,s.jsx)(A,{label:"User Created",value:D}),(0,s.jsx)(A,{label:"Known As",value:m.join(",")}),(0,s.jsxs)(x.Z,{accordion:!0,children:[(0,s.jsx)(S,{header:"Currently Connected Clients",children:(0,s.jsx)(x.Z,{accordion:!0,children:l.map((e=>(0,s.jsx)(S,{header:(0,_.AB)(e.userAgent),children:(0,s.jsx)(N,{client:e})},e.id)))})},"connected-clients"),(0,s.jsx)(x.Z,{accordion:!0,children:(0,s.jsx)(S,{header:"Recent Chat Messages",children:(0,s.jsx)(C.Z,{size:"small",pagination:null,columns:O,dataSource:d,rowKey:"id"})},"chat-messages")})]})]})};var O=t(24110),T=t.n(O);const{confirm:B}=i.Z,I=e=>{let{messageID:n,userID:t,userDisplayName:i,accessToken:x}=e;const[y,j]=(0,p.useState)(!1),f=async()=>{B({icon:(0,s.jsx)(o.Z,{}),content:"Are you sure you want to remove this message from ".concat(i,"?"),onOk(){(async()=>{try{await w.removeMessage(n,x)}catch(e){console.error(e),l.ZP.error(e)}})()}})},g=async()=>{B({icon:(0,s.jsx)(o.Z,{}),content:"Are you sure you want to ban ".concat(i," from chat?"),onOk(){(async()=>{try{await w.banUser(t,x)}catch(e){console.error(e),l.ZP.error(e)}})()}})},v=(0,s.jsx)(d.Z,{onClick:e=>{let{key:n}=e;"hide-message"===n?f():"ban-user"===n?g():"more-info"===n&&j(!0)},items:[{label:(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:T().icon,children:(0,s.jsx)(a.Z,{})}),"Hide Message"]}),key:"hide-message"},{label:(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:T().icon,children:(0,s.jsx)(r.Z,{})}),"Ban User"]}),key:"ban-user"},{label:(0,s.jsx)("div",{children:"More Info..."}),key:"more-info"}]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{overlay:v,trigger:["click"],children:(0,s.jsx)("button",{type:"button",onClick:e=>e.preventDefault(),children:(0,s.jsx)(h.Z,{children:(0,s.jsx)(c.Z,{})})})}),(0,s.jsx)(m.Modal,{title:i,open:y,handleCancel:()=>{j(!1)},children:(0,s.jsx)(D,{userId:t,accessToken:x})})]})}},14761:function(e,n,t){"use strict";t.r(n),t.d(n,{Modal:function(){return d}});var s=t(85893),o=t(85402),a=t(26303),r=t(11382),c=t(67294),i=t(77011),l=t.n(i);const d=e=>{let{title:n,url:t,open:i,handleOk:d,handleCancel:u,afterClose:h,height:p,width:m,children:x}=e;const[y,j]=(0,c.useState)(!!t);let f="100%",g="520px";t&&(f="70vh",g="900px");const v={padding:"0px",minHeight:p,height:null!==p&&void 0!==p?p:f},C=t&&(0,s.jsx)("iframe",{title:n,src:t,width:"100%",height:"100%",sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",frameBorder:"0",allowFullScreen:!0,style:{display:"block"},onLoad:()=>j(!1)}),b=y?"none":"inline";return(0,s.jsx)(o.Z,{title:n,open:i,onOk:d,onCancel:u,afterClose:h,bodyStyle:v,width:null!==m&&void 0!==m?m:g,zIndex:999,footer:null,centered:!0,destroyOnClose:!0,children:(0,s.jsxs)("div",{id:"modal-container",style:{height:"100%"},children:[y&&(0,s.jsx)(a.Z,{active:y,style:{padding:"10px"},paragraph:{rows:10}}),C&&(0,s.jsx)("div",{style:{display:b},children:C}),x&&(0,s.jsx)("div",{className:l().content,children:x}),y&&(0,s.jsx)(r.Z,{className:l().spinner,spinning:y,size:"large"})]})})};n.default=d,d.defaultProps={url:void 0,children:void 0,handleOk:void 0,handleCancel:void 0,afterClose:void 0}},70241:function(e,n,t){"use strict";t.d(n,{AB:function(){return l},Qr:function(){return r},t5:function(){return a},wS:function(){return i}});var s=t(42238),o=t.n(s);function a(e){const n=e.split(":");n[n.length-1]="";let t=n.join(":");return t=t.slice(0,t.length-1),"[::1]"===t||"127.0.0.1"===t?"Localhost":t}function r(e){return!e||0===Object.keys(e).length&&e.constructor===Object}function c(e,n,t){return String(n.repeat(t)+e).slice(-t)}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const n=Number.isFinite(+e)?Math.abs(e):0,t=Math.floor(n/86400),s=t>0?"".concat(t," day").concat(t>1?"s":""," "):"",o=Math.floor(n/3600%24),a=o||t?c("".concat(o,":"),"0",3):"",r=Math.floor(n/60%60),i=c("".concat(r,":"),"0",3),l=Math.floor(n%60),d=c("".concat(l),"0",2);return s+a+i+d}function l(e){const n=o()(e),{device:t,os:s,browser:a}=n,{major:r,name:c}=a,{version:i,name:l}=s,{model:d,type:u}=t;if("libmpv"===e)return"mpv media player";if(!c||!r||!l)return e;const h=d||u?" (".concat(d||u,")"):"";return"".concat(c," ").concat(r," on ").concat(l," ").concat(i,"\n  ").concat(h)}},24110:function(e){e.exports={icon:"ChatModerationActionMenu_icon__9j6DF"}},57761:function(e){e.exports={modalContainer:"ChatModerationDetailsModal_modalContainer__czndV",chatHistory:"ChatModerationDetailsModal_chatHistory__PunRk",colorBlock:"ChatModerationDetailsModal_colorBlock___rAlw",displayName:"ChatModerationDetailsModal_displayName__p7pLI"}},77011:function(e){e.exports={spinner:"Modal_spinner__GiSS0",content:"Modal_content__h9my9"}}}]);
//# sourceMappingURL=4860.4ff6e838e2581449.js.map