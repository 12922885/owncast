(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7781],{87781:function(e,n,t){"use strict";t.r(n),t.d(n,{ChatModerationActionMenu:function(){return H}});var r=t(47568),s=t(70655),o=t(85893),a=t(11475),i=t(90420),c=t(18429),l=t(64942),u=t(85402),d=t(12461),h=t(66516),f=t(38504),p=t(26713),x=t(67294),j=t(32365),g=t(54907),m=t(25968),v=t(6226),y=t(71577),_=t(11382),Z=t(20550),C=t(93626),b=t(58091),k=t(48689),w=t(51438),M=function(){function e(){(0,w.Z)(this,e)}return e.removeMessage=function(e,n){return(0,r.Z)((function(){var t,r,o;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return(t=new URL("/api/chat/messagevisibility",window.location.toString())).searchParams.append("accessToken",n),r=t.toString(),o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idArray:[e]})},[4,fetch(r,o)];case 1:return s.sent(),[2]}}))}))()},e.banUser=function(e,n){return(0,r.Z)((function(){var t,r,o;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return(t=new URL("/api/chat/users/setenabled",window.location.toString())).searchParams.append("accessToken",n),r=t.toString(),o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})},[4,fetch(r,o)];case 1:return s.sent(),[2]}}))}))()},e}(),S=t(62638),A=t.n(S),P=t(2766),N=g.Z.Panel,D=function(){var e=(0,r.Z)((function(e,n){return(0,s.__generator)(this,(function(t){try{M.removeMessage(e,n)}catch(r){console.error(r)}return[2]}))}));return function(n,t){return e.apply(this,arguments)}}(),O=function(e){var n=e.label,t=e.value;return(0,o.jsxs)(m.Z,{justify:"space-around",align:"middle",children:[(0,o.jsx)(v.Z,{span:12,children:n}),(0,o.jsx)(v.Z,{span:12,children:t})]})},T=function(e){var n=e.client,t=n.messageCount,r=n.connectedAt,s=n.geo,a=(0,b.Z)(new Date(r),"PP pp");return(0,o.jsxs)("div",{children:[(0,o.jsx)(O,{label:"Messages Sent",value:"".concat(t)}),"N/A"!==s&&(0,o.jsx)(O,{label:"Geo",value:s}),(0,o.jsx)(O,{label:"Connected At",value:a})]})},I=function(e){var n=e.color,t="var(--theme-color-users-".concat(n,")");return(0,o.jsxs)("div",{className:A().colorBlock,style:{backgroundColor:t},children:["Color ",n]})},B=function(e){var n=e.userId,t=e.accessToken,a=(0,x.useState)(null),i=a[0],c=a[1],l=(0,x.useState)(!0),u=l[0],d=l[1],h=function(){var e=(0,r.Z)((function(){var e,r;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,fetch("/api/moderation/chat/user/".concat(n,"?accessToken=").concat(t))];case 1:return[4,s.sent().json()];case 2:return e=s.sent(),c(e),d(!1),[3,4];case 3:return r=s.sent(),console.error(r),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}();if((0,x.useEffect)((function(){h()}),[]),!i)return null;var f=i.user,p=i.connectedClients,j=i.messages,m=f.displayColor,v=f.createdAt,w=f.previousNames,M=f.scopes,S=f.isBot,A=f.authenticated,B=p.reduce((function(e,n){return e+n.messageCount}),0),U=(0,b.Z)(new Date(v),"PP pp"),z=[{title:"Message",dataIndex:"body",key:"body"},{title:"Sent At",dataIndex:"timestamp",key:"timestamp",render:function(e){return(0,b.Z)(new Date(e),"PP pp")}},{title:"Delete",key:"delete",render:function(e,n){return(0,o.jsx)(y.Z,{type:"primary",ghost:!0,icon:(0,o.jsx)(k.Z,{}),onClick:function(){return D(n.id,t)}})}}];return(0,o.jsxs)(_.Z,{spinning:u,children:[(0,o.jsx)(I,{color:m}),M.map((function(e){return(0,o.jsx)(Z.Z,{children:e},e)})),A&&(0,o.jsx)(Z.Z,{children:"Authenticated"}),S&&(0,o.jsx)(Z.Z,{children:"Bot"}),(0,o.jsx)(O,{label:"Messages Sent Across Clients",value:B.toString()}),(0,o.jsx)(O,{label:"User Created",value:U}),(0,o.jsx)(O,{label:"Known As",value:w.join(",")}),(0,o.jsxs)(g.Z,{accordion:!0,children:[(0,o.jsx)(N,{header:"Currently Connected Clients",children:(0,o.jsx)(g.Z,{accordion:!0,children:p.map((function(e){return(0,o.jsx)(N,{header:(0,P.AB)(e.userAgent),children:(0,o.jsx)(T,{client:e})},e.userAgent)}))})},"connected-clients"),(0,o.jsx)(g.Z,{accordion:!0,children:(0,o.jsx)(N,{header:"Recent Chat Messages",children:(0,o.jsx)(C.Z,{size:"small",pagination:null,columns:z,dataSource:j})},"chat-messages")})]})]})},U=t(31833),z=t.n(U),F=u.Z.confirm,H=function(e){var n=e.messageID,t=e.userID,u=e.userDisplayName,g=e.accessToken,m=(0,x.useState)(!1),v=m[0],y=m[1],_=function(){var e=(0,r.Z)((function(){var e;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,M.banUser(t,g)];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),console.error(e),d.ZP.error(e),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=(0,r.Z)((function(){var e;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,M.removeMessage(n,g)];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),console.error(e),d.ZP.error(e),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=(0,r.Z)((function(){return(0,s.__generator)(this,(function(e){return F({icon:(0,o.jsx)(a.Z,{}),content:"Are you sure you want to remove this message from ".concat(u,"?"),onOk:function(){Z()}}),[2]}))}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=(0,r.Z)((function(){return(0,s.__generator)(this,(function(e){return F({icon:(0,o.jsx)(a.Z,{}),content:"Are you sure you want to ban ".concat(u," from chat?"),onOk:function(){_()}}),[2]}))}));return function(){return e.apply(this,arguments)}}(),k=(0,o.jsx)(h.Z,{onClick:function(e){var n=e.key;"hide-message"===n?C():"ban-user"===n?b():"more-info"===n&&y(!0)},items:[{label:(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:z().icon,children:(0,o.jsx)(i.Z,{})}),"Hide Message"]}),key:"hide-message"},{label:(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:z().icon,children:(0,o.jsx)(c.Z,{})}),"Ban User"]}),key:"ban-user"},{label:(0,o.jsx)("div",{children:"More Info..."}),key:"more-info"}]});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.Z,{overlay:k,trigger:["click"],children:(0,o.jsx)("button",{type:"button",onClick:function(e){return e.preventDefault()},children:(0,o.jsx)(p.Z,{children:(0,o.jsx)(l.Z,{})})})}),(0,o.jsx)(j.Modal,{title:u,open:v,handleCancel:function(){y(!1)},children:(0,o.jsx)(B,{userId:t,accessToken:g})})]})}},32365:function(e,n,t){"use strict";t.r(n),t.d(n,{Modal:function(){return u}});var r=t(85893),s=t(85402),o=t(26303),a=t(11382),i=t(67294),c=t(78890),l=t.n(c),u=function(e){var n=e.title,t=e.url,c=e.open,u=e.handleOk,d=e.handleCancel,h=e.afterClose,f=e.height,p=e.width,x=e.children,j=(0,i.useState)(!!t),g=j[0],m=j[1],v={padding:"0px",minHeight:f,height:null!==f&&void 0!==f?f:"100%"},y=t&&(0,r.jsx)("iframe",{title:n,src:t,width:"100%",height:"100%",sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",frameBorder:"0",allowFullScreen:!0,onLoad:function(){return m(!1)}}),_=g?"none":"inline";return(0,r.jsx)(s.Z,{title:n,open:c,onOk:u,onCancel:d,afterClose:h,bodyStyle:v,width:p,zIndex:9999,footer:null,centered:!0,destroyOnClose:!0,children:(0,r.jsxs)(r.Fragment,{children:[g&&(0,r.jsx)(o.Z,{active:g,style:{padding:"10px"},paragraph:{rows:10}}),y&&(0,r.jsx)("div",{style:{display:_},children:y}),x&&(0,r.jsx)("div",{className:l().content,children:x}),g&&(0,r.jsx)(a.Z,{className:l().spinner,spinning:g,size:"large"})]})})};n.default=u,u.defaultProps={url:void 0,children:void 0,handleOk:void 0,handleCancel:void 0,afterClose:void 0}},31833:function(e){e.exports={icon:"ChatModerationActionMenu_icon__9j6DF"}},62638:function(e){e.exports={modalContainer:"ChatModerationDetailsModal_modalContainer__czndV",chatHistory:"ChatModerationDetailsModal_chatHistory__PunRk",colorBlock:"ChatModerationDetailsModal_colorBlock___rAlw",displayName:"ChatModerationDetailsModal_displayName__p7pLI"}},78890:function(e){e.exports={spinner:"Modal_spinner__GiSS0",content:"Modal_content__h9my9"}}}]);