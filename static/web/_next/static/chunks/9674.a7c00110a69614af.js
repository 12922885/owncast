(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9674],{54907:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var a=n(87462),r=n(4942),s=n(18073),i=n(94184),o=n.n(i),c=n(74902),l=n(15671),u=n(43144),d=n(60136),p=n(33643),h=n(71002),v=n(67294),f=n(96774),m=n.n(f),y=n(50344),x=n(62874),g=n(97685),Z=v.forwardRef((function(e,t){var n,a=e.prefixCls,s=e.forceRender,i=e.className,c=e.style,l=e.children,u=e.isActive,d=e.role,p=v.useState(u||s),h=(0,g.Z)(p,2),f=h[0],m=h[1];return v.useEffect((function(){(s||u)&&m(!0)}),[s,u]),f?v.createElement("div",{ref:t,className:o()("".concat(a,"-content"),(n={},(0,r.Z)(n,"".concat(a,"-content-active"),u),(0,r.Z)(n,"".concat(a,"-content-inactive"),!u),n),i),style:c,role:d},v.createElement("div",{className:"".concat(a,"-content-box")},l)):null}));Z.displayName="PanelContent";var b=Z,C=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;(0,l.Z)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onItemClick=function(){var t=e.props,n=t.onItemClick,a=t.panelKey;"function"===typeof n&&n(a)},e.handleKeyPress=function(t){"Enter"!==t.key&&13!==t.keyCode&&13!==t.which||e.onItemClick()},e.renderIcon=function(){var t=e.props,n=t.showArrow,a=t.expandIcon,r=t.prefixCls,s=t.collapsible;if(!n)return null;var i="function"===typeof a?a(e.props):v.createElement("i",{className:"arrow"});return i&&v.createElement("div",{className:"".concat(r,"-expand-icon"),onClick:"header"===s?e.onItemClick:null},i)},e.renderTitle=function(){var t=e.props,n=t.header,a=t.prefixCls,r=t.collapsible;return v.createElement("span",{className:"".concat(a,"-header-text"),onClick:"header"===r?e.onItemClick:null},n)},e}return(0,u.Z)(n,[{key:"shouldComponentUpdate",value:function(e){return!m()(this.props,e)}},{key:"render",value:function(){var e,t,n=this.props,s=n.className,i=n.id,c=n.style,l=n.prefixCls,u=n.headerClass,d=n.children,p=n.isActive,h=n.destroyInactivePanel,f=n.accordion,m=n.forceRender,y=n.openMotion,g=n.extra,Z=n.collapsible,C="disabled"===Z,N="header"===Z,j=o()((e={},(0,r.Z)(e,"".concat(l,"-item"),!0),(0,r.Z)(e,"".concat(l,"-item-active"),p),(0,r.Z)(e,"".concat(l,"-item-disabled"),C),e),s),I={className:o()("".concat(l,"-header"),(t={},(0,r.Z)(t,u,u),(0,r.Z)(t,"".concat(l,"-header-collapsible-only"),N),t)),"aria-expanded":p,"aria-disabled":C,onKeyPress:this.handleKeyPress};N||(I.onClick=this.onItemClick,I.role=f?"tab":"button",I.tabIndex=C?-1:0);var k=null!==g&&void 0!==g&&"boolean"!==typeof g;return v.createElement("div",{className:j,style:c,id:i},v.createElement("div",I,this.renderIcon(),this.renderTitle(),k&&v.createElement("div",{className:"".concat(l,"-extra")},g)),v.createElement(x.Z,(0,a.Z)({visible:p,leavedClassName:"".concat(l,"-content-hidden")},y,{forceRender:m,removeOnLeave:h}),(function(e,t){var n=e.className,a=e.style;return v.createElement(b,{ref:t,prefixCls:l,className:n,style:a,isActive:p,forceRender:m,role:f?"tabpanel":null},d)})))}}]),n}(v.Component);C.defaultProps={showArrow:!0,isActive:!1,onItemClick:function(){},headerClass:"",forceRender:!1};var N=C;function j(e){var t=e;if(!Array.isArray(t)){var n=(0,h.Z)(t);t="number"===n||"string"===n?[t]:[]}return t.map((function(e){return String(e)}))}var I=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(e){var a;(0,l.Z)(this,n),(a=t.call(this,e)).onClickItem=function(e){var t=a.state.activeKey;if(a.props.accordion)t=t[0]===e?[]:[e];else{var n=(t=(0,c.Z)(t)).indexOf(e);n>-1?t.splice(n,1):t.push(e)}a.setActiveKey(t)},a.getNewChild=function(e,t){if(!e)return null;var n=a.state.activeKey,r=a.props,s=r.prefixCls,i=r.openMotion,o=r.accordion,c=r.destroyInactivePanel,l=r.expandIcon,u=r.collapsible,d=e.key||String(t),p=e.props,h=p.header,f=p.headerClass,m=p.destroyInactivePanel,y=p.collapsible,x=null!==y&&void 0!==y?y:u,g={key:d,panelKey:d,header:h,headerClass:f,isActive:o?n[0]===d:n.indexOf(d)>-1,prefixCls:s,destroyInactivePanel:null!==m&&void 0!==m?m:c,openMotion:i,accordion:o,children:e.props.children,onItemClick:"disabled"===x?null:a.onClickItem,expandIcon:l,collapsible:x};return"string"===typeof e.type?e:(Object.keys(g).forEach((function(e){"undefined"===typeof g[e]&&delete g[e]})),v.cloneElement(e,g))},a.getItems=function(){var e=a.props.children;return(0,y.Z)(e).map(a.getNewChild)},a.setActiveKey=function(e){"activeKey"in a.props||a.setState({activeKey:e}),a.props.onChange(a.props.accordion?e[0]:e)};var r=e.activeKey,s=e.defaultActiveKey;return"activeKey"in e&&(s=r),a.state={activeKey:j(s)},a}return(0,u.Z)(n,[{key:"shouldComponentUpdate",value:function(e,t){return!m()(this.props,e)||!m()(this.state,t)}},{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,a=t.className,s=t.style,i=t.accordion,c=o()((e={},(0,r.Z)(e,n,!0),(0,r.Z)(e,a,!!a),e));return v.createElement("div",{className:c,style:s,role:i?"tablist":null},this.getItems())}}],[{key:"getDerivedStateFromProps",value:function(e){var t={};return"activeKey"in e&&(t.activeKey=j(e.activeKey)),t}}]),n}(v.Component);I.defaultProps={prefixCls:"rc-collapse",onChange:function(){},accordion:!1,destroyInactivePanel:!1},I.Panel=N;var k=I,w=(I.Panel,n(98423)),E=n(53124),A=n(33603),_=n(96159),P=function(e){var t,n=v.useContext(E.E_),i=n.getPrefixCls,c=n.direction,l=e.prefixCls,u=e.className,d=void 0===u?"":u,p=e.bordered,h=void 0===p||p,f=e.ghost,m=e.expandIconPosition,x=void 0===m?"start":m,g=i("collapse",l),Z=v.useMemo((function(){return"left"===x?"start":"right"===x?"end":x}),[x]),b=o()("".concat(g,"-icon-position-").concat(Z),(t={},(0,r.Z)(t,"".concat(g,"-borderless"),!h),(0,r.Z)(t,"".concat(g,"-rtl"),"rtl"===c),(0,r.Z)(t,"".concat(g,"-ghost"),!!f),t),d),C=(0,a.Z)((0,a.Z)({},A.ZP),{motionAppear:!1,leavedClassName:"".concat(g,"-content-hidden")});return v.createElement(k,(0,a.Z)({openMotion:C},e,{expandIcon:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.expandIcon,a=n?n(t):v.createElement(s.Z,{rotate:t.isActive?90:void 0});return(0,_.Tm)(a,(function(){return{className:o()(a.props.className,"".concat(g,"-arrow"))}}))},prefixCls:g,className:b}),function(){var t=e.children;return(0,y.Z)(t).map((function(e,t){var n;if(null===(n=e.props)||void 0===n?void 0:n.disabled){var r=e.key||String(t),s=e.props,i=s.disabled,o=s.collapsible,c=(0,a.Z)((0,a.Z)({},(0,w.Z)(e.props,["disabled"])),{key:r,collapsible:null!==o&&void 0!==o?o:i?"disabled":void 0});return(0,_.Tm)(e,c)}return e}))}())};P.Panel=function(e){var t=v.useContext(E.E_).getPrefixCls,n=e.prefixCls,s=e.className,i=void 0===s?"":s,c=e.showArrow,l=void 0===c||c,u=t("collapse",n),d=o()((0,r.Z)({},"".concat(u,"-no-arrow"),!l),i);return v.createElement(k.Panel,(0,a.Z)({},e,{prefixCls:u,className:d}))};var S=P},11382:function(e,t,n){"use strict";var a=n(87462),r=n(4942),s=n(97685),i=n(94184),o=n.n(i),c=n(23279),l=n.n(c),u=n(98423),d=n(67294),p=n(53124),h=n(96159),v=n(93355),f=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},m=((0,v.b)("small","default","large"),null);var y=function(e){var t=e.spinPrefixCls,n=e.spinning,i=void 0===n||n,c=e.delay,v=e.className,y=e.size,x=void 0===y?"default":y,g=e.tip,Z=e.wrapperClassName,b=e.style,C=e.children,N=f(e,["spinPrefixCls","spinning","delay","className","size","tip","wrapperClassName","style","children"]),j=d.useState((function(){return i&&!function(e,t){return!!e&&!!t&&!isNaN(Number(t))}(i,c)})),I=(0,s.Z)(j,2),k=I[0],w=I[1];d.useEffect((function(){var e=l()((function(){w(i)}),c);return e(),function(){var t;null===(t=null===e||void 0===e?void 0:e.cancel)||void 0===t||t.call(e)}}),[c,i]);var E=function(n){var s,i=n.direction,c=o()(t,(s={},(0,r.Z)(s,"".concat(t,"-sm"),"small"===x),(0,r.Z)(s,"".concat(t,"-lg"),"large"===x),(0,r.Z)(s,"".concat(t,"-spinning"),k),(0,r.Z)(s,"".concat(t,"-show-text"),!!g),(0,r.Z)(s,"".concat(t,"-rtl"),"rtl"===i),s),v),l=(0,u.Z)(N,["indicator","prefixCls"]),p=d.createElement("div",(0,a.Z)({},l,{style:b,className:c,"aria-live":"polite","aria-busy":k}),function(e,t){var n=t.indicator,a="".concat(e,"-dot");return null===n?null:(0,h.l$)(n)?(0,h.Tm)(n,{className:o()(n.props.className,a)}):(0,h.l$)(m)?(0,h.Tm)(m,{className:o()(m.props.className,a)}):d.createElement("span",{className:o()(a,"".concat(e,"-dot-spin"))},d.createElement("i",{className:"".concat(e,"-dot-item")}),d.createElement("i",{className:"".concat(e,"-dot-item")}),d.createElement("i",{className:"".concat(e,"-dot-item")}),d.createElement("i",{className:"".concat(e,"-dot-item")}))}(t,e),g?d.createElement("div",{className:"".concat(t,"-text")},g):null);if("undefined"!==typeof C){var f=o()("".concat(t,"-container"),(0,r.Z)({},"".concat(t,"-blur"),k));return d.createElement("div",(0,a.Z)({},l,{className:o()("".concat(t,"-nested-loading"),Z)}),k&&d.createElement("div",{key:"loading"},p),d.createElement("div",{className:f,key:"container"},C))}return p};return d.createElement(p.C,null,E)},x=function(e){var t=e.prefixCls,n=(0,d.useContext(p.E_).getPrefixCls)("spin",t),r=(0,a.Z)((0,a.Z)({},e),{spinPrefixCls:n});return d.createElement(y,(0,a.Z)({},r))};x.setDefaultIndicator=function(e){m=e},t.Z=x},9674:function(e,t,n){"use strict";n.r(t),n.d(t,{AuthModal:function(){return A}});var a=n(85893),r=n(84381),s=n(4480),i=n(47568),o=n(70655),c=n(54907),l=n(84485),u=n(11382),d=n(26713),p=n(14670),h=n(69677),v=n(67294),f=n(19411),m=c.Z.Panel,y=l.Z.Link,x=function(e){var t=e.authenticated,n=e.displayName,r=e.accessToken,s=(0,v.useState)(null),l=s[0],x=s[1],g=(0,v.useState)(!1),Z=g[0],b=g[1],C=(0,v.useState)(!1),N=C[0],j=C[1],I=(0,v.useState)(""),k=I[0],w=I[1],E=t?(0,a.jsxs)("span",{children:[(0,a.jsx)("b",{children:"You are already authenticated"}),". However, you can add other domains or log in as a different user."]}):(0,a.jsxs)("span",{children:["Use your own domain to authenticate ",(0,a.jsx)("span",{children:n})," or login as a previously"," ","authenticated chat user using IndieAuth."]}),A=l;A&&A.includes("url does not support indieauth")&&(A="The provided URL is either invalid or does not support IndieAuth.");var _=function(){var e=(0,i.Z)((function(){var e,t,n,a,s,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(!N)return[2];b(!0),o.label=1;case 1:return o.trys.push([1,4,,5]),e="/api/auth/indieauth?accessToken=".concat(r),t="https://".concat(k),n={authHost:t},[4,fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})];case 2:return[4,o.sent().json()];case 3:return(a=o.sent()).message?(x(a.message),b(!1),[2]):a.redirect?(a.redirect&&(s=a.redirect,window.location=s),[3,5]):(x("Auth provider did not return a redirect URL."),b(!1),[2]);case 4:return i=o.sent(),x(i.message),[3,5];case 5:return b(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,a.jsx)(u.Z,{spinning:Z,children:(0,a.jsxs)(d.Z,{direction:"vertical",children:[E,A&&(0,a.jsx)(p.Z,{message:"Error",description:A,type:"error",showIcon:!0}),(0,a.jsx)("div",{children:"Your domain"}),(0,a.jsx)(h.Z.Search,{addonBefore:"https://",onInput:function(e){if(":"!==e.nativeEvent.data){w(e.target.value);var t,n="https://".concat(e.target.value);t=n,(0,f.Z)(t)&&t.includes(".")?j(!0):j(!1)}},type:"url",value:k,placeholder:"yoursite.com",status:!N&&k.length>0?"error":void 0,onSearch:_}),(0,a.jsx)(c.Z,{ghost:!0,children:(0,a.jsxs)(m,{header:"Learn more about using IndieAuth to authenticate with chat.",children:[(0,a.jsx)("p",{children:"IndieAuth allows for a completely independent and decentralized way of identifying yourself using your own domain."}),(0,a.jsxs)("p",{children:["If you run an Owncast instance, you can use that domain here. Otherwise,"," ",(0,a.jsx)(y,{href:"https://indieauth.net/#providers",children:"learn more about how you can support IndieAuth"}),"."]})]},"header")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Note"}),": This is for authentication purposes only, and no personal information will be accessed or stored."]})]})})},g=n(71577),Z=n(55237),b=n.n(Z);var C=c.Z.Panel,N=function(e){var t=e.authenticated,n=e.displayName,r=e.accessToken,s=(0,v.useState)(null),l=s[0],f=s[1],m=(0,v.useState)(!1),y=m[0],x=m[1],Z=(0,v.useState)(!1),N=Z[0],j=Z[1],I=(0,v.useState)(""),k=I[0],w=I[1],E=(0,v.useState)(""),A=E[0],_=E[1],P=(0,v.useState)(!1),S=P[0],T=P[1],K=t?(0,a.jsxs)("span",{children:[(0,a.jsx)("b",{children:"You are already authenticated"}),". However, you can add other domains or log in as a different user."]}):(0,a.jsxs)("span",{children:["Receive a direct message on the Fediverse to link your account to"," ",(0,a.jsx)("strong",{children:n}),", or login as a previously linked chat user."]}),O=l;O&&O.includes("url does not support indieauth")&&(O="The provided URL is either invalid or does not support IndieAuth.");var F=function(e){j(function(e){var t=e.replace(/^@+/,"");return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(t).toLowerCase())}(e))},M=function(){var e=(0,i.Z)((function(e,t){var n;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return[4,fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return[4,a.sent().json()];case 2:return(n=a.sent()).message&&(f(n.message),x(!1)),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),R=function(){var e=(0,i.Z)((function(){var e,t,n;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:x(!0),e="/api/auth/fediverse/verify?accessToken=".concat(r),t={code:A},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,M(e,t)];case 2:return a.sent(),window.location.href="/",[3,4];case 3:return n=a.sent(),console.error(n),f(n),[3,4];case 4:return x(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,i.Z)((function(){var e,t,n,a;return(0,o.__generator)(this,(function(s){switch(s.label){case 0:if(!N)return[2];x(!0),f(null),e="/api/auth/fediverse?accessToken=".concat(r),t=k.replace(/^@+/,""),n={account:t},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,M(e,n)];case 2:return s.sent(),T(!0),[3,4];case 3:return a=s.sent(),console.error(a),f(a),[3,4];case 4:return x(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),U=(0,a.jsxs)("div",{children:["Paste in the code that was sent to your Fediverse account. If you did not receive a code, make sure you can accept direct messages.",(0,a.jsxs)("div",{className:b().codeInputContainer,children:[(0,a.jsx)(h.Z,{value:A,onChange:function(e){return _(e.target.value)},className:b().codeInput,placeholder:"123456",maxLength:6}),(0,a.jsx)(g.Z,{type:"primary",onClick:R,disabled:A.length<6,className:b().submitButton,children:"Verify Code"})]})]}),z=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{children:"Your Fediverse Account"}),(0,a.jsx)(h.Z.Search,{addonBefore:"@",onInput:function(e){w(e.target.value),F(e.target.value)},value:k,placeholder:"youraccount@yourserver.com",status:!N&&k.length>0?"error":void 0,onSearch:L})]});return(0,a.jsx)(u.Z,{spinning:y,children:(0,a.jsxs)(d.Z,{direction:"vertical",children:[K,O&&(0,a.jsx)(p.Z,{message:"Error",description:O,type:"error",showIcon:!0}),S?U:z,(0,a.jsx)(c.Z,{ghost:!0,children:(0,a.jsx)(C,{header:"Learn more about using the Fediverse to authenticate with chat.",children:(0,a.jsx)("p",{children:"xxxxxx"})},"header")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Note"}),": This is for authentication purposes only, and no personal information will be accessed or stored."]})]})})},j="/_next/static/media/fediverse-black.0b51c805.png",I="/_next/static/media/indieauth.38c52a3d.png",k=n(67211),w=n.n(k),E=n(1899),A=function(){var e=(0,s.sJ)(E.L4),t=(0,s.sJ)(E.FI),n=(0,s.sJ)(E.db);if(!n)return null;var i=n.displayName,o=[{label:(0,a.jsxs)("span",{className:w().tabContent,children:[(0,a.jsx)("img",{className:w().icon,src:I,alt:"IndieAuth"}),"IndieAuth"]}),key:"1",children:(0,a.jsx)(x,{authenticated:e,displayName:i,accessToken:t})},{label:(0,a.jsxs)("span",{className:w().tabContent,children:[(0,a.jsx)("img",{className:w().icon,src:j,alt:"Fediverse auth"}),"FediAuth"]}),key:"2",children:(0,a.jsx)(N,{authenticated:e,displayName:i,accessToken:t})}];return(0,a.jsx)("div",{children:(0,a.jsx)(r.Z,{defaultActiveKey:"1",items:o,type:"card",size:"small",renderTabBar:null})})}},67211:function(e){e.exports={tabContent:"AuthModal_tabContent__KgMU3",icon:"AuthModal_icon__kpEuV"}},55237:function(e){e.exports={codeInputContainer:"FediAuthModal_codeInputContainer__M_dAD",codeInput:"FediAuthModal_codeInput__dIE6u",submitButton:"FediAuthModal_submitButton__iuF9R"}}}]);