{"version":3,"file":"static/chunks/4208.66c9dc4136616d94.js","mappings":"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","sources":["webpack://_N_E/./assets/images/fediverse-black.png","webpack://_N_E/./components/modals/IndieAuthModal/IndieAuthModal.tsx","webpack://_N_E/./components/modals/FediAuthModal/FediAuthModal.tsx","webpack://_N_E/./utils/validators.ts","webpack://_N_E/./assets/images/indieauth.png","webpack://_N_E/./components/modals/AuthModal/AuthModal.tsx","webpack://_N_E/./utils/urls.ts","webpack://_N_E/./components/modals/AuthModal/AuthModal.module.scss","webpack://_N_E/./components/modals/FediAuthModal/FediAuthModal.module.scss"],"sourcesContent":["export default {\"src\":\"/_next/static/media/fediverse-black.0b51c805.png\",\"height\":100,\"width\":100,\"blurDataURL\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEVMaXEbGxsREREQEBAPDw8NDQ0FBQUQEBAQEBAUFBQNDQ0REREVFRUQEBAODg4UFBQUFBQHBwcNDQ1DUQGwAAAAE3RSTlMAC2QvWeDEnZQbSn15tW2ri/pAr8wTOgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAD1JREFUeJwdy0cOgDAMAMGNS2yHFPj/Z0GcRwMwegNaWbgB3WfmZSArZd7eqR0qEYM6GT/pc/bygqal8v0XMgEBhHcrytIAAAAASUVORK5CYII=\",\"blurWidth\":8,\"blurHeight\":8};","import { CheckCircleOutlined } from '@ant-design/icons';\nimport { Alert, Input, Space, Spin, Collapse, Typography, Button } from 'antd';\nimport React, { FC, useState } from 'react';\nimport { isValidUrl } from '../../../utils/urls';\n\nconst { Panel } = Collapse;\nconst { Link } = Typography;\n\nexport type IndieAuthModalProps = {\n  authenticated: boolean;\n  displayName: string;\n  accessToken: string;\n};\n\nexport const IndieAuthModal: FC<IndieAuthModalProps> = ({\n  authenticated,\n  displayName: username,\n  accessToken,\n}) => {\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [valid, setValid] = useState(false);\n  const [host, setHost] = useState('');\n\n  const message = !authenticated ? (\n    <span>\n      Use your own domain to authenticate <span>{username}</span> or login as a previously{' '}\n      authenticated chat user using IndieAuth.\n    </span>\n  ) : (\n    <span>\n      <b>You are already authenticated</b>. However, you can add other domains or log in as a\n      different user.\n    </span>\n  );\n\n  let errorMessageText = errorMessage;\n  if (errorMessageText) {\n    if (errorMessageText.includes('url does not support indieauth')) {\n      errorMessageText = 'The provided URL is either invalid or does not support IndieAuth.';\n    }\n  }\n\n  const validate = (url: string) => {\n    if (!isValidUrl(url)) {\n      setValid(false);\n      return;\n    }\n\n    if (!url.includes('.')) {\n      setValid(false);\n      return;\n    }\n\n    setValid(true);\n  };\n\n  const onInput = (e: React.ChangeEvent<HTMLInputElement>) => {\n    // Don't allow people to type custom ports or protocols.\n    const char = (e.nativeEvent as any).data;\n    if (char === ':') {\n      return;\n    }\n\n    setHost(e.target.value);\n    const h = `https://${e.target.value}`;\n    validate(h);\n  };\n\n  const submitButtonPressed = async () => {\n    if (!valid) {\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const url = `/api/auth/indieauth?accessToken=${accessToken}`;\n      const h = `https://${host}`;\n      const data = { authHost: h };\n      const rawResponse = await fetch(url, {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      });\n\n      const content = await rawResponse.json();\n      if (content.message) {\n        setErrorMessage(content.message);\n        setLoading(false);\n        return;\n      }\n      if (!content.redirect) {\n        setErrorMessage('Auth provider did not return a redirect URL.');\n        setLoading(false);\n        return;\n      }\n\n      if (content.redirect) {\n        const { redirect } = content;\n        window.location = redirect;\n      }\n    } catch (e) {\n      setErrorMessage(e.message);\n    }\n\n    setLoading(false);\n  };\n\n  return (\n    <Spin spinning={loading}>\n      <Space direction=\"vertical\">\n        {message}\n        {errorMessageText && (\n          <Alert message=\"Error\" description={errorMessageText} type=\"error\" showIcon />\n        )}\n        <div>Your domain</div>\n        <Input.Search\n          addonBefore=\"https://\"\n          onInput={onInput}\n          type=\"url\"\n          value={host}\n          placeholder=\"yoursite.com\"\n          status={!valid && host.length > 0 ? 'error' : undefined}\n          onSearch={submitButtonPressed}\n          enterButton={\n            <Button type={valid ? 'primary' : 'default'} disabled={!valid || host.length === 0}>\n              <CheckCircleOutlined />\n            </Button>\n          }\n        />\n\n        <Collapse ghost>\n          <Panel key=\"header\" header=\"Learn more about using IndieAuth to authenticate with chat.\">\n            <p>\n              IndieAuth allows for a completely independent and decentralized way of identifying\n              yourself using your own domain.\n            </p>\n\n            <p>\n              If you run an Owncast instance, you can use that domain here. Otherwise,{' '}\n              <Link href=\"https://indieauth.net/#providers\">\n                learn more about how you can support IndieAuth\n              </Link>\n              .\n            </p>\n          </Panel>\n        </Collapse>\n        <div>\n          <strong>Note</strong>: This is for authentication purposes only, and no personal\n          information will be accessed or stored.\n        </div>\n      </Space>\n    </Spin>\n  );\n};\n","import { Alert, Button, Input, Space, Spin, Collapse } from 'antd';\nimport React, { FC, useState } from 'react';\nimport { CheckCircleOutlined } from '@ant-design/icons';\nimport styles from './FediAuthModal.module.scss';\nimport { validateAccount } from '../../../utils/validators';\n\nconst { Panel } = Collapse;\n\nexport type FediAuthModalProps = {\n  authenticated: boolean;\n  displayName: string;\n  accessToken: string;\n};\n\nexport const FediAuthModal: FC<FediAuthModalProps> = ({\n  authenticated,\n  displayName,\n  accessToken,\n}) => {\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [valid, setValid] = useState(false);\n  const [account, setAccount] = useState('');\n  const [code, setCode] = useState('');\n  const [verifyingCode, setVerifyingCode] = useState(false);\n\n  const message = !authenticated ? (\n    <span>\n      Receive a direct message on the Fediverse to link your account to{' '}\n      <strong>{displayName}</strong>, or login as a previously linked chat user.\n    </span>\n  ) : (\n    <span>\n      <b>You are already authenticated</b>. However, you can add other domains or log in as a\n      different user.\n    </span>\n  );\n\n  let errorMessageText = errorMessage;\n  if (errorMessageText) {\n    if (errorMessageText.includes('url does not support indieauth')) {\n      errorMessageText = 'The provided URL is either invalid or does not support IndieAuth.';\n    }\n  }\n\n  const validate = (acct: string) => {\n    setValid(validateAccount(acct));\n  };\n\n  const onInput = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setAccount(e.target.value);\n    validate(e.target.value);\n  };\n\n  const makeRequest = async (url, data) => {\n    const rawResponse = await fetch(url, {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    const content = await rawResponse.json();\n    if (content.message) {\n      setErrorMessage(content.message);\n      setLoading(false);\n    }\n  };\n\n  const submitCodePressed = async () => {\n    setLoading(true);\n    const url = `/api/auth/fediverse/verify?accessToken=${accessToken}`;\n    const data = { code };\n\n    try {\n      await makeRequest(url, data);\n\n      // Success. Reload the page.\n      window.location.href = '/';\n    } catch (e) {\n      console.error(e);\n      setErrorMessage(e);\n    }\n    setLoading(false);\n  };\n\n  const submitAccountPressed = async () => {\n    if (!valid) {\n      return;\n    }\n\n    setLoading(true);\n    setErrorMessage(null);\n    const url = `/api/auth/fediverse?accessToken=${accessToken}`;\n    const normalizedAccount = account.replace(/^@+/, '');\n    const data = { account: normalizedAccount };\n\n    try {\n      await makeRequest(url, data);\n      setVerifyingCode(true);\n    } catch (e) {\n      console.error(e);\n      setErrorMessage(e);\n    }\n    setLoading(false);\n  };\n\n  const inputCodeStep = (\n    <div>\n      Paste in the code that was sent to your Fediverse account. If you did not receive a code, make\n      sure you can accept direct messages.\n      <div className={styles.codeInputContainer}>\n        <Input\n          value={code}\n          onChange={e => setCode(e.target.value)}\n          className={styles.codeInput}\n          placeholder=\"123456\"\n          maxLength={6}\n        />\n        <Button\n          type=\"primary\"\n          onClick={submitCodePressed}\n          disabled={code.length < 6}\n          className={styles.submitButton}\n        >\n          Verify Code\n        </Button>\n      </div>\n    </div>\n  );\n\n  const inputAccountStep = (\n    <>\n      <div>Your Fediverse Account</div>\n      <Input.Search\n        addonBefore=\"@\"\n        onInput={onInput}\n        value={account}\n        placeholder=\"youraccount@yourserver.com\"\n        status={!valid && account.length > 0 ? 'error' : undefined}\n        onSearch={submitAccountPressed}\n        enterButton={\n          <Button type={valid ? 'primary' : 'default'} disabled={!valid || account.length === 0}>\n            <CheckCircleOutlined />\n          </Button>\n        }\n      />\n    </>\n  );\n\n  return (\n    <Spin spinning={loading}>\n      <Space direction=\"vertical\">\n        {message}\n        {errorMessageText && (\n          <Alert message=\"Error\" description={errorMessageText} type=\"error\" showIcon />\n        )}\n        {verifyingCode ? inputCodeStep : inputAccountStep}\n        <Collapse ghost>\n          <Panel\n            key=\"header\"\n            header=\"Learn more about using the Fediverse to authenticate with chat.\"\n          >\n            <p>\n              You can link your chat identity with your Fediverse identity. Next time you want to\n              use this chat identity you can again go through the Fediverse authentication.\n            </p>\n          </Panel>\n        </Collapse>\n        <div>\n          <strong>Note</strong>: This is for authentication purposes only, and no personal\n          information will be accessed or stored.\n        </div>\n      </Space>\n    </Spin>\n  );\n};\n","// eslint-disable-next-line import/prefer-default-export\nexport function validateAccount(account) {\n  const a = account.replace(/^@+/, '');\n  const regex =\n    /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return regex.test(String(a).toLowerCase());\n}\n","export default {\"src\":\"/_next/static/media/indieauth.38c52a3d.png\",\"height\":512,\"width\":406,\"blurDataURL\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAICAMAAADtGH4KAAAAJFBMVEU4ODg4ODg5OTk5OTk5OTk4ODg5OTk4ODg5OTk5OTk5OTk4ODiRUFfYAAAAC3RSTlMCFOuovTv1zI8wabTrOYwAAAAJcEhZcwAALiMAAC4jAXilP3YAAAAsSURBVHicBcGFAQAwDMCg1Gb5/98BHG1gd2UQGeQwVvl4ujyUEzbbi8nyhn4bVgEfoFU38wAAAABJRU5ErkJggg==\",\"blurWidth\":6,\"blurHeight\":8};","import { Tabs } from 'antd';\nimport { useRecoilValue } from 'recoil';\nimport { FC } from 'react';\nimport { IndieAuthModal } from '../IndieAuthModal/IndieAuthModal';\nimport { FediAuthModal } from '../FediAuthModal/FediAuthModal';\n\nimport FediverseIcon from '../../../assets/images/fediverse-black.png';\nimport IndieAuthIcon from '../../../assets/images/indieauth.png';\n\nimport styles from './AuthModal.module.scss';\nimport {\n  currentUserAtom,\n  chatAuthenticatedAtom,\n  accessTokenAtom,\n  clientConfigStateAtom,\n} from '../../stores/ClientConfigStore';\nimport { ClientConfig } from '../../../interfaces/client-config.model';\n\nexport type AuthModalProps = {\n  forceTabs?: boolean;\n};\n\nexport const AuthModal: FC<AuthModalProps> = ({ forceTabs }) => {\n  const authenticated = useRecoilValue<boolean>(chatAuthenticatedAtom);\n  const accessToken = useRecoilValue<string>(accessTokenAtom);\n  const currentUser = useRecoilValue(currentUserAtom);\n  const clientConfig = useRecoilValue<ClientConfig>(clientConfigStateAtom);\n\n  if (!currentUser) {\n    return null;\n  }\n  const { displayName } = currentUser;\n  const { federation } = clientConfig;\n  const { enabled: fediverseEnabled } = federation;\n\n  const indieAuthTabTitle = (\n    <span className={styles.tabContent}>\n      <img className={styles.icon} src={IndieAuthIcon.src} alt=\"IndieAuth\" />\n      IndieAuth\n    </span>\n  );\n\n  const indieAuthTab = (\n    <IndieAuthModal\n      authenticated={authenticated}\n      displayName={displayName}\n      accessToken={accessToken}\n    />\n  );\n\n  const fediAuthTabTitle = (\n    <span className={styles.tabContent}>\n      <img className={styles.icon} src={FediverseIcon.src} alt=\"Fediverse auth\" />\n      FediAuth\n    </span>\n  );\n\n  const fediAuthTab = (\n    <FediAuthModal\n      authenticated={authenticated}\n      displayName={displayName}\n      accessToken={accessToken}\n    />\n  );\n\n  const items = [\n    { label: indieAuthTabTitle, key: '1', children: indieAuthTab },\n    { label: fediAuthTabTitle, key: '2', children: fediAuthTab },\n  ];\n\n  return (\n    <div>\n      <Tabs\n        defaultActiveKey=\"1\"\n        items={items}\n        type=\"card\"\n        size=\"small\"\n        renderTabBar={fediverseEnabled || forceTabs ? null : () => null}\n      />\n    </div>\n  );\n};\n","// to use with <input type=\"url\"> fields, as the default pattern only checks for `:`,\nexport const DEFAULT_TEXTFIELD_URL_PATTERN = 'https?://.*';\n\n/**\n * Determines if a URL is valid\n * @param {string} url - A URL to validate.\n * @param {string[]} validProtocols - An array of valid protocols. Defaults to web.\n * @returns {boolean} - True if the URI is valid, false otherwise.\n */\nexport function isValidUrl(url: string, validProtocols: string[] = ['http:', 'https:']): boolean {\n  try {\n    const validationObject = new URL(url);\n\n    if (\n      validationObject.protocol === '' ||\n      validationObject.hostname === '' ||\n      !validProtocols.includes(validationObject.protocol)\n    ) {\n      return false;\n    }\n  } catch (e) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Determines if an account is valid by simply checking for a protocol, username\n * and server, delimited by a colon. For example: @username:example.com\n * @param {string} account - An account to validate.\n * @param {string} protocol - The protocol we expect the account to be using.\n * @returns {boolean} - True if the account is valid, false otherwise.\n */\nexport function isValidAccount(account: string, protocol: string): boolean {\n  if (account.startsWith('@')) {\n    // eslint-disable-next-line no-param-reassign\n    account = account.slice(1);\n  }\n\n  const components = account.split(/:|@/);\n  const [service, user, host] = components;\n\n  console.log({ account, protocol, service, user, host });\n  if (service !== protocol) {\n    return false;\n  }\n\n  if (components.length !== 3 || !service || !user || !host) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Determines if an account is valid by simply checking for a protocol, username\n * and server, delimited by a colon. For example: @username:example.com\n * @param {string} account - An account to validate.\n * @returns {boolean} - True if the account is valid, false otherwise.\n */\nexport function isValidMatrixAccount(account: string): boolean {\n  if (account.startsWith('matrix:')) {\n    // eslint-disable-next-line no-param-reassign\n    account = account.slice(7);\n  } else {\n    return false;\n  }\n\n  if (account.startsWith('@')) {\n    // eslint-disable-next-line no-param-reassign\n    account = account.slice(1);\n  }\n\n  const components = account.split(':');\n  const [user, host] = components;\n\n  if (components.length !== 2 || !user || !host) {\n    return false;\n  }\n\n  return true;\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tabContent\":\"AuthModal_tabContent__KgMU3\",\"icon\":\"AuthModal_icon__kpEuV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"codeInputContainer\":\"FediAuthModal_codeInputContainer__M_dAD\",\"codeInput\":\"FediAuthModal_codeInput__dIE6u\",\"submitButton\":\"FediAuthModal_submitButton__iuF9R\"};"],"names":["Panel","Collapse","Link","Typography","IndieAuthModal","authenticated","displayName","username","accessToken","errorMessage","setErrorMessage","useState","loading","setLoading","valid","setValid","host","setHost","message","span","b","errorMessageText","includes","Spin","spinning","Space","direction","Alert","description","type","showIcon","div","Input","addonBefore","onInput","e","nativeEvent","data","target","value","h","url","isValidUrl","placeholder","status","length","undefined","onSearch","async","authHost","rawResponse","fetch","method","headers","Accept","body","JSON","stringify","content","json","redirect","window","location","enterButton","Button","disabled","CheckCircleOutlined","ghost","header","p","href","strong","FediAuthModal","account","setAccount","code","setCode","verifyingCode","setVerifyingCode","validate","acct","a","replace","test","String","toLowerCase","validateAccount","makeRequest","inputCodeStep","className","styles","onChange","maxLength","onClick","console","error","inputAccountStep","AuthModal","forceTabs","useRecoilValue","chatAuthenticatedAtom","accessTokenAtom","currentUser","currentUserAtom","clientConfig","clientConfigStateAtom","federation","enabled","fediverseEnabled","items","label","img","src","IndieAuthIcon","alt","key","children","FediverseIcon","Tabs","defaultActiveKey","size","renderTabBar","DEFAULT_TEXTFIELD_URL_PATTERN","validProtocols","validationObject","URL","protocol","hostname","isValidAccount","startsWith","slice","components","split","service","user","log","isValidMatrixAccount","module","exports"],"sourceRoot":""}