(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3052],{33052:function(e,n,t){"use strict";t.d(n,{h:function(){return re},Z:function(){return ae}});var r=t(85893),a=t(97183),s=t(94199),i=t(20550),o=t(828),c=t(66516),u=t(38504),d=t(71577),l=t(26713),h=t(86548),p=t(94149),x=t(38545),v=t(87547),f=t(39398),j=t(4480),m=t(67294),g=t(49218),y=t(32365),Z=t(1899),_=t(47093),b=t.n(_),C=t(29815),w=t(38939),A=t(69677),k=t(11622),I=w.Z.Option,N=function(e){var n=e.color,t={textAlign:"center",backgroundColor:"var(--theme-color-users-".concat(n,")"),width:"100%",height:"100%"};return(0,r.jsx)("div",{style:t})},S=function(){var e=(0,j.sJ)(Z.Gt),n=(0,j.sJ)(Z.w4),t=(0,j.sJ)(Z.nk)||0,a=(0,m.useState)(n),s=a[0],i=a[1],o=s!==n&&""!==s&&(null===e||void 0===e?void 0:e.isConnected()),c=(0,C.Z)(Array(8)).map((function(e,n){return n}));return(0,r.jsxs)("div",{children:["Your chat display name is what people see when you send chat messages. Other information can go here to mention auth, and stuff.",(0,r.jsx)(A.Z,{value:s,onChange:function(e){return i(e.target.value)},placeholder:"Your chat display name",maxLength:30,showCount:!0,defaultValue:n}),(0,r.jsx)(d.Z,{disabled:!o,onClick:function(){var n={type:k.C.NAME_CHANGE,newName:s};e.send(n)},children:"Change name"}),(0,r.jsxs)("div",{children:["Your Color",(0,r.jsx)(w.Z,{style:{width:120},onChange:function(n){var t={type:k.C.COLOR_CHANGE,newColor:Number(n)};e.send(t)},defaultValue:t.toString(),getPopupContainer:function(e){return e.parentElement},children:c.map((function(e){return(0,r.jsx)(I,{title:e,children:(0,r.jsx)(N,{color:e})},e.toString())}))})]})]})},T=t(2944),E=t(47568),F=t(70655),L=t(54907),J=t(84485),O=t(11382),H=t(14670),P=t(19411),U=L.Z.Panel,B=J.Z.Link,M=function(e){var n=e.authenticated,t=e.displayName,a=e.accessToken,s=(0,m.useState)(null),i=s[0],o=s[1],c=(0,m.useState)(!1),u=c[0],h=c[1],p=(0,m.useState)(!1),x=p[0],v=p[1],f=(0,m.useState)(""),j=f[0],g=f[1],y=n?(0,r.jsxs)("span",{children:[(0,r.jsx)("b",{children:"You are already authenticated"}),". However, you can add other domains or log in as a different user."]}):(0,r.jsxs)("span",{children:["Use your own domain to authenticate ",(0,r.jsx)("span",{children:t})," or login as a previously"," ","authenticated chat user using IndieAuth."]}),Z=i;Z&&Z.includes("url does not support indieauth")&&(Z="The provided URL is either invalid or does not support IndieAuth.");var _=function(){var e=(0,E.Z)((function(){var e,n,t,r,s,i;return(0,F.__generator)(this,(function(c){switch(c.label){case 0:if(!x)return[2];h(!0),c.label=1;case 1:return c.trys.push([1,4,,5]),e="/api/auth/indieauth?accessToken=".concat(a),n="https://".concat(j),t={authHost:n},[4,fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})];case 2:return[4,c.sent().json()];case 3:return(r=c.sent()).message?(o(r.message),h(!1),[2]):r.redirect?(r.redirect&&(s=r.redirect,window.location=s),[3,5]):(o("Auth provider did not return a redirect URL."),h(!1),[2]);case 4:return i=c.sent(),o(i.message),[3,5];case 5:return h(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,r.jsx)(O.Z,{spinning:u,children:(0,r.jsxs)(l.Z,{direction:"vertical",children:[y,Z&&(0,r.jsx)(H.Z,{message:"Error",description:Z,type:"error",showIcon:!0}),(0,r.jsx)("div",{children:"Your domain"}),(0,r.jsx)(A.Z.Search,{addonBefore:"https://",onInput:function(e){if(":"!==e.nativeEvent.data){g(e.target.value);var n,t="https://".concat(e.target.value);n=t,(0,P.Z)(n)&&n.includes(".")?v(!0):v(!1)}},type:"url",value:j,placeholder:"yoursite.com",status:!x&&j.length>0?"error":void 0,onPressEnter:_,enterButton:(0,r.jsx)(d.Z,{onClick:_,disabled:!x,children:"Authenticate with your domain"})}),(0,r.jsx)(L.Z,{ghost:!0,children:(0,r.jsxs)(U,{header:"Learn more about using IndieAuth to authenticate with chat.",children:[(0,r.jsx)("p",{children:"IndieAuth allows for a completely independent and decentralized way of identifying yourself using your own domain."}),(0,r.jsxs)("p",{children:["If you run an Owncast instance, you can use that domain here. Otherwise,"," ",(0,r.jsx)(B,{href:"https://indieauth.net/#providers",children:"learn more about how you can support IndieAuth"}),"."]})]},"header")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Note"}),": This is for authentication purposes only, and no personal information will be accessed or stored."]})]})})},R=t(55237),Y=t.n(R);var D=L.Z.Panel,V=function(e){var n=e.authenticated,t=e.displayName,a=e.accessToken,s=(0,m.useState)(null),i=s[0],o=s[1],c=(0,m.useState)(!1),u=c[0],h=c[1],p=(0,m.useState)(!1),x=p[0],v=p[1],f=(0,m.useState)(""),j=f[0],g=f[1],y=(0,m.useState)(""),Z=y[0],_=y[1],b=(0,m.useState)(!1),C=b[0],w=b[1],k=n?(0,r.jsxs)("span",{children:[(0,r.jsx)("b",{children:"You are already authenticated"}),". However, you can add other domains or log in as a different user."]}):(0,r.jsxs)("span",{children:["Receive a direct message on the Fediverse to link your account to"," ",(0,r.jsx)("strong",{children:t}),", or login as a previously linked chat user."]}),I=i;I&&I.includes("url does not support indieauth")&&(I="The provided URL is either invalid or does not support IndieAuth.");var N=function(e){v(function(e){var n=e.replace(/^@+/,"");return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase())}(e))},S=function(){var e=(0,E.Z)((function(e,n){var t;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})];case 1:return[4,r.sent().json()];case 2:return(t=r.sent()).message&&(o(t.message),h(!1)),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),T=function(){var e=(0,E.Z)((function(){var e,n,t;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:h(!0),e="/api/auth/fediverse/verify?accessToken=".concat(a),n={code:Z},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,S(e,n)];case 2:return r.sent(),window.location.href="/",[3,4];case 3:return t=r.sent(),console.error(t),o(t),[3,4];case 4:return h(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),J=function(){var e=(0,E.Z)((function(){var e,n,t,r;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:if(!x)return[2];h(!0),o(null),e="/api/auth/fediverse?accessToken=".concat(a),n=j.replace(/^@+/,""),t={account:n},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,S(e,t)];case 2:return s.sent(),w(!0),[3,4];case 3:return r=s.sent(),console.error(r),o(r),[3,4];case 4:return h(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),P=(0,r.jsxs)("div",{children:["Paste in the code that was sent to your Fediverse account. If you did not receive a code, make sure you can accept direct messages.",(0,r.jsxs)("div",{className:Y().codeInputContainer,children:[(0,r.jsx)(A.Z,{value:Z,onChange:function(e){return _(e.target.value)},className:Y().codeInput,placeholder:"123456",maxLength:6}),(0,r.jsx)(d.Z,{type:"primary",onClick:T,disabled:Z.length<6,className:Y().submitButton,children:"Verify Code"})]})]}),U=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:"Your Fediverse Account"}),(0,r.jsx)(A.Z.Search,{addonBefore:"@",onInput:function(e){g(e.target.value),N(e.target.value)},value:j,placeholder:"youraccount@yourserver.com",status:!x&&j.length>0?"error":void 0,onPressEnter:J,enterButton:(0,r.jsx)(d.Z,{onClick:J,disabled:!x,children:"Authenticate with Fediverse"})})]});return(0,r.jsx)(O.Z,{spinning:u,children:(0,r.jsxs)(l.Z,{direction:"vertical",children:[k,I&&(0,r.jsx)(H.Z,{message:"Error",description:I,type:"error",showIcon:!0}),C?P:U,(0,r.jsx)(L.Z,{ghost:!0,children:(0,r.jsx)(D,{header:"Learn more about using the Fediverse to authenticate with chat.",children:(0,r.jsx)("p",{children:"xxxxxx"})},"header")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Note"}),": This is for authentication purposes only, and no personal information will be accessed or stored."]})]})})},z="/_next/static/media/fediverse-black.0b51c805.png",G="/_next/static/media/indieauth.38c52a3d.png",K=t(67211),Q=t.n(K),X=T.Z.TabPane,$=function(){var e=(0,j.sJ)(Z.w4),n=(0,j.sJ)(Z.L4),t=(0,j.sJ)(Z.FI);return(0,r.jsx)("div",{children:(0,r.jsxs)(T.Z,{defaultActiveKey:"1",type:"card",size:"small",renderTabBar:null,children:[(0,r.jsx)(X,{tab:(0,r.jsxs)("span",{className:Q().tabContent,children:[(0,r.jsx)("img",{className:Q().icon,src:G,alt:"IndieAuth"}),"IndieAuth"]}),children:(0,r.jsx)(M,{authenticated:n,displayName:e,accessToken:t})},"1"),(0,r.jsx)(X,{tab:(0,r.jsxs)("span",{className:Q().tabContent,children:[(0,r.jsx)("img",{className:Q().icon,src:z,alt:"Fediverse auth"}),"FediAuth"]}),children:(0,r.jsx)(V,{authenticated:n,displayName:e,accessToken:t})},"2")]})})},q=function(e){var n=e.username,t=(void 0===n?void 0:n)||(0,j.sJ)(Z.w4),a=(0,m.useState)(!1),s=a[0],i=a[1],_=(0,m.useState)(!1),C=_[0],w=_[1],A=(0,o.Z)((0,j.FV)(Z.ZA),2),k=A[0],I=A[1],N=(0,j.sJ)(Z.Q),T=function(){I(!k)};(0,g.y1)("c",T,{enableOnContentEditable:!1},[k]);var E=(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(c.Z.Item,{icon:(0,r.jsx)(h.Z,{}),onClick:function(){i(!0)},children:"Change name"},"0"),(0,r.jsx)(c.Z.Item,{icon:(0,r.jsx)(p.Z,{}),onClick:function(){return w(!0)},children:"Authenticate"},"1"),N.chatAvailable&&(0,r.jsx)(c.Z.Item,{icon:(0,r.jsx)(x.Z,{}),onClick:function(){return T()},children:"Toggle chat"},"3")]});return(0,r.jsxs)("div",{className:"".concat(b().root),children:[(0,r.jsx)(u.Z,{overlay:E,trigger:["click"],children:(0,r.jsx)(d.Z,{type:"primary",icon:(0,r.jsx)(v.Z,{style:{marginRight:".5rem"}}),children:(0,r.jsxs)(l.Z,{children:[t,(0,r.jsx)(f.Z,{})]})})}),(0,r.jsx)(y.u,{title:"Change Chat Display Name",visible:s,handleCancel:function(){return i(!1)},children:(0,r.jsx)(S,{})}),(0,r.jsx)(y.u,{title:"Authenticate",visible:C,handleCancel:function(){return w(!1)},children:(0,r.jsx)($,{})})]})},W=t(60113),ee=t(92910),ne=t.n(ee),te=a.Z.Header,re=function(e){var n=e.name,t=void 0===n?"Your stream title":n,a=e.chatAvailable,o=e.chatDisabled;return(0,r.jsxs)(te,{className:"".concat(ne().header),children:[(0,r.jsxs)("div",{className:"".concat(ne().logo),children:[(0,r.jsx)(W.C,{variant:"contrast"}),(0,r.jsx)("span",{children:t})]}),a&&!o&&(0,r.jsx)(q,{}),!a&&!o&&(0,r.jsx)(s.Z,{title:"Chat is available when the stream is live.",placement:"left",children:(0,r.jsx)(i.Z,{style:{cursor:"pointer"},children:"Chat offline"})})]})},ae=re},47093:function(e){e.exports={root:"UserDropdown_root__IdxfQ","ant-space":"UserDropdown_ant-space__XJTZ3","ant-space-item":"UserDropdown_ant-space-item__w4nC2"}},67211:function(e){e.exports={tabContent:"AuthModal_tabContent__KgMU3",icon:"AuthModal_icon__kpEuV"}},55237:function(e){e.exports={codeInputContainer:"FediAuthModal_codeInputContainer__M_dAD",codeInput:"FediAuthModal_codeInput__dIE6u",submitButton:"FediAuthModal_submitButton__iuF9R"}},92910:function(e){e.exports={header:"Header_header__U4Ro1",logo:"Header_logo__HLZ6Z"}}}]);