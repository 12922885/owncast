(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7757],{94594:function(e,n,a){"use strict";a.d(n,{Z:function(){return C}});var t=a(87462),i=a(4942),r=a(50888),c=a(94184),s=a.n(c),l=a(97685),o=a(91),d=a(67294),u=a(21770),f=a(15105),h=d.forwardRef((function(e,n){var a,t=e.prefixCls,r=void 0===t?"rc-switch":t,c=e.className,h=e.checked,v=e.defaultChecked,m=e.disabled,p=e.loadingIcon,g=e.checkedChildren,x=e.unCheckedChildren,b=e.onClick,Z=e.onChange,C=e.onKeyDown,k=(0,o.Z)(e,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),N=(0,u.Z)(!1,{value:h,defaultValue:v}),j=(0,l.Z)(N,2),y=j[0],w=j[1];function P(e,n){var a=y;return m||(w(a=e),null===Z||void 0===Z||Z(a,n)),a}var S=s()(r,c,(a={},(0,i.Z)(a,"".concat(r,"-checked"),y),(0,i.Z)(a,"".concat(r,"-disabled"),m),a));return d.createElement("button",Object.assign({},k,{type:"button",role:"switch","aria-checked":y,disabled:m,className:S,ref:n,onKeyDown:function(e){e.which===f.Z.LEFT?P(!1,e):e.which===f.Z.RIGHT&&P(!0,e),null===C||void 0===C||C(e)},onClick:function(e){var n=P(!y,e);null===b||void 0===b||b(n,e)}}),p,d.createElement("span",{className:"".concat(r,"-inner")},y?g:x))}));h.displayName="Switch";var v=h,m=a(53124),p=a(98866),g=a(97647),x=a(68349),b=function(e,n){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(a[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(e);i<t.length;i++)n.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(a[t[i]]=e[t[i]])}return a},Z=d.forwardRef((function(e,n){var a,c=e.prefixCls,l=e.size,o=e.disabled,u=e.loading,f=e.className,h=void 0===f?"":f,Z=b(e,["prefixCls","size","disabled","loading","className"]),C=d.useContext(m.E_),k=C.getPrefixCls,N=C.direction,j=d.useContext(g.Z),y=d.useContext(p.Z),w=o||y||u,P=k("switch",c),S=d.createElement("div",{className:"".concat(P,"-handle")},u&&d.createElement(r.Z,{className:"".concat(P,"-loading-icon")})),E=s()((a={},(0,i.Z)(a,"".concat(P,"-small"),"small"===(l||j)),(0,i.Z)(a,"".concat(P,"-loading"),u),(0,i.Z)(a,"".concat(P,"-rtl"),"rtl"===N),a),h);return d.createElement(x.Z,{insertExtraNode:!0},d.createElement(v,(0,t.Z)({},Z,{prefixCls:P,className:E,disabled:w,ref:n,loadingIcon:S})))}));Z.__ANT_SWITCH=!0;var C=Z},79128:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/config-storage",function(){return a(64417)}])},15976:function(e,n,a){"use strict";a.d(n,{Z:function(){return h}});var t=a(47568),i=a(34051),r=a.n(i),c=a(85893),s=a(67294),l=a(94594),o=a(83192),d=a(78464),u=a(25964),f=a(35159);function h(e){var n=(0,s.useState)(null),a=n[0],i=n[1],h=null,v=((0,s.useContext)(f.aC)||{}).setFieldInConfigState,m=e.apiPath,p=e.checked,g=e.reversed,x=void 0!==g&&g,b=e.configPath,Z=void 0===b?"":b,C=e.disabled,k=void 0!==C&&C,N=e.fieldName,j=e.label,y=e.tip,w=e.useSubmit,P=e.onChange,S=function(){i(null),clearTimeout(h),h=null},E=function(){var e=(0,t.Z)(r().mark((function e(n){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=6;break}return i((0,o.kg)(o.Jk)),a=x?!n:n,e.next=5,(0,u.Si)({apiPath:m,data:{value:a},onSuccess:function(){v({fieldName:N,value:a,path:Z}),i((0,o.kg)(o.zv))},onError:function(e){i((0,o.kg)(o.Un,"There was an error: ".concat(e)))}});case 5:h=setTimeout(S,u.sI);case 6:P&&P(n);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=null!==a&&a.type===o.Jk;return(0,c.jsxs)("div",{className:"formfield-container toggleswitch-container",children:[j&&(0,c.jsx)("div",{className:"label-side",children:(0,c.jsx)("span",{className:"formfield-label",children:j})}),(0,c.jsxs)("div",{className:"input-side",children:[(0,c.jsxs)("div",{className:"input-group",children:[(0,c.jsx)(l.Z,{className:"switch field-".concat(N),loading:O,onChange:E,defaultChecked:p,checked:p,checkedChildren:"ON",unCheckedChildren:"OFF",disabled:k}),(0,c.jsx)(d.Z,{status:a})]}),(0,c.jsx)("p",{className:"field-tip",children:y})]})]})}h.defaultProps={apiPath:"",checked:!1,reversed:!1,configPath:"",disabled:!1,label:"",tip:"",useSubmit:!1,onChange:null}},64417:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return P}});var t=a(85893),i=a(84485),r=a(67294),c=a(47568),s=a(14924),l=a(26042),o=a(69396),d=a(34051),u=a.n(d),f=a(54907),h=a(71577),v=a(94184),m=a.n(v),p=a(35159),g=a(57553),x=a(25964),b=a(83192),Z=a(13468),C=a(78464),k=a(19411),N=a(15976),j=f.Z.Panel;function y(){var e=(0,r.useState)(null),n=e[0],a=e[1],i=(0,r.useState)(null),d=i[0],v=i[1],y=(0,r.useState)(!1),w=y[0],P=y[1],S=(0,r.useContext)(p.aC)||{},E=S.serverConfig,O=S.setFieldInConfigState,_=(0,r.useContext)(g.k).setMessage,T=E.s3,z=T.accessKey,I=void 0===z?"":z,K=T.acl,D=void 0===K?"":K,F=T.bucket,U=void 0===F?"":F,J=T.enabled,R=void 0!==J&&J,H=T.endpoint,L=void 0===H?"":H,V=T.region,X=void 0===V?"":V,A=T.secret,G=void 0===A?"":A,M=T.servingEndpoint,W=void 0===M?"":M,$=T.forcePathStyle,q=void 0!==$&&$;if((0,r.useEffect)((function(){a({accessKey:I,acl:D,bucket:U,enabled:R,endpoint:L,region:X,secret:G,servingEndpoint:W,forcePathStyle:q}),P(R)}),[T]),!n)return null;var B=null,Q=function(){v(null),B=null,clearTimeout(B)},Y=function(e){var t=e.fieldName,i=e.value;a((0,o.Z)((0,l.Z)({},n),(0,s.Z)({},t,i)))},ee=function(){var e=(0,c.Z)(u().mark((function e(){var a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v((0,b.kg)(b.Jk)),a=n,e.next=4,(0,x.Si)({apiPath:x.$w,data:{value:a},onSuccess:function(){O({fieldName:"s3",value:a,path:""}),v((0,b.kg)(b.zv,"Updated.")),B=setTimeout(Q,x.sI),_("Changing your storage configuration will take place the next time you start a new stream.")},onError:function(e){v((0,b.kg)(b.Un,e)),B=setTimeout(Q,x.sI)}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=m()({"edit-storage-container":!0,"form-module":!0,enabled:w}),ae=function(e,n){var a=e.endpoint,t=e.accessKey,i=e.secret,r=e.bucket,c=e.region,s=e.enabled,l=e.servingEndpoint,o=e.acl,d=e.forcePathStyle;if(s){if(a&&(0,k.Z)(a)&&t&&i&&r&&c&&(s!==n.enabled||a!==n.endpoint||t!==n.accessKey||i!==n.secret||c!==n.region||!n.servingEndpoint&&""!==l||n.servingEndpoint&&l!==n.servingEndpoint||!n.acl&&""!==o||n.acl&&o!==n.acl||d!==n.forcePathStyle))return!0}else if(s!==n.enabled)return!0;return!1}(n,T);return(0,t.jsxs)("div",{className:ne,children:[(0,t.jsx)("div",{className:"enable-switch",children:(0,t.jsx)(N.Z,{apiPath:"",fieldName:"enabled",label:"Use S3 Storage Provider",checked:n.enabled,onChange:function(e){P(e),Y({fieldName:"enabled",value:e})}})}),(0,t.jsxs)("div",{className:"form-fields",children:[(0,t.jsx)("div",{className:"field-container",children:(0,t.jsx)(Z.ZP,(0,o.Z)((0,l.Z)({},x.zm.endpoint),{value:n.endpoint,onChange:Y}))}),(0,t.jsx)("div",{className:"field-container",children:(0,t.jsx)(Z.ZP,(0,o.Z)((0,l.Z)({},x.zm.accessKey),{value:n.accessKey,onChange:Y}))}),(0,t.jsx)("div",{className:"field-container",children:(0,t.jsx)(Z.ZP,(0,o.Z)((0,l.Z)({},x.zm.secret),{value:n.secret,onChange:Y}))}),(0,t.jsx)("div",{className:"field-container",children:(0,t.jsx)(Z.ZP,(0,o.Z)((0,l.Z)({},x.zm.bucket),{value:n.bucket,onChange:Y}))}),(0,t.jsx)("div",{className:"field-container",children:(0,t.jsx)(Z.ZP,(0,o.Z)((0,l.Z)({},x.zm.region),{value:n.region,onChange:Y}))}),(0,t.jsx)(f.Z,{className:"advanced-section",children:(0,t.jsxs)(j,{header:"Optional Settings",children:[(0,t.jsx)("div",{className:"field-container",children:(0,t.jsx)(Z.ZP,(0,o.Z)((0,l.Z)({},x.zm.acl),{value:n.acl,onChange:Y}))}),(0,t.jsx)("div",{className:"field-container",children:(0,t.jsx)(Z.ZP,(0,o.Z)((0,l.Z)({},x.zm.servingEndpoint),{value:n.servingEndpoint,onChange:Y}))}),(0,t.jsx)("div",{className:"enable-switch",children:(0,t.jsx)(N.Z,(0,o.Z)((0,l.Z)({},x.zm.forcePathStyle),{fieldName:"forcePathStyle",checked:n.forcePathStyle,onChange:function(e){Y({fieldName:"forcePathStyle",value:e})}}))})]},"1")})]}),(0,t.jsxs)("div",{className:"button-container",children:[(0,t.jsx)(h.Z,{type:"primary",onClick:ee,disabled:!ae,children:"Save"}),(0,t.jsx)(C.Z,{status:d})]})]})}var w=i.Z.Title;function P(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w,{children:"Storage"}),(0,t.jsxs)("p",{className:"description",children:["Owncast supports optionally using external storage providers to stream your video. Learn more about this by visiting our"," ",(0,t.jsx)("a",{href:"https://owncast.online/docs/storage/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"Storage Documentation"}),"."]}),(0,t.jsx)("p",{className:"description",children:"Configuring this incorrectly will likely cause your video to be unplayable. Double check the documentation for your storage provider on how to configure the bucket you created for Owncast."}),(0,t.jsx)("p",{className:"description",children:"Keep in mind this is for live streaming, not for archival, recording or VOD purposes."}),(0,t.jsx)(y,{})]})}}},function(e){e.O(0,[9774,2888,179],(function(){return n=79128,e(e.s=n);var n}));var n=e.O();_N_E=n}]);