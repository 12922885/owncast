(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6109],{77349:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(83946),a=r(19013),i=r(13882);function s(e,t){(0,i.Z)(2,arguments);var r=(0,a.Z)(e),s=(0,n.Z)(t);return isNaN(s)?new Date(NaN):s?(r.setDate(r.getDate()+s),r):r}},11640:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(83946),a=r(19013),i=r(13882);function s(e,t){(0,i.Z)(2,arguments);var r=(0,a.Z)(e),s=(0,n.Z)(t);if(isNaN(s))return new Date(NaN);if(!s)return r;var o=r.getDate(),u=new Date(r.getTime());u.setMonth(r.getMonth()+s+1,0);var c=u.getDate();return o>=c?u:(r.setFullYear(u.getFullYear(),u.getMonth(),o),r)}},92794:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/viewer-info",function(){return r(45578)}])},89270:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(85893),a=r(29217),i=r(92616),s=r.n(i),o=r(58091),u=r(60727);function c(e){var t={};return e.forEach((function(e){var r=new Date(e.time),n=(0,o.Z)(r,"H:mma");t[n]=e.value})),t}function l(e){var t=e.data,r=e.title,a=e.color,i=e.unit,s=e.dataCollections,o=e.yFlipped,l=e.yLogarithmic,d=[];t&&t.length>0&&d.push({name:r,color:a,data:c(t)}),s.forEach((function(e){d.push({name:e.name,data:c(e.data),color:e.color,dataset:e.options})}));var f={scales:{y:{reverse:!1,type:"linear"},x:{type:"time"}}};return f.scales.y.reverse=o,f.scales.y.type=l?"logarithmic":"linear",(0,n.jsx)("div",{className:"line-chart-container",children:(0,n.jsx)(u.wW,{xtitle:"Time",ytitle:r,suffix:i,legend:"bottom",color:a,data:d,download:r,library:f})})}s().use(a.Z),l.defaultProps={dataCollections:[],data:[],title:"",yFlipped:!1,yLogarithmic:!1}},34440:function(e,t,r){"use strict";r.d(t,{Z:function(){return x}});var n=r(26042),a=r(85893),i=r(84485),s=r(97910),o=r(74763),u=r(59652),c=i.Z.Text,l={title:"",value:0,prefix:null,suffix:null,color:"",progress:!1,centered:!1,formatter:null};function d(e){var t=e.prefix,r=e.value,n=e.suffix,i=e.title;return(0,a.jsxs)("div",{children:[t,(0,a.jsx)("div",{children:(0,a.jsx)(c,{type:"secondary",children:i})}),(0,a.jsx)("div",{children:(0,a.jsxs)(c,{type:"secondary",children:[r,n||"%"]})})]})}function f(e){var t=e.title,r=e.value,n=e.prefix,i=e.suffix,o=e.color,u=r>90?"red":o,c=(0,a.jsx)(d,{prefix:n,value:r,suffix:i,title:t});return(0,a.jsx)(s.Z,{type:"dashboard",percent:r,width:120,strokeColor:{"0%":o,"90%":u},format:function(){return c}})}function v(e){var t=e.title,r=e.value,n=e.prefix,i=e.formatter;return(0,a.jsx)(o.Z,{title:t,value:r,prefix:n,formatter:i})}function x(e){var t=e.progress?f:v,r=e.centered?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return(0,a.jsx)(u.Z,{type:"inner",children:(0,a.jsx)("div",{style:r,children:(0,a.jsx)(t,(0,n.Z)({},e))})})}f.defaultProps=l,v.defaultProps=l,x.defaultProps=l},45578:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return M}});var n=r(47568),a=r(34051),i=r.n(a),s=r(85893),o=r(67294),u=r(66516),c=r(84485),l=r(25968),d=r(6226),f=r(14670),v=r(11382),x=r(38504),h=r(87547),p=r(80882),Z=r(77349),m=r(13882),g=r(83946);function w(e,t){(0,m.Z)(2,arguments);var r=(0,g.Z)(t);return(0,Z.Z)(e,-r)}var y=r(11640);function j(e,t){(0,m.Z)(2,arguments);var r=(0,g.Z)(t);return(0,y.Z)(e,-r)}function D(e,t){if((0,m.Z)(2,arguments),!t||"object"!==typeof t)return new Date(NaN);var r=t.years?(0,g.Z)(t.years):0,n=t.months?(0,g.Z)(t.months):0,a=t.weeks?(0,g.Z)(t.weeks):0,i=t.days?(0,g.Z)(t.days):0,s=t.hours?(0,g.Z)(t.hours):0,o=t.minutes?(0,g.Z)(t.minutes):0,u=t.seconds?(0,g.Z)(t.seconds):0,c=j(e,n+12*r),l=w(c,i+7*a),d=o+60*s,f=u+60*d,v=1e3*f,x=new Date(l.getTime()-v);return x}var k=r(19013);function N(e){(0,m.Z)(1,arguments);var t=(0,k.Z)(e),r=t.getTime();return r}function b(e){return(0,m.Z)(1,arguments),Math.floor(N(e)/1e3)}var C=r(89270),S=r(34440),_=r(10355),T=r(45938),P=r(2766);function E(e){var t=e.data,r=[{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:function(e){return(0,P.AB)(e)}},{title:"Location",dataIndex:"geo",key:"geo",render:function(e){return e?"".concat(e.regionName,", ").concat(e.countryCode):"-"}},{title:"Watch Time",dataIndex:"firstSeen",key:"firstSeen",defaultSortOrder:"ascend",render:function(e){return(0,T.Z)(new Date(e))},sorter:function(e,t){return new Date(e.firstSeen).getTime()-new Date(t.firstSeen).getTime()},sortDirections:["descend","ascend"]}];return(0,s.jsx)(_.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:r,dataSource:t,size:"small",rowKey:"id"})}var I=r(35159),L=r(58827);function M(){var e,t=(0,o.useContext)(I.aC)||{},r=t.online,a=t.broadcaster,Z=t.viewerCount,m=t.overallPeakViewerCount,g=t.sessionPeakViewerCount;a&&a.time&&(e=new Date(a.time));var w=[{title:"Current stream",start:e},{title:"Last 12 hours",start:D(new Date,{hours:12})},{title:"Last 24 hours",start:D(new Date,{hours:24})},{title:"Last 7 days",start:D(new Date,{days:7})},{title:"Last 30 days",start:D(new Date,{days:30})},{title:"Last 3 months",start:D(new Date,{months:3})},{title:"Last 6 months",start:D(new Date,{months:6})}],y=(0,o.useState)(!0),j=y[0],k=y[1],N=(0,o.useState)([]),_=N[0],T=N[1],P=(0,o.useState)([]),M=P[0],A=P[1],F=(0,o.useState)(w[1]),V=F[0],O=F[1],Q=function(){var e=(0,n.Z)(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="".concat(L.iV,"?windowStart=").concat(b(V.start)),e.next=4,(0,L.rQ)(t);case 4:r=e.sent,T(r),k(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("==== error",e.t0);case 12:return e.prev=12,e.next=15,(0,L.rQ)(L.a_);case 15:n=e.sent,A(n),e.next=22;break;case 19:e.prev=19,e.t1=e.catch(12),console.log("==== error",e.t1);case 22:case"end":return e.stop()}}),e,null,[[0,9],[12,19]])})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){var e=null;return Q(),r?(e=setInterval(Q,6e4),function(){clearInterval(e)}):function(){return[]}}),[r,V]);var W=function(e){var t=e.key;O(w[t])},X=(0,s.jsxs)(u.Z,{children:[r&&e&&(0,s.jsx)(u.Z.Item,{onClick:W,children:w[0].title},"0"),w.slice(1).map((function(e,t){return(0,s.jsx)(u.Z.Item,{onClick:W,children:e.title},t+1)}))]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z.Title,{children:"Viewer Info"}),(0,s.jsx)("br",{}),(0,s.jsxs)(l.Z,{gutter:[16,16],justify:"space-around",children:[r&&(0,s.jsx)(d.Z,{span:8,md:8,children:(0,s.jsx)(S.Z,{title:"Current viewers",value:Z.toString(),prefix:(0,s.jsx)(h.Z,{})})}),(0,s.jsx)(d.Z,{md:r?8:12,children:(0,s.jsx)(S.Z,{title:r?"Max viewers this stream":"Max viewers last stream",value:g.toString(),prefix:(0,s.jsx)(h.Z,{})})}),(0,s.jsx)(d.Z,{md:r?8:12,children:(0,s.jsx)(S.Z,{title:"All-time max viewers",value:m.toString(),prefix:(0,s.jsx)(h.Z,{})})})]}),!_.length&&(0,s.jsx)(f.Z,{style:{marginTop:"10px"},banner:!0,message:"Please wait",description:"No viewer data has been collected yet.",type:"info"}),(0,s.jsxs)(v.Z,{spinning:!_.length||j,children:[(0,s.jsx)(x.Z,{overlay:X,trigger:["click"],children:(0,s.jsxs)("button",{type:"button",style:{float:"right",background:"transparent",border:"unset"},children:[V.title," ",(0,s.jsx)(p.Z,{})]})}),_.length>0&&(0,s.jsx)(C.Z,{title:"Viewers",data:_,color:"#2087E2",unit:""}),(0,s.jsx)(E,{data:M})]})]})}}},function(e){e.O(0,[2757,384,355,8091,7961,5938,5315,4763,2139,7910,9774,2888,179],(function(){return t=92794,e(e.s=t);var t}));var t=e.O();_N_E=t}]);