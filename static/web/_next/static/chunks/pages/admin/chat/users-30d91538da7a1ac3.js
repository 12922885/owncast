(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9522],{55583:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/chat/users",function(){return t(66540)}])},66540:function(e,n,t){"use strict";t.r(n),t.d(n,{FETCH_INTERVAL:function(){return k},default:function(){return C}});var r=t(47568),s=t(70655),a=t(85893),c=t(67294),o=t(2944),i=t(35159),u=t(58827),d=t(41542),l=t(69677),f=t(10355),h=t(68795),p=t(45938),m=t(11085),g=t(77891),x=t(2766),y=function(e){var n=e.data,t=[{title:"Display Name",key:"username",render:function(e){var n=e.user,t={connectedAt:e.connectedAt,messageCount:e.messageCount,userAgent:e.userAgent};return(0,a.jsx)(m.Z,{user:n,connectionInfo:t,children:(0,a.jsx)("span",{className:"display-name",children:n.displayName})})},sorter:function(e,n){return n.user.displayName.localeCompare(e.user.displayName)},filterIcon:(0,a.jsx)(h.Z,{}),filterDropdown:function(e){var n=e.setSelectedKeys,t=e.selectedKeys,r=e.confirm;return(0,a.jsx)("div",{style:{padding:8},children:(0,a.jsx)(l.Z,{placeholder:"Search display names...",value:t[0],onChange:function(e){n(e.target.value?[e.target.value]:[]),r({closeDropdown:!1})}})})},onFilter:function(e,n){return n.user.displayName.includes(e)},sortDirections:["descend","ascend"]},{title:"Messages sent",dataIndex:"messageCount",key:"messageCount",className:"number-col",width:"12%",sorter:function(e,n){return e.messageCount-n.messageCount},sortDirections:["descend","ascend"],render:function(e){return(0,a.jsx)("div",{style:{textAlign:"center"},children:e})}},{title:"Connected Time",dataIndex:"connectedAt",key:"connectedAt",defaultSortOrder:"ascend",render:function(e){return(0,p.Z)(new Date(e))},sorter:function(e,n){return new Date(n.connectedAt).getTime()-new Date(e.connectedAt).getTime()},sortDirections:["descend","ascend"]},{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:function(e){return(0,x.AB)(e)}},{title:"Location",dataIndex:"geo",key:"geo",render:function(e){return e?"".concat(e.regionName,", ").concat(e.countryCode):"-"}},{title:"",key:"block",className:"actions-col",render:function(e,n){return(0,a.jsx)(g.e,{user:n.user,isEnabled:!n.user.disabledAt})}}];return(0,a.jsx)(f.Z,{className:"table-container",pagination:{hideOnSinglePage:!0},columns:t,dataSource:n,size:"small",rowKey:"id"})},j=t(71577),v=t(58091),A=t(84674);function w(){return(w=(0,r.Z)((function(e){var n;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,u.rQ)(u.RB,{data:{value:e},method:"POST",auth:!0})];case 1:return t.sent(),[3,3];case 2:return n=t.sent(),console.error(n),[3,3];case 3:return[2]}}))}))).apply(this,arguments)}var b=function(e){var n=e.data,t=[{title:"IP Address",dataIndex:"ipAddress",key:"ipAddress"},{title:"Reason",dataIndex:"notes",key:"notes"},{title:"Created",dataIndex:"createdAt",key:"createdAt",render:function(e){return function(e){return(0,v.Z)(new Date(e),"MMM d H:mma")}(e)},sorter:function(e,n){return new Date(e.createdAt).getTime()-new Date(n.createdAt).getTime()},sortDirections:["descend","ascend"]},{title:"",key:"block",className:"actions-col",render:function(e,n){return(0,a.jsx)(j.Z,{title:"Remove IP Address Ban",onClick:function(){return function(e){return w.apply(this,arguments)}(n.ipAddress)},icon:(0,a.jsx)(A.Z,{twoToneColor:"#ff4d4f"}),className:"block-user-button"})}}];return(0,a.jsx)(f.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:t,dataSource:n,size:"large",rowKey:"ipAddress"})},N=o.Z.TabPane,k=1e4;function C(){var e=((0,c.useContext)(i.aC)||{}).online,n=(0,c.useState)([]),t=n[0],l=n[1],f=(0,c.useState)([]),h=f[0],p=f[1],m=(0,c.useState)([]),g=m[0],x=m[1],j=(0,c.useState)([]),v=j[0],A=j[1],w=function(){var e=(0,r.Z)((function(){var e,n,t,r,a,c,o,i;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,(0,u.rQ)(u.qk)];case 1:return e=s.sent(),l(e),[3,3];case 2:return n=s.sent(),console.log("==== error",n),[3,3];case 3:return s.trys.push([3,5,,6]),[4,(0,u.rQ)(u.Kp)];case 4:return t=s.sent(),x(t),[3,6];case 5:return r=s.sent(),console.log("==== error",r),[3,6];case 6:return s.trys.push([6,8,,9]),[4,(0,u.rQ)(u.GC)];case 7:return a=s.sent(),A(a),[3,9];case 8:return c=s.sent(),console.error("error fetching moderators",c),[3,9];case 9:return s.trys.push([9,11,,12]),[4,(0,u.rQ)(u.Bu)];case 10:return o=s.sent(),p(o),[3,12];case 11:return i=s.sent(),console.error("error fetching banned ips",i),[3,12];case 12:return[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){var e;return w(),e=setInterval(w,k),function(){clearInterval(e)}}),[e]);var C=e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y,{data:g}),(0,a.jsxs)("p",{className:"description",children:["Visit the"," ",(0,a.jsx)("a",{href:"https://owncast.online/docs/viewers/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"documentation"})," ","to configure additional details about your viewers."]})]}):(0,a.jsx)("p",{className:"description",children:"When a stream is active and chat is enabled, connected chat clients will be displayed here."});return(0,a.jsxs)(o.Z,{defaultActiveKey:"1",children:[(0,a.jsx)(N,{tab:(0,a.jsxs)("span",{children:["Connected ",e?"(".concat(g.length,")"):"(offline)"]}),children:C},"1"),(0,a.jsx)(N,{tab:(0,a.jsxs)("span",{children:["Banned Users (",t.length,")"]}),children:(0,a.jsx)(d.K,{data:t})},"2"),(0,a.jsx)(N,{tab:(0,a.jsxs)("span",{children:["IP Bans (",h.length,")"]}),children:(0,a.jsx)(b,{data:h})},"3"),(0,a.jsx)(N,{tab:(0,a.jsxs)("span",{children:["Moderators (",v.length,")"]}),children:(0,a.jsx)(d.K,{data:v})},"4")]})}}},function(e){e.O(0,[3662,8939,3903,3698,355,8091,2944,5938,2460,9640,9774,2888,179],(function(){return n=55583,e(e.s=n);var n}));var n=e.O();_N_E=n}]);