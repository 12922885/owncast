(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9522],{55583:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/chat/users",function(){return t(75931)}])},75931:function(e,n,t){"use strict";t.r(n),t.d(n,{FETCH_INTERVAL:function(){return C},default:function(){return Z}});var r=t(47568),a=t(34051),s=t.n(a),c=t(85893),o=t(67294),i=t(87961),d=t(35159),u=t(58827),l=t(20643),f=t(69677),p=t(10355),h=t(68795),x=t(45938),m=t(31386),g=t(66192),v=t(2766);function y(e){var n=e.data,t=[{title:"Display Name",key:"username",render:function(e){var n=e.user,t={connectedAt:e.connectedAt,messageCount:e.messageCount,userAgent:e.userAgent};return(0,c.jsx)(m.Z,{user:n,connectionInfo:t,children:(0,c.jsx)("span",{className:"display-name",children:n.displayName})})},sorter:function(e,n){return n.user.displayName.localeCompare(e.user.displayName)},filterIcon:(0,c.jsx)(h.Z,{}),filterDropdown:function(e){var n=e.setSelectedKeys,t=e.selectedKeys,r=e.confirm;return(0,c.jsx)("div",{style:{padding:8},children:(0,c.jsx)(f.Z,{placeholder:"Search display names...",value:t[0],onChange:function(e){n(e.target.value?[e.target.value]:[]),r({closeDropdown:!1})}})})},onFilter:function(e,n){return n.user.displayName.includes(e)},sortDirections:["descend","ascend"]},{title:"Messages sent",dataIndex:"messageCount",key:"messageCount",className:"number-col",width:"12%",sorter:function(e,n){return e.messageCount-n.messageCount},sortDirections:["descend","ascend"],render:function(e){return(0,c.jsx)("div",{style:{textAlign:"center"},children:e})}},{title:"Connected Time",dataIndex:"connectedAt",key:"connectedAt",defaultSortOrder:"ascend",render:function(e){return(0,x.Z)(new Date(e))},sorter:function(e,n){return new Date(n.connectedAt).getTime()-new Date(e.connectedAt).getTime()},sortDirections:["descend","ascend"]},{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:function(e){return(0,v.AB)(e)}},{title:"Location",dataIndex:"geo",key:"geo",render:function(e){return e?"".concat(e.regionName,", ").concat(e.countryCode):"-"}},{title:"",key:"block",className:"actions-col",render:function(e,n){return(0,c.jsx)(g.Z,{user:n.user,isEnabled:!n.user.disabledAt})}}];return(0,c.jsx)(p.Z,{className:"table-container",pagination:{hideOnSinglePage:!0},columns:t,dataSource:n,size:"small",rowKey:"id"})}var j=t(71577),k=t(58091),b=t(84674);function w(){return(w=(0,r.Z)(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.rQ)(u.RB,{data:{value:n},method:"POST",auth:!0});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function A(e){var n=e.data,t=[{title:"IP Address",dataIndex:"ipAddress",key:"ipAddress"},{title:"Reason",dataIndex:"notes",key:"notes"},{title:"Created",dataIndex:"createdAt",key:"createdAt",render:function(e){return function(e){return(0,k.Z)(new Date(e),"MMM d H:mma")}(e)},sorter:function(e,n){return new Date(e.createdAt).getTime()-new Date(n.createdAt).getTime()},sortDirections:["descend","ascend"]},{title:"",key:"block",className:"actions-col",render:function(e,n){return(0,c.jsx)(j.Z,{title:"Remove IP Address Ban",onClick:function(){return function(e){return w.apply(this,arguments)}(n.ipAddress)},icon:(0,c.jsx)(b.Z,{twoToneColor:"#ff4d4f"}),className:"block-user-button"})}}];return(0,c.jsx)(p.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:t,dataSource:n,size:"large",rowKey:"ipAddress"})}var N=i.Z.TabPane,C=1e4;function Z(){var e=((0,o.useContext)(d.aC)||{}).online,n=(0,o.useState)([]),t=n[0],a=n[1],f=(0,o.useState)([]),p=f[0],h=f[1],x=(0,o.useState)([]),m=x[0],g=x[1],v=(0,o.useState)([]),j=v[0],k=v[1],b=function(){var e=(0,r.Z)(s().mark((function e(){var n,t,r,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.rQ)(u.qk);case 3:n=e.sent,a(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("==== error",e.t0);case 10:return e.prev=10,e.next=13,(0,u.rQ)(u.Kp);case 13:t=e.sent,g(t),e.next=20;break;case 17:e.prev=17,e.t1=e.catch(10),console.log("==== error",e.t1);case 20:return e.prev=20,e.next=23,(0,u.rQ)(u.GC);case 23:r=e.sent,k(r),e.next=30;break;case 27:e.prev=27,e.t2=e.catch(20),console.error("error fetching moderators",e.t2);case 30:return e.prev=30,e.next=33,(0,u.rQ)(u.Bu);case 33:c=e.sent,h(c),e.next=40;break;case 37:e.prev=37,e.t3=e.catch(30),console.error("error fetching banned ips",e.t3);case 40:case"end":return e.stop()}}),e,null,[[0,7],[10,17],[20,27],[30,37]])})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){var e;return b(),e=setInterval(b,C),function(){clearInterval(e)}}),[e]);var w=e?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(y,{data:m}),(0,c.jsxs)("p",{className:"description",children:["Visit the"," ",(0,c.jsx)("a",{href:"https://owncast.online/docs/viewers/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"documentation"})," ","to configure additional details about your viewers."]})]}):(0,c.jsx)("p",{className:"description",children:"When a stream is active and chat is enabled, connected chat clients will be displayed here."});return(0,c.jsxs)(i.Z,{defaultActiveKey:"1",children:[(0,c.jsx)(N,{tab:(0,c.jsxs)("span",{children:["Connected ",e?"(".concat(m.length,")"):"(offline)"]}),children:w},"1"),(0,c.jsx)(N,{tab:(0,c.jsxs)("span",{children:["Banned Users (",t.length,")"]}),children:(0,c.jsx)(l.Z,{data:t})},"2"),(0,c.jsx)(N,{tab:(0,c.jsxs)("span",{children:["IP Bans (",p.length,")"]}),children:(0,c.jsx)(A,{data:p})},"3"),(0,c.jsx)(N,{tab:(0,c.jsxs)("span",{children:["Moderators (",j.length,")"]}),children:(0,c.jsx)(l.Z,{data:j})},"4")]})}}},function(e){e.O(0,[3662,384,355,8091,7961,5938,7464,9774,2888,179],(function(){return n=55583,e(e.s=n);var n}));var n=e.O();_N_E=n}]);