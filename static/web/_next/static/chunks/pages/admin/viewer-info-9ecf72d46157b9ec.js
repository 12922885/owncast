(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6109],{92794:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/viewer-info",function(){return n(51810)}])},36435:function(e,t,n){"use strict";n.d(t,{k:function(){return u}});var r=n(85893),a=n(9085),s=n(92616),i=n.n(s),l=n(58091),o=n(60727);function c(e){let t={};return e.forEach(e=>{let n=new Date(e.time),r=(0,l.Z)(n,"H:mma");t[r]=e.value}),t}i().use(a.ZP);let u=e=>{let{data:t,title:n,color:a,unit:s,dataCollections:i,yFlipped:l,yLogarithmic:u}=e,d=[];t&&t.length>0&&d.push({name:n,color:a,data:c(t)}),i.forEach(e=>{d.push({name:e.name,data:c(e.data),color:e.color,dataset:e.options})});let h={scales:{y:{reverse:!1,type:"linear"},x:{type:"time"}}};return h.scales.y.reverse=l,h.scales.y.type=u?"logarithmic":"linear",(0,r.jsx)("div",{className:"line-chart-container",children:(0,r.jsx)(o.wW,{xtitle:"Time",ytitle:n,suffix:s,legend:"bottom",color:a,data:d,download:n,library:h})})};u.defaultProps={dataCollections:[],data:[],title:"",yFlipped:!1,yLogarithmic:!1}},23589:function(e,t,n){"use strict";n.d(t,{m:function(){return f}});var r=n(85893),a=n(6880),s=n(97910),i=n(74763),l=n(59652);let{Text:o}=a.Z,c={title:"",value:0,prefix:null,suffix:null,color:"",progress:!1,centered:!1,formatter:null},u=e=>{let{prefix:t,value:n,suffix:a,title:s}=e;return(0,r.jsxs)("div",{children:[t,(0,r.jsx)("div",{children:(0,r.jsx)(o,{type:"secondary",children:s})}),(0,r.jsx)("div",{children:(0,r.jsxs)(o,{type:"secondary",children:[n,a||"%"]})})]})},d=e=>{let{title:t,value:n,prefix:a,suffix:i,color:l}=e,o=(0,r.jsx)(u,{prefix:a,value:n,suffix:i,title:t});return(0,r.jsx)(s.Z,{type:"dashboard",percent:n,width:120,strokeColor:{"0%":l,"90%":n>90?"red":l},format:()=>o})};d.defaultProps=c;let h=e=>{let{title:t,value:n,prefix:a,formatter:s}=e;return(0,r.jsx)(i.Z,{title:t,value:n,prefix:a,formatter:s})};h.defaultProps=c;let f=e=>{let{progress:t,centered:n}=e,a=t?d:h;return(0,r.jsx)(l.Z,{type:"inner",children:(0,r.jsx)("div",{style:n?{display:"flex",alignItems:"center",justifyContent:"center"}:{},children:(0,r.jsx)(a,{...e})})})};f.defaultProps=c},51810:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var r=n(85893),a=n(67294),s=n(66516),i=n(6880),l=n(71230),o=n(15746),c=n(14670),u=n(11382),d=n(13013),h=n(87547),f=n(80882),m=n(46038),g=n(28401),x=n(36435),p=n(23589),v=n(48213),y=n(45938),w=n(70241);let j=e=>{let{data:t}=e;return(0,r.jsx)(v.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:[{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:e=>(0,w.AB)(e)},{title:"Location",dataIndex:"geo",key:"geo",render:e=>e?"".concat(e.regionName,", ").concat(e.countryCode):"-"},{title:"Watch Time",dataIndex:"firstSeen",key:"firstSeen",defaultSortOrder:"ascend",render:e=>(0,y.Z)(new Date(e)),sorter:(e,t)=>new Date(e.firstSeen).getTime()-new Date(t.firstSeen).getTime(),sortDirections:["descend","ascend"]}],dataSource:t,size:"small",rowKey:"id"})};var b=n(99519),Z=n(64777);function S(){let e;let t=(0,a.useContext)(b.aC),{online:n,broadcaster:v,viewerCount:y,overallPeakViewerCount:w,sessionPeakViewerCount:S}=t||{};v&&v.time&&(e=new Date(v.time));let C=[{title:"Current stream",start:e},{title:"Last 12 hours",start:(0,m.Z)(new Date,{hours:12})},{title:"Last 24 hours",start:(0,m.Z)(new Date,{hours:24})},{title:"Last 7 days",start:(0,m.Z)(new Date,{days:7})},{title:"Last 30 days",start:(0,m.Z)(new Date,{days:30})},{title:"Last 3 months",start:(0,m.Z)(new Date,{months:3})},{title:"Last 6 months",start:(0,m.Z)(new Date,{months:6})}],[k,P]=(0,a.useState)(!0),[D,M]=(0,a.useState)([]),[E,L]=(0,a.useState)([]),[T,_]=(0,a.useState)(C[1]),I=async()=>{try{let e="".concat(Z.iV,"?windowStart=").concat((0,g.Z)(T.start)),t=await (0,Z.rQ)(e);M(t),P(!1)}catch(n){console.log("==== error",n)}try{let r=await (0,Z.rQ)(Z.a_);L(r)}catch(a){console.log("==== error",a)}};(0,a.useEffect)(()=>{let e=null;return(I(),n)?(e=setInterval(I,6e4),()=>{clearInterval(e)}):()=>[]},[n,T]);let N=e=>{let{key:t}=e;_(C[t])},V=(0,r.jsxs)(s.Z,{children:[n&&e&&(0,r.jsx)(s.Z.Item,{onClick:N,children:C[0].title},"0"),C.slice(1).map((e,t)=>(0,r.jsx)(s.Z.Item,{onClick:N,children:e.title},t+1))]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z.Title,{children:"Viewer Info"}),(0,r.jsx)("br",{}),(0,r.jsxs)(l.Z,{gutter:[16,16],justify:"space-around",children:[n&&(0,r.jsx)(o.Z,{span:8,md:8,children:(0,r.jsx)(p.m,{title:"Current viewers",value:y.toString(),prefix:(0,r.jsx)(h.Z,{})})}),(0,r.jsx)(o.Z,{md:n?8:12,children:(0,r.jsx)(p.m,{title:n?"Max viewers this stream":"Max viewers last stream",value:S.toString(),prefix:(0,r.jsx)(h.Z,{})})}),(0,r.jsx)(o.Z,{md:n?8:12,children:(0,r.jsx)(p.m,{title:"All-time max viewers",value:w.toString(),prefix:(0,r.jsx)(h.Z,{})})})]}),!D.length&&(0,r.jsx)(c.Z,{style:{marginTop:"10px"},banner:!0,message:"Please wait",description:"No viewer data has been collected yet.",type:"info"}),(0,r.jsxs)(u.Z,{spinning:!D.length||k,children:[(0,r.jsx)(d.Z,{overlay:V,trigger:["click"],children:(0,r.jsxs)("button",{type:"button",style:{float:"right",background:"transparent",border:"unset"},children:[T.title," ",(0,r.jsx)(f.Z,{})]})}),D.length>0&&(0,r.jsx)(x.k,{title:"Viewers",data:D,color:"#2087E2",unit:""}),(0,r.jsx)(j,{data:E})]})]})}},70241:function(e,t,n){"use strict";n.d(t,{AB:function(){return c},Qr:function(){return i},t5:function(){return s},wS:function(){return o}});var r=n(42238),a=n.n(r);function s(e){let t=e.split(":");t[t.length-1]="";let n=t.join(":");return"[::1]"===(n=n.slice(0,n.length-1))||"127.0.0.1"===n?"Localhost":n}function i(e){return!e||0===Object.keys(e).length&&e.constructor===Object}function l(e,t,n){return String(t.repeat(n)+e).slice(-n)}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Number.isFinite(+e)?Math.abs(e):0,n=Math.floor(t/86400),r=n>0?"".concat(n," day").concat(n>1?"s":""," "):"",a=Math.floor(t/3600%24),s=a||n?l("".concat(a,":"),"0",3):"",i=l("".concat(Math.floor(t/60%60),":"),"0",3),o=l("".concat(Math.floor(t%60)),"0",2);return r+s+i+o}function c(e){let t=a()(e),{device:n,os:r,browser:s}=t,{major:i,name:l}=s,{version:o,name:c}=r,{model:u,type:d}=n;return"libmpv"===e?"mpv media player":l&&i&&c?"".concat(l," ").concat(i," on ").concat(c," ").concat(o,"\n  ").concat(u||d?" (".concat(u||d,")"):""):e}},99519:function(e,t,n){"use strict";n.d(t,{aC:function(){return d}});var r=n(85893),a=n(67294),s=n(45697),i=n.n(s),l=n(64777),o=n(90745);let c={streamKeys:[],adminPassword:"",instanceDetails:{customStyles:"",extraPageContent:"",logo:"",name:"",nsfw:!1,socialHandles:[],streamTitle:"",summary:"",tags:[],title:"",welcomeMessage:"",offlineMessage:"",appearanceVariables:{}},ffmpegPath:"",rtmpServerPort:"",webServerPort:"",socketHostOverride:null,s3:{accessKey:"",acl:"",bucket:"",enabled:!1,endpoint:"",region:"",secret:"",servingEndpoint:"",forcePathStyle:!1},yp:{enabled:!1,instanceUrl:""},videoSettings:{latencyLevel:4,cpuUsageLevel:3,videoQualityVariants:[o.gX]},federation:{enabled:!1,isPrivate:!1,username:"",goLiveMessage:"",showEngagement:!0,blockedDomains:[]},notifications:{browser:{enabled:!1,goLiveMessage:""},discord:{enabled:!1,webhook:"",goLiveMessage:""},twitter:{enabled:!1,goLiveMessage:"",apiKey:"",apiSecret:"",accessToken:"",accessTokenSecret:"",bearerToken:""}},externalActions:[],supportedCodecs:[],videoCodec:"",forbiddenUsernames:[],suggestedUsernames:[],chatDisabled:!1,chatJoinMessagesEnabled:!0,chatEstablishedUserMode:!1,hideViewerCount:!1},u={broadcastActive:!1,broadcaster:null,currentBroadcast:null,online:!1,viewerCount:0,sessionMaxViewerCount:0,sessionPeakViewerCount:0,overallPeakViewerCount:0,versionNumber:"0.0.0",streamTitle:"",chatDisabled:!1,health:{healthy:!0,healthPercentage:100,message:"",representation:0}},d=a.createContext({...u,serverConfig:c,setFieldInConfigState:e=>null}),h=e=>{let{children:t}=e,[n,s]=(0,a.useState)(u),[i,o]=(0,a.useState)(c),h=async()=>{try{let e=await (0,l.rQ)(l.Q_);s({...e})}catch(t){}},f=async()=>{try{let e=await (0,l.rQ)(l.bl);o(e)}catch(t){}},m=e=>{let{fieldName:t,value:n,path:r}=e,a=r?{...i,[r]:{...i[r],[t]:n}}:{...i,[t]:n};o(a)};(0,a.useEffect)(()=>{let e=null;return h(),e=setInterval(h,l.NE),f(),()=>{clearInterval(e)}},[]);let g={...n,serverConfig:i,setFieldInConfigState:m};return(0,r.jsx)(d.Provider,{value:g,children:t})};h.propTypes={children:i().element.isRequired},t.ZP=h}},function(e){e.O(0,[2196,5596,481,173,1407,4083,6880,3174,1577,6386,3013,3698,2459,8213,9915,575,1834,7910,428,8067,5938,558,1512,745,9774,2888,179],function(){return e(e.s=92794)}),_N_E=e.O()}]);
//# sourceMappingURL=viewer-info-9ecf72d46157b9ec.js.map