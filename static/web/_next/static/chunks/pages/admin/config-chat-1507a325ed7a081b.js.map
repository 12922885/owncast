{"version":3,"file":"static/chunks/pages/admin/config-chat-1507a325ed7a081b.js","mappings":"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","sources":["webpack://_N_E/?a2be","webpack://_N_E/./pages/admin/config-chat.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/admin/config-chat\",\n      function () {\n        return require(\"private-next-pages/admin/config-chat.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/admin/config-chat\"])\n      });\n    }\n  ","import { Typography } from 'antd';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { TEXTFIELD_TYPE_TEXTAREA } from '../../components/admin/TextField';\nimport { TextFieldWithSubmit } from '../../components/admin/TextFieldWithSubmit';\nimport { ToggleSwitch } from '../../components/admin/ToggleSwitch';\nimport { EditValueArray } from '../../components/admin/EditValueArray';\nimport {\n  createInputStatus,\n  StatusState,\n  STATUS_ERROR,\n  STATUS_SUCCESS,\n} from '../../utils/input-statuses';\n\nimport { UpdateArgs } from '../../types/config-section';\nimport {\n  API_CHAT_FORBIDDEN_USERNAMES,\n  API_CHAT_SUGGESTED_USERNAMES,\n  FIELD_PROPS_CHAT_JOIN_MESSAGES_ENABLED,\n  CHAT_ESTABLISHED_USER_MODE,\n  FIELD_PROPS_DISABLE_CHAT,\n  postConfigUpdateToAPI,\n  RESET_TIMEOUT,\n  TEXTFIELD_PROPS_CHAT_FORBIDDEN_USERNAMES,\n  TEXTFIELD_PROPS_CHAT_SUGGESTED_USERNAMES,\n  TEXTFIELD_PROPS_SERVER_WELCOME_MESSAGE,\n} from '../../utils/config-constants';\nimport { ServerStatusContext } from '../../utils/server-status-context';\n\nexport default function ConfigChat() {\n  const { Title } = Typography;\n  const [formDataValues, setFormDataValues] = useState(null);\n  const [forbiddenUsernameSaveState, setForbiddenUsernameSaveState] = useState<StatusState>(null);\n  const [suggestedUsernameSaveState, setSuggestedUsernameSaveState] = useState<StatusState>(null);\n  const serverStatusData = useContext(ServerStatusContext);\n  const { serverConfig, setFieldInConfigState } = serverStatusData || {};\n\n  const {\n    chatDisabled,\n    chatJoinMessagesEnabled,\n    forbiddenUsernames,\n    instanceDetails,\n    suggestedUsernames,\n    chatEstablishedUserMode,\n  } = serverConfig;\n  const { welcomeMessage } = instanceDetails;\n\n  const handleFieldChange = ({ fieldName, value }: UpdateArgs) => {\n    setFormDataValues({\n      ...formDataValues,\n      [fieldName]: value,\n    });\n  };\n\n  function handleChatDisableChange(disabled: boolean) {\n    handleFieldChange({ fieldName: 'chatDisabled', value: !disabled });\n  }\n\n  function handleChatJoinMessagesEnabledChange(enabled: boolean) {\n    handleFieldChange({ fieldName: 'chatJoinMessagesEnabled', value: enabled });\n  }\n\n  function handleEstablishedUserModeChange(enabled: boolean) {\n    handleFieldChange({ fieldName: 'chatEstablishedUserMode', value: enabled });\n  }\n\n  function resetForbiddenUsernameState() {\n    setForbiddenUsernameSaveState(null);\n  }\n\n  function saveForbiddenUsernames() {\n    postConfigUpdateToAPI({\n      apiPath: API_CHAT_FORBIDDEN_USERNAMES,\n      data: { value: formDataValues.forbiddenUsernames },\n      onSuccess: () => {\n        setFieldInConfigState({\n          fieldName: 'forbiddenUsernames',\n          value: formDataValues.forbiddenUsernames,\n        });\n        setForbiddenUsernameSaveState(createInputStatus(STATUS_SUCCESS));\n        setTimeout(resetForbiddenUsernameState, RESET_TIMEOUT);\n      },\n      onError: (message: string) => {\n        setForbiddenUsernameSaveState(createInputStatus(STATUS_ERROR, message));\n        setTimeout(resetForbiddenUsernameState, RESET_TIMEOUT);\n      },\n    });\n  }\n\n  function handleDeleteForbiddenUsernameIndex(index: number) {\n    formDataValues.forbiddenUsernames.splice(index, 1);\n    saveForbiddenUsernames();\n  }\n\n  function handleCreateForbiddenUsername(tag: string) {\n    formDataValues.forbiddenUsernames.push(tag);\n    handleFieldChange({\n      fieldName: 'forbiddenUsernames',\n      value: formDataValues.forbiddenUsernames,\n    });\n    saveForbiddenUsernames();\n  }\n\n  function resetSuggestedUsernameState() {\n    setSuggestedUsernameSaveState(null);\n  }\n\n  function saveSuggestedUsernames() {\n    postConfigUpdateToAPI({\n      apiPath: API_CHAT_SUGGESTED_USERNAMES,\n      data: { value: formDataValues.suggestedUsernames },\n      onSuccess: () => {\n        setFieldInConfigState({\n          fieldName: 'suggestedUsernames',\n          value: formDataValues.suggestedUsernames,\n        });\n        setSuggestedUsernameSaveState(createInputStatus(STATUS_SUCCESS));\n        setTimeout(resetSuggestedUsernameState, RESET_TIMEOUT);\n      },\n      onError: (message: string) => {\n        setForbiddenUsernameSaveState(createInputStatus(STATUS_ERROR, message));\n        setTimeout(resetSuggestedUsernameState, RESET_TIMEOUT);\n      },\n    });\n  }\n\n  function handleDeleteSuggestedUsernameIndex(index: number) {\n    formDataValues.suggestedUsernames.splice(index, 1);\n    saveSuggestedUsernames();\n  }\n\n  function handleCreateSuggestedUsername(tag: string) {\n    formDataValues.suggestedUsernames.push(tag);\n    handleFieldChange({\n      fieldName: 'suggestedUsernames',\n      value: formDataValues.suggestedUsernames,\n    });\n    saveSuggestedUsernames();\n  }\n\n  function getSuggestedUsernamesLimitWarning(length: number): StatusState | null {\n    if (length === 0)\n      return createInputStatus('success', TEXTFIELD_PROPS_CHAT_SUGGESTED_USERNAMES.no_entries);\n    if (length > 0 && length < 10)\n      return createInputStatus('warning', TEXTFIELD_PROPS_CHAT_SUGGESTED_USERNAMES.min_not_reached);\n    return null;\n  }\n\n  useEffect(() => {\n    setFormDataValues({\n      chatDisabled,\n      chatJoinMessagesEnabled,\n      forbiddenUsernames,\n      suggestedUsernames,\n      welcomeMessage,\n      chatEstablishedUserMode,\n    });\n  }, [serverConfig]);\n\n  if (!formDataValues) {\n    return null;\n  }\n\n  return (\n    <div className=\"config-server-details-form\">\n      <Title>Chat Settings</Title>\n      <div className=\"form-module config-server-details-container\">\n        <ToggleSwitch\n          fieldName=\"chatDisabled\"\n          {...FIELD_PROPS_DISABLE_CHAT}\n          checked={!formDataValues.chatDisabled}\n          reversed\n          onChange={handleChatDisableChange}\n        />\n        <ToggleSwitch\n          fieldName=\"chatJoinMessagesEnabled\"\n          {...FIELD_PROPS_CHAT_JOIN_MESSAGES_ENABLED}\n          checked={formDataValues.chatJoinMessagesEnabled}\n          onChange={handleChatJoinMessagesEnabledChange}\n        />\n        <ToggleSwitch\n          fieldName=\"establishedUserMode\"\n          {...CHAT_ESTABLISHED_USER_MODE}\n          checked={formDataValues.chatEstablishedUserMode}\n          onChange={handleEstablishedUserModeChange}\n        />\n        <TextFieldWithSubmit\n          fieldName=\"welcomeMessage\"\n          {...TEXTFIELD_PROPS_SERVER_WELCOME_MESSAGE}\n          type={TEXTFIELD_TYPE_TEXTAREA}\n          value={formDataValues.welcomeMessage}\n          initialValue={welcomeMessage}\n          onChange={handleFieldChange}\n        />\n        <br />\n        <br />\n        <EditValueArray\n          title={TEXTFIELD_PROPS_CHAT_FORBIDDEN_USERNAMES.label}\n          placeholder={TEXTFIELD_PROPS_CHAT_FORBIDDEN_USERNAMES.placeholder}\n          description={TEXTFIELD_PROPS_CHAT_FORBIDDEN_USERNAMES.tip}\n          values={formDataValues.forbiddenUsernames}\n          handleDeleteIndex={handleDeleteForbiddenUsernameIndex}\n          handleCreateString={handleCreateForbiddenUsername}\n          submitStatus={forbiddenUsernameSaveState}\n        />\n        <br />\n        <br />\n        <EditValueArray\n          title={TEXTFIELD_PROPS_CHAT_SUGGESTED_USERNAMES.label}\n          placeholder={TEXTFIELD_PROPS_CHAT_SUGGESTED_USERNAMES.placeholder}\n          description={TEXTFIELD_PROPS_CHAT_SUGGESTED_USERNAMES.tip}\n          values={formDataValues.suggestedUsernames}\n          handleDeleteIndex={handleDeleteSuggestedUsernameIndex}\n          handleCreateString={handleCreateSuggestedUsername}\n          submitStatus={suggestedUsernameSaveState}\n          continuousStatusMessage={getSuggestedUsernamesLimitWarning(\n            formDataValues.suggestedUsernames.length,\n          )}\n        />\n      </div>\n    </div>\n  );\n}\n"],"names":["window","__NEXT_P","push","ConfigChat","Title","Typography","formDataValues","setFormDataValues","useState","forbiddenUsernameSaveState","setForbiddenUsernameSaveState","suggestedUsernameSaveState","setSuggestedUsernameSaveState","serverStatusData","useContext","ServerStatusContext","serverConfig","setFieldInConfigState","chatDisabled","chatJoinMessagesEnabled","forbiddenUsernames","instanceDetails","suggestedUsernames","chatEstablishedUserMode","welcomeMessage","handleFieldChange","fieldName","value","resetForbiddenUsernameState","saveForbiddenUsernames","postConfigUpdateToAPI","apiPath","API_CHAT_FORBIDDEN_USERNAMES","data","onSuccess","createInputStatus","STATUS_SUCCESS","setTimeout","RESET_TIMEOUT","onError","message","STATUS_ERROR","resetSuggestedUsernameState","saveSuggestedUsernames","API_CHAT_SUGGESTED_USERNAMES","useEffect","div","className","ToggleSwitch","FIELD_PROPS_DISABLE_CHAT","checked","reversed","onChange","disabled","FIELD_PROPS_CHAT_JOIN_MESSAGES_ENABLED","enabled","CHAT_ESTABLISHED_USER_MODE","TextFieldWithSubmit","TEXTFIELD_PROPS_SERVER_WELCOME_MESSAGE","type","TEXTFIELD_TYPE_TEXTAREA","initialValue","br","EditValueArray","title","TEXTFIELD_PROPS_CHAT_FORBIDDEN_USERNAMES","placeholder","description","values","handleDeleteIndex","index","splice","handleCreateString","tag","submitStatus","TEXTFIELD_PROPS_CHAT_SUGGESTED_USERNAMES","continuousStatusMessage","length"],"sourceRoot":""}