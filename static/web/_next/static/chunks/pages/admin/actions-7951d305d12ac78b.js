(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5685],{54005:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/actions",function(){return n(2075)}])},2075:function(e,t,n){"use strict";n.r(t);var a=n(85893),l=n(85818),r=n(85402),o=n(79292),i=n(79531),s=n(32808),c=n(26713),d=n(71577),u=n(54398),h=n(96486),p=n.n(h),x=n(5152),m=n.n(x),y=n(67294),j=n(73615),k=n(90745),f=n(41983),g=n(99519),v=n(37174);let{Title:w,Paragraph:b}=l.Z,C=m()(()=>Promise.all([n.e(2074),n.e(7949)]).then(n.t.bind(n,77949,23)),{loadableGenerated:{webpack:()=>[77949]},ssr:!1}),I=m()(()=>Promise.all([n.e(2074),n.e(775)]).then(n.t.bind(n,10775,23)),{loadableGenerated:{webpack:()=>[10775]},ssr:!1}),Z=e=>{let{onOk:t,onCancel:n,open:l,action:c}=e,[d,u]=(0,y.useState)(""),[h,p]=(0,y.useState)(""),[x,m]=(0,y.useState)(""),[j,k]=(0,y.useState)(""),[f,g]=(0,y.useState)(""),[w,b]=(0,y.useState)(!1);(0,y.useEffect)(()=>{u((null==c?void 0:c.url)||""),p((null==c?void 0:c.title)||""),m((null==c?void 0:c.description)||""),k((null==c?void 0:c.icon)||""),g((null==c?void 0:c.color)||""),b((null==c?void 0:c.openExternally)||!1)},[c]);let C={disabled:!((0,v.jv)(d,["https:"])&&""!==h)},I=e=>{b(e.target.checked)};return(0,a.jsx)(r.Z,{destroyOnClose:!0,title:null==c?"Create New Action":"Edit Action",open:l,onOk:function(){t(c,d,h,x,j,f,w),u(""),p(""),m(""),k(""),g(""),b(!1)},onCancel:n,okButtonProps:C,children:(0,a.jsxs)(o.Z,{initialValues:c,children:["Add the URL for the external action you want to present."," ",(0,a.jsx)("strong",{children:"Only HTTPS urls are supported."}),(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:"https://owncast.online/thirdparty/actions/",target:"_blank",rel:"noopener noreferrer",children:"Read more about external actions."})}),(0,a.jsx)(o.Z.Item,{name:"url",children:(0,a.jsx)(i.Z,{required:!0,placeholder:"https://myserver.com/action (required)",onChange:e=>u(e.currentTarget.value.trim()),type:"url",pattern:v.ax})}),(0,a.jsx)(o.Z.Item,{name:"title",children:(0,a.jsx)(i.Z,{value:h,required:!0,placeholder:"Your action title (required)",onChange:e=>p(e.currentTarget.value)})}),(0,a.jsx)(o.Z.Item,{name:"description",children:(0,a.jsx)(i.Z,{value:x,placeholder:"Optional description",onChange:e=>m(e.currentTarget.value)})}),(0,a.jsx)(o.Z.Item,{name:"icon",children:(0,a.jsx)(i.Z,{value:j,placeholder:"https://myserver.com/action/icon.png (optional)",onChange:e=>k(e.currentTarget.value)})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Z.Item,{name:"color",style:{marginBottom:"0px"},children:(0,a.jsx)(i.Z,{type:"color",value:f,onChange:e=>g(e.currentTarget.value)})}),"Optional background color of the action button."]}),(0,a.jsx)(o.Z.Item,{name:"openExternally",children:(0,a.jsx)(s.Z,{checked:w,defaultChecked:w,onChange:I,children:"Open in a new tab instead of within your page."})})]})})},E=()=>{let e=(0,y.useContext)(g.aC),{serverConfig:t,setFieldInConfigState:n}=e||{},{externalActions:l}=t,[r,o]=(0,y.useState)(null),[i,s]=(0,y.useState)(!1),[h,x]=(0,y.useState)(null),[m,v]=(0,y.useState)(null),E=()=>{x(null),clearTimeout(null)};async function S(e){await (0,k.Si)({apiPath:k.os,data:{value:e},onSuccess:()=>{n({fieldName:"externalActions",value:e,path:""}),x((0,f.kg)(f.zv,"Updated.")),setTimeout(E,k.sI)},onError:e=>{console.log(e),x((0,f.kg)(f.Un,e)),setTimeout(E,k.sI)}})}async function _(e){let t=[...r],n=r.findIndex(t=>t.url===e.url);t.splice(n,1);try{o(t),S(t)}catch(a){console.error(a)}}async function T(e,t,n,a,l,i,s){try{let c=[...r],d={url:t,title:n,description:a,icon:l,color:i,openExternally:s},u=e?r.findIndex(t=>p().isEqual(t,e)):-1;u>=0?c[u]=d:c.push(d),o(c),await S(c)}catch(h){console.error(h)}}async function O(e){v(e),s(!0)}(0,y.useEffect)(()=>{o(l||[])},[l]);let N=()=>{v(null),s(!0)},P=(e,t,n,a,l,r,o)=>{s(!1),T(e,t,n,a,l,r,o),v(null)},A=()=>{s(!1)};return(0,a.jsxs)("div",{children:[(0,a.jsx)(w,{children:"External Actions"}),(0,a.jsx)(b,{children:"External action URLs are 3rd party UI you can display, embedded, into your Owncast page when a user clicks on a button to launch your action."}),(0,a.jsxs)(b,{children:["Read more about how to use actions, with examples, at"," ",(0,a.jsx)("a",{href:"https://owncast.online/thirdparty/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"our documentation"}),"."]}),(0,a.jsx)(u.Z,{rowKey:e=>"".concat(e.title,"-").concat(e.url),columns:[{title:"",key:"delete-edit",render:(e,t)=>(0,a.jsxs)(c.Z,{size:"middle",children:[(0,a.jsx)(d.Z,{onClick:()=>_(t),icon:(0,a.jsx)(C,{})}),(0,a.jsx)(d.Z,{onClick:()=>O(t),icon:(0,a.jsx)(I,{})})]})},{title:"Name",dataIndex:"title",key:"title"},{title:"Description",dataIndex:"description",key:"description"},{title:"URL",dataIndex:"url",key:"url"},{title:"Icon",dataIndex:"icon",key:"icon",render:e=>e?(0,a.jsx)("img",{style:{width:"2vw"},src:e,alt:""}):null},{title:"Color",dataIndex:"color",key:"color",render:e=>e?(0,a.jsx)("div",{style:{backgroundColor:e,height:"30px"},children:e}):null},{title:"Opens",dataIndex:"openExternally",key:"openExternally",render:e=>e?"In a new tab":"In a modal"}],dataSource:r,pagination:!1}),(0,a.jsx)("br",{}),(0,a.jsx)(d.Z,{type:"primary",onClick:N,children:"Create New Action"}),(0,a.jsx)(j.E,{status:h}),(0,a.jsx)(Z,{action:m,open:i,onOk:P,onCancel:A})]})};t.default=E}},function(e){e.O(0,[3662,5818,6386,3698,3013,4398,9292,3403,9774,2888,179],function(){return e(e.s=54005)}),_N_E=e.O()}]);
//# sourceMappingURL=actions-7951d305d12ac78b.js.map