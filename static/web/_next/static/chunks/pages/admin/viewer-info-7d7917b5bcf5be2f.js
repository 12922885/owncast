(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6109],{92794:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/viewer-info",function(){return n(51810)}])},36435:function(e,t,n){"use strict";n.d(t,{k:function(){return u}});var r=n(85893),s=n(9085),a=n(92616),i=n.n(a),o=n(58091),l=n(60727);function c(e){const t={};return e.forEach((e=>{const n=new Date(e.time),r=(0,o.Z)(n,"H:mma");t[r]=e.value})),t}i().use(s.ZP);const u=e=>{let{data:t,title:n,color:s,unit:a,dataCollections:i,yFlipped:o,yLogarithmic:u}=e;const d=[];t&&t.length>0&&d.push({name:n,color:s,data:c(t)}),i.forEach((e=>{d.push({name:e.name,data:c(e.data),color:e.color,dataset:e.options})}));const f={scales:{y:{reverse:!1,type:"linear"},x:{type:"time"}}};return f.scales.y.reverse=o,f.scales.y.type=u?"logarithmic":"linear",(0,r.jsx)("div",{className:"line-chart-container",children:(0,r.jsx)(l.wW,{xtitle:"Time",ytitle:n,suffix:a,legend:"bottom",color:s,data:d,download:n,library:f})})};u.defaultProps={dataCollections:[],data:[],title:"",yFlipped:!1,yLogarithmic:!1}},23589:function(e,t,n){"use strict";n.d(t,{m:function(){return h}});var r=n(85893),s=n(6880),a=n(97910),i=n(74763),o=n(59652);const{Text:l}=s.Z,c={title:"",value:0,prefix:null,suffix:null,color:"",progress:!1,centered:!1,formatter:null},u=e=>{let{prefix:t,value:n,suffix:s,title:a}=e;return(0,r.jsxs)("div",{children:[t,(0,r.jsx)("div",{children:(0,r.jsx)(l,{type:"secondary",children:a})}),(0,r.jsx)("div",{children:(0,r.jsxs)(l,{type:"secondary",children:[n,s||"%"]})})]})},d=e=>{let{title:t,value:n,prefix:s,suffix:i,color:o}=e;const l=n>90?"red":o,c=(0,r.jsx)(u,{prefix:s,value:n,suffix:i,title:t});return(0,r.jsx)(a.Z,{type:"dashboard",percent:n,width:120,strokeColor:{"0%":o,"90%":l},format:()=>c})};d.defaultProps=c;const f=e=>{let{title:t,value:n,prefix:s,formatter:a}=e;return(0,r.jsx)(i.Z,{title:t,value:n,prefix:s,formatter:a})};f.defaultProps=c;const h=e=>{const{progress:t,centered:n}=e,s=t?d:f,a=n?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return(0,r.jsx)(o.Z,{type:"inner",children:(0,r.jsx)("div",{style:a,children:(0,r.jsx)(s,{...e})})})};h.defaultProps=c},51810:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var r=n(85893),s=n(67294),a=n(66516),i=n(6880),o=n(71230),l=n(15746),c=n(14670),u=n(11382),d=n(13013),f=n(87547),h=n(80882),m=n(46038),g=n(28401),p=n(36435),x=n(23589),v=n(48213),y=n(45938),w=n(70241);const j=e=>{let{data:t}=e;const n=[{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:e=>(0,w.AB)(e)},{title:"Location",dataIndex:"geo",key:"geo",render:e=>e?"".concat(e.regionName,", ").concat(e.countryCode):"-"},{title:"Watch Time",dataIndex:"firstSeen",key:"firstSeen",defaultSortOrder:"ascend",render:e=>(0,y.Z)(new Date(e)),sorter:(e,t)=>new Date(e.firstSeen).getTime()-new Date(t.firstSeen).getTime(),sortDirections:["descend","ascend"]}];return(0,r.jsx)(v.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:n,dataSource:t,size:"small",rowKey:"id"})};var b=n(99519),Z=n(64777);function C(){const e=(0,s.useContext)(b.aC),{online:t,broadcaster:n,viewerCount:v,overallPeakViewerCount:y,sessionPeakViewerCount:w}=e||{};let C;n&&n.time&&(C=new Date(n.time));const S=[{title:"Current stream",start:C},{title:"Last 12 hours",start:(0,m.Z)(new Date,{hours:12})},{title:"Last 24 hours",start:(0,m.Z)(new Date,{hours:24})},{title:"Last 7 days",start:(0,m.Z)(new Date,{days:7})},{title:"Last 30 days",start:(0,m.Z)(new Date,{days:30})},{title:"Last 3 months",start:(0,m.Z)(new Date,{months:3})},{title:"Last 6 months",start:(0,m.Z)(new Date,{months:6})}],[k,P]=(0,s.useState)(!0),[D,L]=(0,s.useState)([]),[M,E]=(0,s.useState)([]),[T,_]=(0,s.useState)(S[1]),I=async()=>{try{const e="".concat(Z.iV,"?windowStart=").concat((0,g.Z)(T.start)),t=await(0,Z.rQ)(e);L(t),P(!1)}catch(e){console.log("==== error",e)}try{const e=await(0,Z.rQ)(Z.a_);E(e)}catch(t){console.log("==== error",t)}};(0,s.useEffect)((()=>{let e=null;return I(),t?(e=setInterval(I,6e4),()=>{clearInterval(e)}):()=>[]}),[t,T]);const N=e=>{let{key:t}=e;_(S[t])},V=(0,r.jsxs)(a.Z,{children:[t&&C&&(0,r.jsx)(a.Z.Item,{onClick:N,children:S[0].title},"0"),S.slice(1).map(((e,t)=>(0,r.jsx)(a.Z.Item,{onClick:N,children:e.title},t+1)))]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z.Title,{children:"Viewer Info"}),(0,r.jsx)("br",{}),(0,r.jsxs)(o.Z,{gutter:[16,16],justify:"space-around",children:[t&&(0,r.jsx)(l.Z,{span:8,md:8,children:(0,r.jsx)(x.m,{title:"Current viewers",value:v.toString(),prefix:(0,r.jsx)(f.Z,{})})}),(0,r.jsx)(l.Z,{md:t?8:12,children:(0,r.jsx)(x.m,{title:t?"Max viewers this stream":"Max viewers last stream",value:w.toString(),prefix:(0,r.jsx)(f.Z,{})})}),(0,r.jsx)(l.Z,{md:t?8:12,children:(0,r.jsx)(x.m,{title:"All-time max viewers",value:y.toString(),prefix:(0,r.jsx)(f.Z,{})})})]}),!D.length&&(0,r.jsx)(c.Z,{style:{marginTop:"10px"},banner:!0,message:"Please wait",description:"No viewer data has been collected yet.",type:"info"}),(0,r.jsxs)(u.Z,{spinning:!D.length||k,children:[(0,r.jsx)(d.Z,{overlay:V,trigger:["click"],children:(0,r.jsxs)("button",{type:"button",style:{float:"right",background:"transparent",border:"unset"},children:[T.title," ",(0,r.jsx)(h.Z,{})]})}),D.length>0&&(0,r.jsx)(p.k,{title:"Viewers",data:D,color:"#2087E2",unit:""}),(0,r.jsx)(j,{data:M})]})]})}},70241:function(e,t,n){"use strict";n.d(t,{AB:function(){return c},Qr:function(){return i},t5:function(){return a},wS:function(){return l}});var r=n(42238),s=n.n(r);function a(e){const t=e.split(":");t[t.length-1]="";let n=t.join(":");return n=n.slice(0,n.length-1),"[::1]"===n||"127.0.0.1"===n?"Localhost":n}function i(e){return!e||0===Object.keys(e).length&&e.constructor===Object}function o(e,t,n){return String(t.repeat(n)+e).slice(-n)}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=Number.isFinite(+e)?Math.abs(e):0,n=Math.floor(t/86400),r=n>0?"".concat(n," day").concat(n>1?"s":""," "):"",s=Math.floor(t/3600%24),a=s||n?o("".concat(s,":"),"0",3):"",i=Math.floor(t/60%60),l=o("".concat(i,":"),"0",3),c=Math.floor(t%60),u=o("".concat(c),"0",2);return r+a+l+u}function c(e){const t=s()(e),{device:n,os:r,browser:a}=t,{major:i,name:o}=a,{version:l,name:c}=r,{model:u,type:d}=n;if("libmpv"===e)return"mpv media player";if(!o||!i||!c)return e;const f=u||d?" (".concat(u||d,")"):"";return"".concat(o," ").concat(i," on ").concat(c," ").concat(l,"\n  ").concat(f)}},99519:function(e,t,n){"use strict";n.d(t,{aC:function(){return u}});var r=n(85893),s=n(67294),a=n(45697),i=n.n(a),o=n(64777);const l={streamKeys:[],adminPassword:"",instanceDetails:{customStyles:"",extraPageContent:"",logo:"",name:"",nsfw:!1,socialHandles:[],streamTitle:"",summary:"",tags:[],title:"",welcomeMessage:"",offlineMessage:"",appearanceVariables:{}},ffmpegPath:"",rtmpServerPort:"",webServerPort:"",socketHostOverride:null,s3:{accessKey:"",acl:"",bucket:"",enabled:!1,endpoint:"",region:"",secret:"",servingEndpoint:"",forcePathStyle:!1},yp:{enabled:!1,instanceUrl:""},videoSettings:{latencyLevel:4,cpuUsageLevel:3,videoQualityVariants:[n(90745).gX]},federation:{enabled:!1,isPrivate:!1,username:"",goLiveMessage:"",showEngagement:!0,blockedDomains:[]},notifications:{browser:{enabled:!1,goLiveMessage:""},discord:{enabled:!1,webhook:"",goLiveMessage:""},twitter:{enabled:!1,goLiveMessage:"",apiKey:"",apiSecret:"",accessToken:"",accessTokenSecret:"",bearerToken:""}},externalActions:[],supportedCodecs:[],videoCodec:"",forbiddenUsernames:[],suggestedUsernames:[],chatDisabled:!1,chatJoinMessagesEnabled:!0,chatEstablishedUserMode:!1,hideViewerCount:!1},c={broadcastActive:!1,broadcaster:null,currentBroadcast:null,online:!1,viewerCount:0,sessionMaxViewerCount:0,sessionPeakViewerCount:0,overallPeakViewerCount:0,versionNumber:"0.0.0",streamTitle:"",chatDisabled:!1,health:{healthy:!0,healthPercentage:100,message:"",representation:0}},u=s.createContext({...c,serverConfig:l,setFieldInConfigState:e=>null}),d=e=>{let{children:t}=e;const[n,a]=(0,s.useState)(c),[i,d]=(0,s.useState)(l),f=async()=>{try{const e=await(0,o.rQ)(o.Q_);a({...e})}catch(e){}};(0,s.useEffect)((()=>{let e=null;return f(),e=setInterval(f,o.NE),(async()=>{try{const e=await(0,o.rQ)(o.bl);d(e)}catch(e){}})(),()=>{clearInterval(e)}}),[]);const h={...n,serverConfig:i,setFieldInConfigState:e=>{let{fieldName:t,value:n,path:r}=e;const s=r?{...i,[r]:{...i[r],[t]:n}}:{...i,[t]:n};d(s)}};return(0,r.jsx)(u.Provider,{value:h,children:t})};d.propTypes={children:i().element.isRequired},t.ZP=d}},function(e){e.O(0,[2196,5596,481,173,1407,4083,6880,3174,1577,6386,3013,3698,2459,8213,9915,575,1834,7910,428,8067,5938,558,1512,745,9774,2888,179],(function(){return t=92794,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=viewer-info-7d7917b5bcf5be2f.js.map