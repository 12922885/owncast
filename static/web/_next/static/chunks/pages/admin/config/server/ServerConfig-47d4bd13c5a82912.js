(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5388],{29284:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/config/server/ServerConfig",function(){return n(87807)}])},10135:function(e,t,n){"use strict";n.d(t,{$7:function(){return v},Kx:function(){return f},Sk:function(){return h},xA:function(){return g}});var s=n(85893),r=n(71577),a=n(94184),i=n.n(a),o=n(67294),l=n(90745),c=n(41983),u=n(99519),d=n(39664),m=n(52018);let f="default",h="textarea",g="url",v=e=>{let{apiPath:t,configPath:n="",initialValue:a,useTrim:f,useTrimLead:h,...g}=e,[v,p]=(0,o.useState)(null),[y,x]=(0,o.useState)(!1),w=(0,o.useContext)(u.aC),{setFieldInConfigState:b}=w||{},j=null,{fieldName:k,required:C,tip:N,status:S,value:P,onChange:T,onSubmit:Z}=g,E=()=>{p(null),x(!1),clearTimeout(j),j=null};(0,o.useEffect)(()=>{C&&(""===P||null===P)||P===a?x(!1):(E(),x(!0))},[P]);let M=e=>{let{fieldName:t,value:n}=e;if(T){let s=n;f?s=n.trim():h&&(s=n.replace(/^\s+/g,"")),T({fieldName:t,value:s})}},_=e=>{let{value:t}=e;T&&C&&""===t&&T({fieldName:k,value:a})},V=async()=>{(C&&""!==P||P!==a)&&(p((0,c.kg)(c.Jk)),await (0,l.Si)({apiPath:t,data:{value:P},onSuccess:()=>{b({fieldName:k,value:P,path:n}),p((0,c.kg)(c.zv))},onError:e=>{p((0,c.kg)(c.Un,"There was an error: ".concat(e)))}}),j=setTimeout(E,l.sI),Z&&Z())},U=i()({"textfield-with-submit-container":!0,submittable:y});return(0,s.jsxs)("div",{className:U,children:[(0,s.jsx)("div",{className:"textfield-component",children:(0,s.jsx)(m.nv,{...g,onSubmit:null,onBlur:_,onChange:M})}),(0,s.jsxs)("div",{className:"formfield-container lower-container",children:[(0,s.jsx)("p",{className:"label-spacer"}),(0,s.jsxs)("div",{className:"lower-content",children:[(0,s.jsx)("div",{className:"field-tip",children:N}),(0,s.jsx)(d.E,{status:S||v}),(0,s.jsx)("div",{className:"update-button-container",children:(0,s.jsx)(r.Z,{type:"primary",size:"small",className:"submit-button",onClick:V,disabled:!y,children:"Update"})})]})]})]})};v.defaultProps={configPath:"",initialValue:""}},87807:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var s=n(85893),r=n(67294),a=n(54907),i=n(94199),o=n(71577),l=n(84485),c=n(87740),u=n(57132),d=n(52018),m=n(10135),f=n(99519),h=n(82661),g=n(90745),v=n(65360),p=n(64777),y=n(41983),x=n(39664);let w=()=>{let{setMessage:e}=(0,r.useContext)(h.k),[t,n]=(0,r.useState)(null),a=()=>{n(null),clearTimeout(null)},i=async()=>{n((0,y.kg)(y.Jk));try{await (0,p.rQ)(p.UJ),e(""),n((0,y.kg)(y.zv)),setTimeout(a,g.sI)}catch(t){n((0,y.kg)(y.Un,"There was an error: ".concat(t))),setTimeout(a,g.sI)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Z.Title,{level:3,className:"section-title",children:"Reset Directory"}),(0,s.jsx)("p",{className:"description",children:'If you are experiencing issues with your listing on the Owncast Directory and were asked to "reset" your connection to the service, you can do that here. The next time you go live it will try and re-register your server with the directory from scratch.'}),(0,s.jsx)(v.Z,{placement:"topLeft",title:"Are you sure you want to reset your connection to the Owncast directory?",onConfirm:i,okText:"Yes",cancelText:"No",children:(0,s.jsx)(o.Z,{type:"primary",children:"Reset Directory Connection"})}),(0,s.jsx)("p",{children:(0,s.jsx)(x.E,{status:t})})]})},{Panel:b}=a.Z,j=()=>{let[e,t]=(0,r.useState)(null),n=(0,r.useContext)(f.aC),{setMessage:v}=(0,r.useContext)(h.k),{serverConfig:p}=n||{},{adminPassword:y,ffmpegPath:x,rtmpServerPort:j,webServerPort:k,yp:C,socketHostOverride:N}=p,[S,P]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{t({adminPassword:y,ffmpegPath:x,rtmpServerPort:j,webServerPort:k,socketHostOverride:N})},[p]),!e)return null;let T=n=>{let{fieldName:s,value:r}=n;t({...e,[s]:r})},Z=()=>{v("Updating server settings requires a restart of your Owncast server.")},E=()=>{v("Changing your stream key will log you out of the admin and block you from streaming until you change the key in your broadcasting software.")},M=()=>{n.online&&v("The updated ffmpeg path will be used when starting your next live stream.")};return(0,s.jsxs)("div",{className:"edit-server-details-container",children:[(0,s.jsx)("div",{className:"field-container field-streamkey-container",children:(0,s.jsxs)("div",{className:"left-side",children:[(0,s.jsx)(m.$7,{fieldName:"adminPassword",...g.tQ,value:e.adminPassword,initialValue:y,type:d.A8,onChange:T,onSubmit:E}),(0,s.jsxs)("div",{className:"streamkey-actions",children:[(0,s.jsx)(i.Z,{title:"Generate a stream key",children:(0,s.jsx)(o.Z,{icon:(0,s.jsx)(c.Z,{}),size:"small",onClick:function(){let e="";for(let t=0;t<3;t+=1)e+=Math.random().toString(36).substring(2);T({fieldName:"streamKey",value:e})}})}),(0,s.jsx)(i.Z,{className:"copy-tooltip",title:S?"Copied!":"Copy to clipboard",children:(0,s.jsx)(o.Z,{icon:(0,s.jsx)(u.Z,{}),size:"small",onClick:function(){navigator.clipboard.writeText(e.streamKey).then(()=>{P(!0),setTimeout(()=>P(!1),3e3)})}})})]})]})}),(0,s.jsx)(m.$7,{fieldName:"ffmpegPath",...g.KB,value:e.ffmpegPath,initialValue:x,onChange:T,onSubmit:M}),(0,s.jsx)(m.$7,{fieldName:"webServerPort",...g.rE,value:e.webServerPort,initialValue:k,type:d.mG,onChange:T,onSubmit:Z}),(0,s.jsx)(m.$7,{fieldName:"rtmpServerPort",...g.lT,value:e.rtmpServerPort,initialValue:j,type:d.mG,onChange:T,onSubmit:Z}),(0,s.jsx)(a.Z,{className:"advanced-settings",children:(0,s.jsxs)(b,{header:"Advanced Settings",children:[(0,s.jsx)(l.Z.Paragraph,{children:"If you have a CDN in front of your entire Owncast instance, specify your origin server here for the websocket to connect to. Most people will never need to set this."}),(0,s.jsx)(m.$7,{fieldName:"socketHostOverride",...g.ME,value:e.socketHostOverride,initialValue:N||"",type:d.xA,onChange:T}),C.enabled&&(0,s.jsx)(w,{})]},"1")})]})};function k(){return(0,s.jsxs)("div",{className:"config-server-details-form",children:[(0,s.jsx)("p",{className:"description",children:"You should change your admin password from the default and keep it safe. For most people it's likely the other settings will not need to be changed."}),(0,s.jsx)("div",{className:"form-module config-server-details-container",children:(0,s.jsx)(j,{})})]})}},82661:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var s=n(85893),r=n(67294),a=n(45697),i=n.n(a);let o=r.createContext({message:null,setMessage:e=>null}),l=e=>{let{children:t}=e,[n,a]=(0,r.useState)("");return(0,s.jsx)(o.Provider,{value:{message:n,setMessage:a},children:t})};l.propTypes={children:i().element.isRequired},t.Z=l},41983:function(e,t,n){"use strict";n.d(t,{Jk:function(){return u},Un:function(){return l},dG:function(){return m},kg:function(){return h},zv:function(){return d}});var s=n(85893),r=n(89739),a=n(21640),i=n(50888),o=n(28058);let l="error",c="invalid",u="proessing",d="success",m="warning",f={[d]:{type:d,icon:(0,s.jsx)(r.Z,{style:{color:"green"}}),message:"Success!"},[l]:{type:l,icon:(0,s.jsx)(a.Z,{style:{color:"red"}}),message:"An error occurred."},[c]:{type:c,icon:(0,s.jsx)(a.Z,{style:{color:"red"}}),message:"An error occurred."},[u]:{type:u,icon:(0,s.jsx)(i.Z,{}),message:""},[m]:{type:m,icon:(0,s.jsx)(o.Z,{style:{color:"#fc0"}}),message:""}};function h(e,t){return e&&f[e]?t?{type:e,icon:f[e].icon,message:t}:f[e]:null}},99519:function(e,t,n){"use strict";n.d(t,{aC:function(){return d}});var s=n(85893),r=n(67294),a=n(45697),i=n.n(a),o=n(64777),l=n(90745);let c={streamKeys:[],adminPassword:"",instanceDetails:{customStyles:"",extraPageContent:"",logo:"",name:"",nsfw:!1,socialHandles:[],streamTitle:"",summary:"",tags:[],title:"",welcomeMessage:"",offlineMessage:"",appearanceVariables:{}},ffmpegPath:"",rtmpServerPort:"",webServerPort:"",socketHostOverride:null,s3:{accessKey:"",acl:"",bucket:"",enabled:!1,endpoint:"",region:"",secret:"",servingEndpoint:"",forcePathStyle:!1},yp:{enabled:!1,instanceUrl:""},videoSettings:{latencyLevel:4,cpuUsageLevel:3,videoQualityVariants:[l.gX]},federation:{enabled:!1,isPrivate:!1,username:"",goLiveMessage:"",showEngagement:!0,blockedDomains:[]},notifications:{browser:{enabled:!1,goLiveMessage:""},discord:{enabled:!1,webhook:"",goLiveMessage:""},twitter:{enabled:!1,goLiveMessage:"",apiKey:"",apiSecret:"",accessToken:"",accessTokenSecret:"",bearerToken:""}},externalActions:[],supportedCodecs:[],videoCodec:"",forbiddenUsernames:[],suggestedUsernames:[],chatDisabled:!1,chatJoinMessagesEnabled:!0,chatEstablishedUserMode:!1,hideViewerCount:!1},u={broadcastActive:!1,broadcaster:null,currentBroadcast:null,online:!1,viewerCount:0,sessionMaxViewerCount:0,sessionPeakViewerCount:0,overallPeakViewerCount:0,versionNumber:"0.0.0",streamTitle:"",chatDisabled:!1,health:{healthy:!0,healthPercentage:100,message:"",representation:0}},d=r.createContext({...u,serverConfig:c,setFieldInConfigState:e=>null}),m=e=>{let{children:t}=e,[n,a]=(0,r.useState)(u),[i,l]=(0,r.useState)(c),m=async()=>{try{let e=await (0,o.rQ)(o.Q_);a({...e})}catch(t){}},f=async()=>{try{let e=await (0,o.rQ)(o.bl);l(e)}catch(t){}},h=e=>{let{fieldName:t,value:n,path:s}=e,r=s?{...i,[s]:{...i[s],[t]:n}}:{...i,[t]:n};l(r)};(0,r.useEffect)(()=>{let e=null;return m(),e=setInterval(m,o.NE),f(),()=>{clearInterval(e)}},[]);let g={...n,serverConfig:i,setFieldInConfigState:h};return(0,s.jsx)(d.Provider,{value:g,children:t})};m.propTypes={children:i().element.isRequired},t.ZP=m}},function(e){e.O(0,[481,5596,1407,173,611,1577,3763,4485,5212,7033,2610,2445,745,9774,2888,179],function(){return e(e.s=29284)}),_N_E=e.O()}]);
//# sourceMappingURL=ServerConfig-47d4bd13c5a82912.js.map