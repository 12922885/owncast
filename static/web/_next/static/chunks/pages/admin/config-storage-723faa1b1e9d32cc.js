(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7757],{79128:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/config-storage",function(){return a(45017)}])},3664:function(e,n,a){"use strict";a.d(n,{Z:function(){return h}});var i=a(47568),t=a(70655),s=a(85893),r=a(67294),c=a(94594),l=a(83192),o=a(25521),d=a(25964),u=a(35159),h=function(e){var n=e.apiPath,a=e.checked,h=e.reversed,f=void 0!==h&&h,v=e.configPath,g=void 0===v?"":v,m=e.disabled,p=void 0!==m&&m,x=e.fieldName,b=e.label,j=e.tip,N=e.useSubmit,k=e.onChange,y=(0,r.useState)(null),Z=y[0],C=y[1],S=null,w=((0,r.useContext)(u.aC)||{}).setFieldInConfigState,P=function(){C(null),clearTimeout(S),S=null},E=function(){var e=(0,i.Z)((function(e){var a;return(0,t.__generator)(this,(function(i){switch(i.label){case 0:return N?(C((0,l.kg)(l.Jk)),a=f?!e:e,[4,(0,d.Si)({apiPath:n,data:{value:a},onSuccess:function(){w({fieldName:x,value:a,path:g}),C((0,l.kg)(l.zv))},onError:function(e){C((0,l.kg)(l.Un,"There was an error: ".concat(e)))}})]):[3,2];case 1:i.sent(),S=setTimeout(P,d.sI),i.label=2;case 2:return k&&k(e),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),_=null!==Z&&Z.type===l.Jk;return(0,s.jsxs)("div",{className:"formfield-container toggleswitch-container",children:[b&&(0,s.jsx)("div",{className:"label-side",children:(0,s.jsx)("span",{className:"formfield-label",children:b})}),(0,s.jsxs)("div",{className:"input-side",children:[(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)(c.Z,{className:"switch field-".concat(x),loading:_,onChange:E,defaultChecked:a,checked:a,checkedChildren:"ON",unCheckedChildren:"OFF",disabled:p}),(0,s.jsx)(o.E,{status:Z})]}),(0,s.jsx)("p",{className:"field-tip",children:j})]})]})};h.defaultProps={apiPath:"",checked:!1,reversed:!1,configPath:"",disabled:!1,label:"",tip:"",useSubmit:!1,onChange:null}},45017:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return S}});var i=a(85893),t=a(84485),s=a(67294),r=a(47568),c=a(14924),l=a(26042),o=a(69396),d=a(70655),u=a(54907),h=a(71577),f=a(94184),v=a.n(f),g=a(35159),m=a(57553),p=a(25964),x=a(83192),b=a(24389),j=a(25521),N=a(19411),k=a(3664),y=u.Z.Panel;var Z=function(){var e=(0,s.useState)(null),n=e[0],a=e[1],t=(0,s.useState)(null),f=t[0],Z=t[1],C=(0,s.useState)(!1),S=C[0],w=C[1],P=(0,s.useContext)(g.aC)||{},E=P.serverConfig,_=P.setFieldInConfigState,z=(0,s.useContext)(m.k).setMessage,T=E.s3,O=T.accessKey,K=void 0===O?"":O,F=T.acl,I=void 0===F?"":F,U=T.bucket,D=void 0===U?"":U,J=T.enabled,X=void 0!==J&&J,L=T.endpoint,M=void 0===L?"":L,V=T.region,$=void 0===V?"":V,q=T.secret,A=void 0===q?"":q,B=T.servingEndpoint,G=void 0===B?"":B,H=T.forcePathStyle,Q=void 0!==H&&H;if((0,s.useEffect)((function(){a({accessKey:K,acl:I,bucket:D,enabled:X,endpoint:M,region:$,secret:A,servingEndpoint:G,forcePathStyle:Q}),w(X)}),[T]),!n)return null;var R=null,W=function(){Z(null),R=null,clearTimeout(R)},Y=function(e){var i=e.fieldName,t=e.value;a((0,o.Z)((0,l.Z)({},n),(0,c.Z)({},i,t)))},ee=function(){var e=(0,r.Z)((function(){var e;return(0,d.__generator)(this,(function(a){switch(a.label){case 0:return Z((0,x.kg)(x.Jk)),e=n,[4,(0,p.Si)({apiPath:p.$w,data:{value:e},onSuccess:function(){_({fieldName:"s3",value:e,path:""}),Z((0,x.kg)(x.zv,"Updated.")),R=setTimeout(W,p.sI),z("Changing your storage configuration will take place the next time you start a new stream.")},onError:function(e){Z((0,x.kg)(x.Un,e)),R=setTimeout(W,p.sI)}})];case 1:return a.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),ne=v()({"edit-storage-container":!0,"form-module":!0,enabled:S}),ae=function(e,n){var a=e.endpoint,i=e.accessKey,t=e.secret,s=e.bucket,r=e.region,c=e.enabled,l=e.servingEndpoint,o=e.acl,d=e.forcePathStyle;if(c){if(a&&(0,N.Z)(a)&&i&&t&&s&&r&&(c!==n.enabled||a!==n.endpoint||i!==n.accessKey||t!==n.secret||r!==n.region||!n.servingEndpoint&&""!==l||n.servingEndpoint&&l!==n.servingEndpoint||!n.acl&&""!==o||n.acl&&o!==n.acl||d!==n.forcePathStyle))return!0}else if(c!==n.enabled)return!0;return!1}(n,T);return(0,i.jsxs)("div",{className:ne,children:[(0,i.jsx)("div",{className:"enable-switch",children:(0,i.jsx)(k.Z,{apiPath:"",fieldName:"enabled",label:"Use S3 Storage Provider",checked:n.enabled,onChange:function(e){w(e),Y({fieldName:"enabled",value:e})}})}),(0,i.jsxs)("div",{className:"form-fields",children:[(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(b.nv,(0,o.Z)((0,l.Z)({},p.zm.endpoint),{value:n.endpoint,onChange:Y}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(b.nv,(0,o.Z)((0,l.Z)({},p.zm.accessKey),{value:n.accessKey,onChange:Y}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(b.nv,(0,o.Z)((0,l.Z)({},p.zm.secret),{value:n.secret,onChange:Y}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(b.nv,(0,o.Z)((0,l.Z)({},p.zm.bucket),{value:n.bucket,onChange:Y}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(b.nv,(0,o.Z)((0,l.Z)({},p.zm.region),{value:n.region,onChange:Y}))}),(0,i.jsx)(u.Z,{className:"advanced-section",children:(0,i.jsxs)(y,{header:"Optional Settings",children:[(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(b.nv,(0,o.Z)((0,l.Z)({},p.zm.acl),{value:n.acl,onChange:Y}))}),(0,i.jsx)("div",{className:"field-container",children:(0,i.jsx)(b.nv,(0,o.Z)((0,l.Z)({},p.zm.servingEndpoint),{value:n.servingEndpoint,onChange:Y}))}),(0,i.jsx)("div",{className:"enable-switch",children:(0,i.jsx)(k.Z,(0,o.Z)((0,l.Z)({},p.zm.forcePathStyle),{fieldName:"forcePathStyle",checked:n.forcePathStyle,onChange:function(e){Y({fieldName:"forcePathStyle",value:e})}}))})]},"1")})]}),(0,i.jsxs)("div",{className:"button-container",children:[(0,i.jsx)(h.Z,{type:"primary",onClick:ee,disabled:!ae,children:"Save"}),(0,i.jsx)(j.E,{status:f})]})]})},C=t.Z.Title;function S(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C,{children:"Storage"}),(0,i.jsxs)("p",{className:"description",children:["Owncast supports optionally using external storage providers to stream your video. Learn more about this by visiting our"," ",(0,i.jsx)("a",{href:"https://owncast.online/docs/storage/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"Storage Documentation"}),"."]}),(0,i.jsx)("p",{className:"description",children:"Configuring this incorrectly will likely cause your video to be unplayable. Double check the documentation for your storage provider on how to configure the bucket you created for Owncast."}),(0,i.jsx)("p",{className:"description",children:"Keep in mind this is for live streaming, not for archival, recording or VOD purposes."}),(0,i.jsx)(Z,{})]})}}},function(e){e.O(0,[5473,9774,2888,179],(function(){return n=79128,e(e.s=n);var n}));var n=e.O();_N_E=n}]);