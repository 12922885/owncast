(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1234],{67742:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/webhooks",function(){return n(72118)}])},72118:function(t,e,n){"use strict";n.r(e);var r=n(85893),o=n(48689),c=n(84485),a=n(94199),i=n(20550),s=n(15746),u=n(32808),l=n(30878),h=n(69677),f=n(71230),d=n(71577),p=n(26713),m=n(81025),w=n(67294),b=n(64777),g=n(37174);let{Title:k,Paragraph:y}=c.Z,j={CHAT:{name:"Chat messages",description:"When a user sends a chat message",color:"purple"},USER_JOINED:{name:"User joined",description:"When a user joins the chat",color:"green"},NAME_CHANGE:{name:"User name changed",description:"When a user changes their name",color:"blue"},"VISIBILITY-UPDATE":{name:"Message visibility changed",description:"When a message visibility changes, likely due to moderation",color:"red"},STREAM_STARTED:{name:"Stream started",description:"When a stream starts",color:"orange"},STREAM_STOPPED:{name:"Stream stopped",description:"When a stream stops",color:"cyan"}},v=t=>{let{onOk:e,onCancel:n,open:o}=t,[c,a]=(0,w.useState)([]),[i,p]=(0,w.useState)(""),m=Object.keys(j).map(t=>({value:t,label:j[t].description})),b={disabled:(null==c?void 0:c.length)===0||!(0,g.jv)(i)},k=m.map(t=>(0,r.jsx)(s.Z,{span:8,children:(0,r.jsx)(u.Z,{value:t.value,children:t.label})},t.value));return(0,r.jsxs)(l.Z,{title:"Create New Webhook",open:o,onOk:function(){e(i,c),p(""),a(null)},onCancel:n,okButtonProps:b,children:[(0,r.jsx)("div",{children:(0,r.jsx)(h.Z,{value:i,placeholder:"https://myserver.com/webhook",onChange:t=>p(t.currentTarget.value.trim()),type:"url",pattern:g.ax})}),(0,r.jsx)("p",{children:"Select the events that will be sent to this webhook."}),(0,r.jsx)(u.Z.Group,{style:{width:"100%"},value:c,onChange:function(t){a(t)},children:(0,r.jsx)(f.Z,{children:k})}),(0,r.jsx)("p",{children:(0,r.jsx)(d.Z,{type:"primary",onClick:function(){a(Object.keys(j))},children:"Select all"})})]})},x=()=>{let[t,e]=(0,w.useState)([]),[n,c]=(0,w.useState)(!1);function s(t){console.error("error",t)}async function u(){try{let t=await (0,b.rQ)(b.XA);e(t)}catch(n){s(n)}}async function l(t){try{await (0,b.rQ)(b.M_,{method:"POST",data:{id:t}}),u()}catch(e){s(e)}}async function h(n,r){try{let o=await (0,b.rQ)(b.iG,{method:"POST",data:{url:n,events:r}});e(t.concat(o))}catch(c){s(c)}}(0,w.useEffect)(()=>{u()},[]);let f=()=>{c(!0)},g=(t,e)=>{c(!1),h(t,e)},x=()=>{c(!1)};return(0,r.jsxs)("div",{children:[(0,r.jsx)(k,{children:"Webhooks"}),(0,r.jsx)(y,{children:"A webhook is a callback made to an external API in response to an event that takes place within Owncast. This can be used to build chat bots or sending automatic notifications that you've started streaming."}),(0,r.jsxs)(y,{children:["Read more about how to use webhooks, with examples, at"," ",(0,r.jsx)("a",{href:"https://owncast.online/docs/integrations/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"our documentation"}),"."]}),(0,r.jsx)(m.Z,{rowKey:t=>t.id,columns:[{title:"",key:"delete",render:(t,e)=>(0,r.jsx)(p.Z,{size:"middle",children:(0,r.jsx)(d.Z,{onClick:()=>l(e.id),icon:(0,r.jsx)(o.Z,{})})})},{title:"URL",dataIndex:"url",key:"url"},{title:"Events",dataIndex:"events",key:"events",render:t=>(0,r.jsx)(r.Fragment,{children:t.map(t=>(function(t){if(!t||!j[t])return null;let e=j[t];return(0,r.jsx)(a.Z,{title:e.description,children:(0,r.jsx)(i.Z,{color:e.color,children:e.name})},t)})(t))})}],dataSource:t,pagination:!1}),(0,r.jsx)("br",{}),(0,r.jsx)(d.Z,{type:"primary",onClick:f,children:"Create Webhook"}),(0,r.jsx)(v,{open:n,onOk:g,onCancel:x})]})};e.default=x},64777:function(t,e,n){"use strict";n.d(e,{$i:function(){return O},$l:function(){return L},Bu:function(){return b},E8:function(){return R},Ff:function(){return T},GC:function(){return y},GR:function(){return Y},HP:function(){return M},IO:function(){return C},Kp:function(){return p},Kt:function(){return H},M_:function(){return I},N$:function(){return Q},NE:function(){return s},NM:function(){return w},Q_:function(){return u},Qc:function(){return S},RB:function(){return g},UJ:function(){return X},WB:function(){return a},WE:function(){return E},WQ:function(){return x},Wr:function(){return N},XA:function(){return W},Y9:function(){return U},a_:function(){return d},ao:function(){return h},bl:function(){return l},e_:function(){return P},hn:function(){return _},iG:function(){return Z},iV:function(){return f},jr:function(){return k},kb:function(){return G},kg:function(){return $},ms:function(){return A},nx:function(){return j},op:function(){return B},qk:function(){return m},rQ:function(){return K},sG:function(){return v},um:function(){return D}});var r=n(34155);let o=r.env.NEXT_PUBLIC_ADMIN_USERNAME,c=r.env.NEXT_PUBLIC_ADMIN_STREAMKEY,a="/",i="".concat(a,"api/admin/"),s=15e3,u="".concat(i,"status"),l="".concat(i,"serverconfig"),h="".concat(i,"config"),f="".concat(i,"viewersOverTime"),d="".concat(i,"viewers"),p="".concat(i,"chat/clients"),m="".concat(i,"chat/users/disabled"),w="".concat(i,"chat/users/setenabled"),b="".concat(i,"chat/users/ipbans"),g="".concat(i,"chat/users/ipbans/remove"),k="".concat(i,"chat/users/setmoderator"),y="".concat(i,"chat/users/moderators"),j="".concat(i,"hardwarestats"),v="".concat(i,"logs"),x="".concat(i,"logs/warnings"),E="".concat(i,"chat/messages"),_="/api/admin/chat/messagevisibility",S="".concat(i,"emoji/upload"),T="".concat(i,"emoji/delete"),A="".concat(i,"accesstokens"),N="".concat(i,"accesstokens/delete"),C="".concat(i,"accesstokens/create"),W="".concat(i,"webhooks"),I="".concat(i,"webhooks/delete"),Z="".concat(i,"webhooks/create"),O="".concat(a,"api/socialplatforms"),P="".concat(i,"federation/send"),M="".concat(i,"followers"),R="".concat(i,"followers/pending"),U="".concat(i,"followers/blocked"),G="".concat(i,"followers/approve"),B="".concat(i,"federation/actions"),Q="".concat(i,"metrics/video"),D="".concat(i,"config/streamkeys"),X="".concat(i,"yp/reset");async function K(t,e){let{data:n,method:r="GET",auth:a=!0}=e||{},i={method:r};if(n&&(i.body=JSON.stringify(n)),a&&o&&c){let s=btoa("".concat(o,":").concat(c));i.headers={Authorization:"Basic ".concat(s)},i.mode="cors",i.credentials="include"}try{let u=await fetch(t,i),l=await u.json();if(!u.ok){let h=l.message||"An error has occurred: ".concat(u.status);throw Error(h)}return l}catch(f){return console.error(f),f}}async function L(t,e){let n={method:"GET",auth:!1,...e};return K(t,n)}async function $(t){try{let e=await fetch(t,{referrerPolicy:"no-referrer",referrer:""});if(!e.ok){let n="An error has occured: ".concat(e.status);throw Error(n)}let r=await e.json();return r}catch(o){console.log(o)}return{}}async function H(){return $("https://api.github.com/repos/owncast/owncast/releases/latest")}let J=/^\d+(\.\d+){0,2}$/;async function Y(t){let e=await H(),n=e.tag_name;return("v"===n.substr(0,1)&&(n=n.substr(1)),!function(t,e){if(!t||!e||0===t.length||0===e.length)return!1;if(t===e)return!0;if(J.test(t)&&J.test(e)){let n=t.split(".");for(;n.length<3;)n.push("0");let r=e.split(".");for(;r.length<3;)r.push("0");for(let o=0;o<3;o++){let c=parseInt(n[o],10),a=parseInt(r[o],10);if(c!==a)return c>a}return!0}return t>=e}(t,n))?n:null}},37174:function(t,e,n){"use strict";n.d(e,{Kf:function(){return c},ax:function(){return r},bu:function(){return a},jv:function(){return o}});let r="https?://.*";function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["http:","https:"];try{let n=new URL(t);if(""===n.protocol||""===n.hostname||!e.includes(n.protocol))return!1}catch(r){return!1}return!0}function c(t,e){t.startsWith("@")&&(t=t.slice(1));let n=t.split(/:|@/),[r,o,c]=n;return console.log({account:t,protocol:e,service:r,user:o,host:c}),r===e&&3===n.length&&!!r&&!!o&&!!c}function a(t){if(!t.startsWith("matrix:"))return!1;(t=t.slice(7)).startsWith("@")&&(t=t.slice(1));let e=t.split(":"),[n,r]=e;return 2===e.length&&!!n&&!!r}}},function(t){t.O(0,[481,5596,1407,173,611,1577,3763,4485,5212,4759,8909,3903,3698,3461,6754,878,3731,9774,2888,179],function(){return t(t.s=67742)}),_N_E=t.O()}]);
//# sourceMappingURL=webhooks-df4a780571d889b3.js.map