(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5685],{54005:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/actions",function(){return t(2075)}])},2075:function(e,n,t){"use strict";t.r(n);var r=t(85893),o=t(48689),a=t(86548),s=t(6880),i=t(85402),l=t(18119),c=t(69677),u=t(32808),d=t(26713),h=t(71577),p=t(48213),g=t(96486),x=t.n(g),v=t(67294),y=t(73615),m=t(90745),f=t(41983),j=t(99519),k=t(37174);const{Title:w,Paragraph:C}=s.Z;let b=null;const Z=e=>{const{onOk:n,onCancel:t,open:o,action:a}=e,[s,d]=(0,v.useState)(""),[h,p]=(0,v.useState)(""),[g,x]=(0,v.useState)(""),[y,m]=(0,v.useState)(""),[f,j]=(0,v.useState)(""),[w,C]=(0,v.useState)(!1);(0,v.useEffect)((()=>{d((null===a||void 0===a?void 0:a.url)||""),p((null===a||void 0===a?void 0:a.title)||""),x((null===a||void 0===a?void 0:a.description)||""),m((null===a||void 0===a?void 0:a.icon)||""),j((null===a||void 0===a?void 0:a.color)||""),C((null===a||void 0===a?void 0:a.openExternally)||!1)}),[a]);const b={disabled:!((0,k.jv)(s,["https:"])&&""!==h)};return(0,r.jsx)(i.Z,{destroyOnClose:!0,title:null==a?"Create New Action":"Edit Action",open:o,onOk:function(){n(a,s,h,g,y,f,w),d(""),p(""),x(""),m(""),j(""),C(!1)},onCancel:t,okButtonProps:b,children:(0,r.jsxs)(l.Z,{initialValues:a,children:["Add the URL for the external action you want to present."," ",(0,r.jsx)("strong",{children:"Only HTTPS urls are supported."}),(0,r.jsx)("p",{children:(0,r.jsx)("a",{href:"https://owncast.online/thirdparty/actions/",target:"_blank",rel:"noopener noreferrer",children:"Read more about external actions."})}),(0,r.jsx)(l.Z.Item,{name:"url",children:(0,r.jsx)(c.Z,{required:!0,placeholder:"https://myserver.com/action (required)",onChange:e=>d(e.currentTarget.value.trim()),type:"url",pattern:k.ax})}),(0,r.jsx)(l.Z.Item,{name:"title",children:(0,r.jsx)(c.Z,{value:h,required:!0,placeholder:"Your action title (required)",onChange:e=>p(e.currentTarget.value)})}),(0,r.jsx)(l.Z.Item,{name:"description",children:(0,r.jsx)(c.Z,{value:g,placeholder:"Optional description",onChange:e=>x(e.currentTarget.value)})}),(0,r.jsx)(l.Z.Item,{name:"icon",children:(0,r.jsx)(c.Z,{value:y,placeholder:"https://myserver.com/action/icon.png (optional)",onChange:e=>m(e.currentTarget.value)})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(l.Z.Item,{name:"color",style:{marginBottom:"0px"},children:(0,r.jsx)(c.Z,{type:"color",value:f,onChange:e=>j(e.currentTarget.value)})}),"Optional background color of the action button."]}),(0,r.jsx)(l.Z.Item,{name:"openExternally",children:(0,r.jsx)(u.Z,{checked:w,defaultChecked:w,onChange:e=>{C(e.target.checked)},children:"Open in a new tab instead of within your page."})})]})})};n.default=()=>{const e=(0,v.useContext)(j.aC),{serverConfig:n,setFieldInConfigState:t}=e||{},{externalActions:s}=n,[i,l]=(0,v.useState)(null),[c,u]=(0,v.useState)(!1),[g,k]=(0,v.useState)(null),[S,I]=(0,v.useState)(null),E=()=>{k(null),b=null,clearTimeout(b)};async function T(e){await(0,m.Si)({apiPath:m.os,data:{value:e},onSuccess:()=>{t({fieldName:"externalActions",value:e,path:""}),k((0,f.kg)(f.zv,"Updated.")),b=setTimeout(E,m.sI)},onError:e=>{console.log(e),k((0,f.kg)(f.Un,e)),b=setTimeout(E,m.sI)}})}(0,v.useEffect)((()=>{l(s||[])}),[s]);const P=[{title:"",key:"delete-edit",render:(e,n)=>(0,r.jsxs)(d.Z,{size:"middle",children:[(0,r.jsx)(h.Z,{onClick:()=>async function(e){const n=[...i],t=i.findIndex((n=>n.url===e.url));n.splice(t,1);try{l(n),T(n)}catch(r){console.error(r)}}(n),icon:(0,r.jsx)(o.Z,{})}),(0,r.jsx)(h.Z,{onClick:()=>async function(e){I(e),u(!0)}(n),icon:(0,r.jsx)(a.Z,{})})]})},{title:"Name",dataIndex:"title",key:"title"},{title:"Description",dataIndex:"description",key:"description"},{title:"URL",dataIndex:"url",key:"url"},{title:"Icon",dataIndex:"icon",key:"icon",render:e=>e?(0,r.jsx)("img",{style:{width:"2vw"},src:e,alt:""}):null},{title:"Color",dataIndex:"color",key:"color",render:e=>e?(0,r.jsx)("div",{style:{backgroundColor:e,height:"30px"},children:e}):null},{title:"Opens",dataIndex:"openExternally",key:"openExternally",render:e=>e?"In a new tab":"In a modal"}];return(0,r.jsxs)("div",{children:[(0,r.jsx)(w,{children:"External Actions"}),(0,r.jsx)(C,{children:"External action URLs are 3rd party UI you can display, embedded, into your Owncast page when a user clicks on a button to launch your action."}),(0,r.jsxs)(C,{children:["Read more about how to use actions, with examples, at"," ",(0,r.jsx)("a",{href:"https://owncast.online/thirdparty/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"our documentation"}),"."]}),(0,r.jsx)(p.Z,{rowKey:e=>"".concat(e.title,"-").concat(e.url),columns:P,dataSource:i,pagination:!1}),(0,r.jsx)("br",{}),(0,r.jsx)(h.Z,{type:"primary",onClick:()=>{I(null),u(!0)},children:"Create New Action"}),(0,r.jsx)(y.E,{status:g}),(0,r.jsx)(Z,{action:S,open:c,onOk:(e,n,t,r,o,a,s)=>{u(!1),async function(e,n,t,r,o,a,s){try{const c=[...i],u={url:n,title:t,description:r,icon:o,color:a,openExternally:s},d=e?i.findIndex((n=>x().isEqual(n,e))):-1;d>=0?c[d]=u:c.push(u),l(c),await T(c)}catch(c){console.error(c)}}(e,n,t,r,o,a,s),I(null)},onCancel:()=>{u(!1)}})]})}},41983:function(e,n,t){"use strict";t.d(n,{Jk:function(){return u},Un:function(){return l},dG:function(){return h},kg:function(){return g},zv:function(){return d}});var r=t(85893),o=t(89739),a=t(21640),s=t(50888),i=t(28058);const l="error",c="invalid",u="proessing",d="success",h="warning",p={[d]:{type:d,icon:(0,r.jsx)(o.Z,{style:{color:"green"}}),message:"Success!"},[l]:{type:l,icon:(0,r.jsx)(a.Z,{style:{color:"red"}}),message:"An error occurred."},[c]:{type:c,icon:(0,r.jsx)(a.Z,{style:{color:"red"}}),message:"An error occurred."},[u]:{type:u,icon:(0,r.jsx)(s.Z,{}),message:""},[h]:{type:h,icon:(0,r.jsx)(i.Z,{style:{color:"#fc0"}}),message:""}};function g(e,n){return e&&p[e]?n?{type:e,icon:p[e].icon,message:n}:p[e]:null}},99519:function(e,n,t){"use strict";t.d(n,{aC:function(){return u}});var r=t(85893),o=t(67294),a=t(45697),s=t.n(a),i=t(64777);const l={streamKeys:[],adminPassword:"",instanceDetails:{customStyles:"",extraPageContent:"",logo:"",name:"",nsfw:!1,socialHandles:[],streamTitle:"",summary:"",tags:[],title:"",welcomeMessage:"",offlineMessage:"",appearanceVariables:{}},ffmpegPath:"",rtmpServerPort:"",webServerPort:"",socketHostOverride:null,s3:{accessKey:"",acl:"",bucket:"",enabled:!1,endpoint:"",region:"",secret:"",servingEndpoint:"",forcePathStyle:!1},yp:{enabled:!1,instanceUrl:""},videoSettings:{latencyLevel:4,cpuUsageLevel:3,videoQualityVariants:[t(90745).gX]},federation:{enabled:!1,isPrivate:!1,username:"",goLiveMessage:"",showEngagement:!0,blockedDomains:[]},notifications:{browser:{enabled:!1,goLiveMessage:""},discord:{enabled:!1,webhook:"",goLiveMessage:""},twitter:{enabled:!1,goLiveMessage:"",apiKey:"",apiSecret:"",accessToken:"",accessTokenSecret:"",bearerToken:""}},externalActions:[],supportedCodecs:[],videoCodec:"",forbiddenUsernames:[],suggestedUsernames:[],chatDisabled:!1,chatJoinMessagesEnabled:!0,chatEstablishedUserMode:!1,hideViewerCount:!1},c={broadcastActive:!1,broadcaster:null,currentBroadcast:null,online:!1,viewerCount:0,sessionMaxViewerCount:0,sessionPeakViewerCount:0,overallPeakViewerCount:0,versionNumber:"0.0.0",streamTitle:"",chatDisabled:!1,health:{healthy:!0,healthPercentage:100,message:"",representation:0}},u=o.createContext({...c,serverConfig:l,setFieldInConfigState:e=>null}),d=e=>{let{children:n}=e;const[t,a]=(0,o.useState)(c),[s,d]=(0,o.useState)(l),h=async()=>{try{const e=await(0,i.rQ)(i.Q_);a({...e})}catch(e){}};(0,o.useEffect)((()=>{let e=null;return h(),e=setInterval(h,i.NE),(async()=>{try{const e=await(0,i.rQ)(i.bl);d(e)}catch(e){}})(),()=>{clearInterval(e)}}),[]);const p={...t,serverConfig:s,setFieldInConfigState:e=>{let{fieldName:n,value:t,path:r}=e;const o=r?{...s,[r]:{...s[r],[n]:t}}:{...s,[n]:t};d(o)}};return(0,r.jsx)(u.Provider,{value:p,children:n})};d.propTypes={children:s().element.isRequired},n.ZP=d}},function(e){e.O(0,[3662,5596,481,173,1407,4083,6880,3174,1577,6386,3013,3698,2459,8213,9915,715,5402,1908,8119,475,745,9774,2888,179],(function(){return n=54005,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
//# sourceMappingURL=actions-a6ff9dd0af70a2d3.js.map